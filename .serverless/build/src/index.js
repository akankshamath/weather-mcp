"use strict";var mc=Object.create;var qt=Object.defineProperty;var vc=Object.getOwnPropertyDescriptor;var gc=Object.getOwnPropertyNames;var yc=Object.getPrototypeOf,_c=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),un=(t,e)=>{for(var a in e)qt(t,a,{get:e[a],enumerable:!0})},dn=(t,e,a,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of gc(e))!_c.call(t,r)&&r!==a&&qt(t,r,{get:()=>e[r],enumerable:!(s=vc(e,r))||s.enumerable});return t};var bc=(t,e,a)=>(a=t!=null?mc(yc(t)):{},dn(e||!t||!t.__esModule?qt(a,"default",{value:t,enumerable:!0}):a,t)),Pc=t=>dn(qt({},"__esModule",{value:!0}),t);var io=Q((ya,oo)=>{(function(t,e){typeof ya=="object"&&typeof oo<"u"?e(ya):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(ya,function(t){"use strict";function e(){for(var m=arguments.length,h=Array(m),_=0;_<m;_++)h[_]=arguments[_];if(h.length>1){h[0]=h[0].slice(0,-1);for(var P=h.length-1,x=1;x<P;++x)h[x]=h[x].slice(1,-1);return h[P]=h[P].slice(1),h.join("")}else return h[0]}function a(m){return"(?:"+m+")"}function s(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function r(m){return m.toUpperCase()}function n(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function i(m,h){var _=m;if(h)for(var P in h)_[P]=h[P];return _}function o(m){var h="[A-Za-z]",_="[\\x0D]",P="[0-9]",x="[\\x22]",N=e(P,"[A-Fa-f]"),W="[\\x0A]",ae="[\\x20]",ie=a(a("%[EFef]"+N+"%"+N+N+"%"+N+N)+"|"+a("%[89A-Fa-f]"+N+"%"+N+N)+"|"+a("%"+N+N)),Ee="[\\:\\/\\?\\#\\[\\]\\@]",te="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",pe=e(Ee,te),xe=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",he=m?"[\\uE000-\\uF8FF]":"[]",ne=e(h,P,"[\\-\\.\\_\\~]",xe),me=a(h+e(h,P,"[\\+\\-\\.]")+"*"),ce=a(a(ie+"|"+e(ne,te,"[\\:]"))+"*"),Or=a(a("25[0-5]")+"|"+a("2[0-4]"+P)+"|"+a("1"+P+P)+"|"+a("[1-9]"+P)+"|"+P),He=a(a("25[0-5]")+"|"+a("2[0-4]"+P)+"|"+a("1"+P+P)+"|"+a("0?[1-9]"+P)+"|0?0?"+P),Ue=a(He+"\\."+He+"\\."+He+"\\."+He),ue=a(N+"{1,4}"),ze=a(a(ue+"\\:"+ue)+"|"+Ue),Ze=a(a(ue+"\\:")+"{6}"+ze),tr=a("\\:\\:"+a(ue+"\\:")+"{5}"+ze),Ar=a(a(ue)+"?\\:\\:"+a(ue+"\\:")+"{4}"+ze),cr=a(a(a(ue+"\\:")+"{0,1}"+ue)+"?\\:\\:"+a(ue+"\\:")+"{3}"+ze),_t=a(a(a(ue+"\\:")+"{0,2}"+ue)+"?\\:\\:"+a(ue+"\\:")+"{2}"+ze),Nt=a(a(a(ue+"\\:")+"{0,3}"+ue)+"?\\:\\:"+ue+"\\:"+ze),Lt=a(a(a(ue+"\\:")+"{0,4}"+ue)+"?\\:\\:"+ze),Yr=a(a(a(ue+"\\:")+"{0,5}"+ue)+"?\\:\\:"+ue),Xr=a(a(a(ue+"\\:")+"{0,6}"+ue)+"?\\:\\:"),ur=a([Ze,tr,Ar,cr,_t,Nt,Lt,Yr,Xr].join("|")),et=a(a(ne+"|"+ie)+"+"),Ba=a(ur+"\\%25"+et),$r=a(ur+a("\\%25|\\%(?!"+N+"{2})")+et),lc=a("[vV]"+N+"+\\."+e(ne,te,"[\\:]")+"+"),cc=a("\\["+a($r+"|"+ur+"|"+lc)+"\\]"),nn=a(a(ie+"|"+e(ne,te))+"*"),bt=a(cc+"|"+Ue+"(?!"+nn+")|"+nn),Pt=a(P+"*"),on=a(a(ce+"@")+"?"+bt+a("\\:"+Pt)+"?"),Et=a(ie+"|"+e(ne,te,"[\\:\\@]")),uc=a(Et+"*"),ln=a(Et+"+"),dc=a(a(ie+"|"+e(ne,te,"[\\@]"))+"+"),dr=a(a("\\/"+uc)+"*"),rt=a("\\/"+a(ln+dr)+"?"),Qa=a(dc+dr),Ft=a(ln+dr),tt="(?!"+Et+")",Kh=a(dr+"|"+rt+"|"+Qa+"|"+Ft+"|"+tt),at=a(a(Et+"|"+e("[\\/\\?]",he))+"*"),xt=a(a(Et+"|[\\/\\?]")+"*"),cn=a(a("\\/\\/"+on+dr)+"|"+rt+"|"+Ft+"|"+tt),fc=a(me+"\\:"+cn+a("\\?"+at)+"?"+a("\\#"+xt)+"?"),hc=a(a("\\/\\/"+on+dr)+"|"+rt+"|"+Qa+"|"+tt),pc=a(hc+a("\\?"+at)+"?"+a("\\#"+xt)+"?"),Jh=a(fc+"|"+pc),Wh=a(me+"\\:"+cn+a("\\?"+at)+"?"),Gh="^("+me+")\\:"+a(a("\\/\\/("+a("("+ce+")@")+"?("+bt+")"+a("\\:("+Pt+")")+"?)")+"?("+dr+"|"+rt+"|"+Ft+"|"+tt+")")+a("\\?("+at+")")+"?"+a("\\#("+xt+")")+"?$",Yh="^(){0}"+a(a("\\/\\/("+a("("+ce+")@")+"?("+bt+")"+a("\\:("+Pt+")")+"?)")+"?("+dr+"|"+rt+"|"+Qa+"|"+tt+")")+a("\\?("+at+")")+"?"+a("\\#("+xt+")")+"?$",Xh="^("+me+")\\:"+a(a("\\/\\/("+a("("+ce+")@")+"?("+bt+")"+a("\\:("+Pt+")")+"?)")+"?("+dr+"|"+rt+"|"+Ft+"|"+tt+")")+a("\\?("+at+")")+"?$",ep="^"+a("\\#("+xt+")")+"?$",rp="^"+a("("+ce+")@")+"?("+bt+")"+a("\\:("+Pt+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",h,P,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",ne,te),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",ne,te),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",ne,te),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",ne,te),"g"),NOT_QUERY:new RegExp(e("[^\\%]",ne,te,"[\\:\\@\\/\\?]",he),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",ne,te,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",ne,te),"g"),UNRESERVED:new RegExp(ne,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",ne,pe),"g"),PCT_ENCODED:new RegExp(ie,"g"),IPV4ADDRESS:new RegExp("^("+Ue+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ur+")"+a(a("\\%25|\\%(?!"+N+"{2})")+"("+et+")")+"?\\]?$")}}var l=o(!1),u=o(!0),f=function(){function m(h,_){var P=[],x=!0,N=!1,W=void 0;try{for(var ae=h[Symbol.iterator](),ie;!(x=(ie=ae.next()).done)&&(P.push(ie.value),!(_&&P.length===_));x=!0);}catch(Ee){N=!0,W=Ee}finally{try{!x&&ae.return&&ae.return()}finally{if(N)throw W}}return P}return function(h,_){if(Array.isArray(h))return h;if(Symbol.iterator in Object(h))return m(h,_);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(m){if(Array.isArray(m)){for(var h=0,_=Array(m.length);h<m.length;h++)_[h]=m[h];return _}else return Array.from(m)},y=2147483647,d=36,v=1,b=26,g=38,E=700,R=72,S=128,w="-",$=/^xn--/,k=/[^\0-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=d-v,H=Math.floor,z=String.fromCharCode;function F(m){throw new RangeError(M[m])}function I(m,h){for(var _=[],P=m.length;P--;)_[P]=h(m[P]);return _}function C(m,h){var _=m.split("@"),P="";_.length>1&&(P=_[0]+"@",m=_[1]),m=m.replace(L,".");var x=m.split("."),N=I(x,h).join(".");return P+N}function q(m){for(var h=[],_=0,P=m.length;_<P;){var x=m.charCodeAt(_++);if(x>=55296&&x<=56319&&_<P){var N=m.charCodeAt(_++);(N&64512)==56320?h.push(((x&1023)<<10)+(N&1023)+65536):(h.push(x),_--)}else h.push(x)}return h}var le=function(h){return String.fromCodePoint.apply(String,p(h))},Y=function(h){return h-48<10?h-22:h-65<26?h-65:h-97<26?h-97:d},re=function(h,_){return h+22+75*(h<26)-((_!=0)<<5)},G=function(h,_,P){var x=0;for(h=P?H(h/E):h>>1,h+=H(h/_);h>O*b>>1;x+=d)h=H(h/O);return H(x+(O+1)*h/(h+g))},U=function(h){var _=[],P=h.length,x=0,N=S,W=R,ae=h.lastIndexOf(w);ae<0&&(ae=0);for(var ie=0;ie<ae;++ie)h.charCodeAt(ie)>=128&&F("not-basic"),_.push(h.charCodeAt(ie));for(var Ee=ae>0?ae+1:0;Ee<P;){for(var te=x,pe=1,xe=d;;xe+=d){Ee>=P&&F("invalid-input");var he=Y(h.charCodeAt(Ee++));(he>=d||he>H((y-x)/pe))&&F("overflow"),x+=he*pe;var ne=xe<=W?v:xe>=W+b?b:xe-W;if(he<ne)break;var me=d-ne;pe>H(y/me)&&F("overflow"),pe*=me}var ce=_.length+1;W=G(x-te,ce,te==0),H(x/ce)>y-N&&F("overflow"),N+=H(x/ce),x%=ce,_.splice(x++,0,N)}return String.fromCodePoint.apply(String,_)},ve=function(h){var _=[];h=q(h);var P=h.length,x=S,N=0,W=R,ae=!0,ie=!1,Ee=void 0;try{for(var te=h[Symbol.iterator](),pe;!(ae=(pe=te.next()).done);ae=!0){var xe=pe.value;xe<128&&_.push(z(xe))}}catch($r){ie=!0,Ee=$r}finally{try{!ae&&te.return&&te.return()}finally{if(ie)throw Ee}}var he=_.length,ne=he;for(he&&_.push(w);ne<P;){var me=y,ce=!0,Or=!1,He=void 0;try{for(var Ue=h[Symbol.iterator](),ue;!(ce=(ue=Ue.next()).done);ce=!0){var ze=ue.value;ze>=x&&ze<me&&(me=ze)}}catch($r){Or=!0,He=$r}finally{try{!ce&&Ue.return&&Ue.return()}finally{if(Or)throw He}}var Ze=ne+1;me-x>H((y-N)/Ze)&&F("overflow"),N+=(me-x)*Ze,x=me;var tr=!0,Ar=!1,cr=void 0;try{for(var _t=h[Symbol.iterator](),Nt;!(tr=(Nt=_t.next()).done);tr=!0){var Lt=Nt.value;if(Lt<x&&++N>y&&F("overflow"),Lt==x){for(var Yr=N,Xr=d;;Xr+=d){var ur=Xr<=W?v:Xr>=W+b?b:Xr-W;if(Yr<ur)break;var et=Yr-ur,Ba=d-ur;_.push(z(re(ur+et%Ba,0))),Yr=H(et/Ba)}_.push(z(re(Yr,0))),W=G(N,Ze,ne==he),N=0,++ne}}}catch($r){Ar=!0,cr=$r}finally{try{!tr&&_t.return&&_t.return()}finally{if(Ar)throw cr}}++N,++x}return _.join("")},Te=function(h){return C(h,function(_){return $.test(_)?U(_.slice(4).toLowerCase()):_})},Ie=function(h){return C(h,function(_){return k.test(_)?"xn--"+ve(_):_})},se={version:"2.1.0",ucs2:{decode:q,encode:le},decode:U,encode:ve,toASCII:Ie,toUnicode:Te},be={};function Se(m){var h=m.charCodeAt(0),_=void 0;return h<16?_="%0"+h.toString(16).toUpperCase():h<128?_="%"+h.toString(16).toUpperCase():h<2048?_="%"+(h>>6|192).toString(16).toUpperCase()+"%"+(h&63|128).toString(16).toUpperCase():_="%"+(h>>12|224).toString(16).toUpperCase()+"%"+(h>>6&63|128).toString(16).toUpperCase()+"%"+(h&63|128).toString(16).toUpperCase(),_}function ke(m){for(var h="",_=0,P=m.length;_<P;){var x=parseInt(m.substr(_+1,2),16);if(x<128)h+=String.fromCharCode(x),_+=3;else if(x>=194&&x<224){if(P-_>=6){var N=parseInt(m.substr(_+4,2),16);h+=String.fromCharCode((x&31)<<6|N&63)}else h+=m.substr(_,6);_+=6}else if(x>=224){if(P-_>=9){var W=parseInt(m.substr(_+4,2),16),ae=parseInt(m.substr(_+7,2),16);h+=String.fromCharCode((x&15)<<12|(W&63)<<6|ae&63)}else h+=m.substr(_,9);_+=9}else h+=m.substr(_,3),_+=3}return h}function vr(m,h){function _(P){var x=ke(P);return x.match(h.UNRESERVED)?x:P}return m.scheme&&(m.scheme=String(m.scheme).replace(h.PCT_ENCODED,_).toLowerCase().replace(h.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(h.PCT_ENCODED,_).replace(h.NOT_USERINFO,Se).replace(h.PCT_ENCODED,r)),m.host!==void 0&&(m.host=String(m.host).replace(h.PCT_ENCODED,_).toLowerCase().replace(h.NOT_HOST,Se).replace(h.PCT_ENCODED,r)),m.path!==void 0&&(m.path=String(m.path).replace(h.PCT_ENCODED,_).replace(m.scheme?h.NOT_PATH:h.NOT_PATH_NOSCHEME,Se).replace(h.PCT_ENCODED,r)),m.query!==void 0&&(m.query=String(m.query).replace(h.PCT_ENCODED,_).replace(h.NOT_QUERY,Se).replace(h.PCT_ENCODED,r)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(h.PCT_ENCODED,_).replace(h.NOT_FRAGMENT,Se).replace(h.PCT_ENCODED,r)),m}function ir(m){return m.replace(/^0*(.*)/,"$1")||"0"}function Pe(m,h){var _=m.match(h.IPV4ADDRESS)||[],P=f(_,2),x=P[1];return x?x.split(".").map(ir).join("."):m}function ge(m,h){var _=m.match(h.IPV6ADDRESS)||[],P=f(_,3),x=P[1],N=P[2];if(x){for(var W=x.toLowerCase().split("::").reverse(),ae=f(W,2),ie=ae[0],Ee=ae[1],te=Ee?Ee.split(":").map(ir):[],pe=ie.split(":").map(ir),xe=h.IPV4ADDRESS.test(pe[pe.length-1]),he=xe?7:8,ne=pe.length-he,me=Array(he),ce=0;ce<he;++ce)me[ce]=te[ce]||pe[ne+ce]||"";xe&&(me[he-1]=Pe(me[he-1],h));var Or=me.reduce(function(Ze,tr,Ar){if(!tr||tr==="0"){var cr=Ze[Ze.length-1];cr&&cr.index+cr.length===Ar?cr.length++:Ze.push({index:Ar,length:1})}return Ze},[]),He=Or.sort(function(Ze,tr){return tr.length-Ze.length})[0],Ue=void 0;if(He&&He.length>1){var ue=me.slice(0,He.index),ze=me.slice(He.index+He.length);Ue=ue.join(":")+"::"+ze.join(":")}else Ue=me.join(":");return N&&(Ue+="%"+N),Ue}else return m}var wr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Oe="".match(/(){0}/)[1]===void 0;function oe(m){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_={},P=h.iri!==!1?u:l;h.reference==="suffix"&&(m=(h.scheme?h.scheme+":":"")+"//"+m);var x=m.match(wr);if(x){Oe?(_.scheme=x[1],_.userinfo=x[3],_.host=x[4],_.port=parseInt(x[5],10),_.path=x[6]||"",_.query=x[7],_.fragment=x[8],isNaN(_.port)&&(_.port=x[5])):(_.scheme=x[1]||void 0,_.userinfo=m.indexOf("@")!==-1?x[3]:void 0,_.host=m.indexOf("//")!==-1?x[4]:void 0,_.port=parseInt(x[5],10),_.path=x[6]||"",_.query=m.indexOf("?")!==-1?x[7]:void 0,_.fragment=m.indexOf("#")!==-1?x[8]:void 0,isNaN(_.port)&&(_.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?x[4]:void 0)),_.host&&(_.host=ge(Pe(_.host,P),P)),_.scheme===void 0&&_.userinfo===void 0&&_.host===void 0&&_.port===void 0&&!_.path&&_.query===void 0?_.reference="same-document":_.scheme===void 0?_.reference="relative":_.fragment===void 0?_.reference="absolute":_.reference="uri",h.reference&&h.reference!=="suffix"&&h.reference!==_.reference&&(_.error=_.error||"URI is not a "+h.reference+" reference.");var N=be[(h.scheme||_.scheme||"").toLowerCase()];if(!h.unicodeSupport&&(!N||!N.unicodeSupport)){if(_.host&&(h.domainHost||N&&N.domainHost))try{_.host=se.toASCII(_.host.replace(P.PCT_ENCODED,ke).toLowerCase())}catch(W){_.error=_.error||"Host's domain name can not be converted to ASCII via punycode: "+W}vr(_,l)}else vr(_,P);N&&N.parse&&N.parse(_,h)}else _.error=_.error||"URI can not be parsed.";return _}function gr(m,h){var _=h.iri!==!1?u:l,P=[];return m.userinfo!==void 0&&(P.push(m.userinfo),P.push("@")),m.host!==void 0&&P.push(ge(Pe(String(m.host),_),_).replace(_.IPV6ADDRESS,function(x,N,W){return"["+N+(W?"%25"+W:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(P.push(":"),P.push(String(m.port))),P.length?P.join(""):void 0}var lr=/^\.\.?\//,Rr=/^\/\.(\/|$)/,Tr=/^\/\.\.(\/|$)/,we=/^\/?(?:.|\n)*?(?=\/|$)/;function Ve(m){for(var h=[];m.length;)if(m.match(lr))m=m.replace(lr,"");else if(m.match(Rr))m=m.replace(Rr,"/");else if(m.match(Tr))m=m.replace(Tr,"/"),h.pop();else if(m==="."||m==="..")m="";else{var _=m.match(we);if(_){var P=_[0];m=m.slice(P.length),h.push(P)}else throw new Error("Unexpected dot segment condition")}return h.join("")}function De(m){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=h.iri?u:l,P=[],x=be[(h.scheme||m.scheme||"").toLowerCase()];if(x&&x.serialize&&x.serialize(m,h),m.host&&!_.IPV6ADDRESS.test(m.host)){if(h.domainHost||x&&x.domainHost)try{m.host=h.iri?se.toUnicode(m.host):se.toASCII(m.host.replace(_.PCT_ENCODED,ke).toLowerCase())}catch(ae){m.error=m.error||"Host's domain name can not be converted to "+(h.iri?"Unicode":"ASCII")+" via punycode: "+ae}}vr(m,_),h.reference!=="suffix"&&m.scheme&&(P.push(m.scheme),P.push(":"));var N=gr(m,h);if(N!==void 0&&(h.reference!=="suffix"&&P.push("//"),P.push(N),m.path&&m.path.charAt(0)!=="/"&&P.push("/")),m.path!==void 0){var W=m.path;!h.absolutePath&&(!x||!x.absolutePath)&&(W=Ve(W)),N===void 0&&(W=W.replace(/^\/\//,"/%2F")),P.push(W)}return m.query!==void 0&&(P.push("?"),P.push(m.query)),m.fragment!==void 0&&(P.push("#"),P.push(m.fragment)),P.join("")}function Ce(m,h){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments[3],x={};return P||(m=oe(De(m,_),_),h=oe(De(h,_),_)),_=_||{},!_.tolerant&&h.scheme?(x.scheme=h.scheme,x.userinfo=h.userinfo,x.host=h.host,x.port=h.port,x.path=Ve(h.path||""),x.query=h.query):(h.userinfo!==void 0||h.host!==void 0||h.port!==void 0?(x.userinfo=h.userinfo,x.host=h.host,x.port=h.port,x.path=Ve(h.path||""),x.query=h.query):(h.path?(h.path.charAt(0)==="/"?x.path=Ve(h.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?x.path="/"+h.path:m.path?x.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+h.path:x.path=h.path,x.path=Ve(x.path)),x.query=h.query):(x.path=m.path,h.query!==void 0?x.query=h.query:x.query=m.query),x.userinfo=m.userinfo,x.host=m.host,x.port=m.port),x.scheme=m.scheme),x.fragment=h.fragment,x}function er(m,h,_){var P=i({scheme:"null"},_);return De(Ce(oe(m,P),oe(h,P),P,!0),P)}function Me(m,h){return typeof m=="string"?m=De(oe(m,h),h):s(m)==="object"&&(m=oe(De(m,h),h)),m}function Dt(m,h,_){return typeof m=="string"?m=De(oe(m,_),_):s(m)==="object"&&(m=De(m,_)),typeof h=="string"?h=De(oe(h,_),_):s(h)==="object"&&(h=De(h,_)),m===h}function Ua(m,h){return m&&m.toString().replace(!h||!h.iri?l.ESCAPE:u.ESCAPE,Se)}function We(m,h){return m&&m.toString().replace(!h||!h.iri?l.PCT_ENCODED:u.PCT_ENCODED,ke)}var gt={scheme:"http",domainHost:!0,parse:function(h,_){return h.host||(h.error=h.error||"HTTP URIs must have a host."),h},serialize:function(h,_){var P=String(h.scheme).toLowerCase()==="https";return(h.port===(P?443:80)||h.port==="")&&(h.port=void 0),h.path||(h.path="/"),h}},Gs={scheme:"https",domainHost:gt.domainHost,parse:gt.parse,serialize:gt.serialize};function Ys(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var yt={scheme:"ws",domainHost:!0,parse:function(h,_){var P=h;return P.secure=Ys(P),P.resourceName=(P.path||"/")+(P.query?"?"+P.query:""),P.path=void 0,P.query=void 0,P},serialize:function(h,_){if((h.port===(Ys(h)?443:80)||h.port==="")&&(h.port=void 0),typeof h.secure=="boolean"&&(h.scheme=h.secure?"wss":"ws",h.secure=void 0),h.resourceName){var P=h.resourceName.split("?"),x=f(P,2),N=x[0],W=x[1];h.path=N&&N!=="/"?N:void 0,h.query=W,h.resourceName=void 0}return h.fragment=void 0,h}},Xs={scheme:"wss",domainHost:yt.domainHost,parse:yt.parse,serialize:yt.serialize},Wl={},Gl=!0,en="[A-Za-z0-9\\-\\.\\_\\~"+(Gl?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",rr="[0-9A-Fa-f]",Yl=a(a("%[EFef]"+rr+"%"+rr+rr+"%"+rr+rr)+"|"+a("%[89A-Fa-f]"+rr+"%"+rr+rr)+"|"+a("%"+rr+rr)),Xl="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",ec="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",rc=e(ec,'[\\"\\\\]'),tc="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ac=new RegExp(en,"g"),Gr=new RegExp(Yl,"g"),sc=new RegExp(e("[^]",Xl,"[\\.]",'[\\"]',rc),"g"),rn=new RegExp(e("[^]",en,tc),"g"),nc=rn;function Za(m){var h=ke(m);return h.match(ac)?h:m}var tn={scheme:"mailto",parse:function(h,_){var P=h,x=P.to=P.path?P.path.split(","):[];if(P.path=void 0,P.query){for(var N=!1,W={},ae=P.query.split("&"),ie=0,Ee=ae.length;ie<Ee;++ie){var te=ae[ie].split("=");switch(te[0]){case"to":for(var pe=te[1].split(","),xe=0,he=pe.length;xe<he;++xe)x.push(pe[xe]);break;case"subject":P.subject=We(te[1],_);break;case"body":P.body=We(te[1],_);break;default:N=!0,W[We(te[0],_)]=We(te[1],_);break}}N&&(P.headers=W)}P.query=void 0;for(var ne=0,me=x.length;ne<me;++ne){var ce=x[ne].split("@");if(ce[0]=We(ce[0]),_.unicodeSupport)ce[1]=We(ce[1],_).toLowerCase();else try{ce[1]=se.toASCII(We(ce[1],_).toLowerCase())}catch(Or){P.error=P.error||"Email address's domain name can not be converted to ASCII via punycode: "+Or}x[ne]=ce.join("@")}return P},serialize:function(h,_){var P=h,x=n(h.to);if(x){for(var N=0,W=x.length;N<W;++N){var ae=String(x[N]),ie=ae.lastIndexOf("@"),Ee=ae.slice(0,ie).replace(Gr,Za).replace(Gr,r).replace(sc,Se),te=ae.slice(ie+1);try{te=_.iri?se.toUnicode(te):se.toASCII(We(te,_).toLowerCase())}catch(ne){P.error=P.error||"Email address's domain name can not be converted to "+(_.iri?"Unicode":"ASCII")+" via punycode: "+ne}x[N]=Ee+"@"+te}P.path=x.join(",")}var pe=h.headers=h.headers||{};h.subject&&(pe.subject=h.subject),h.body&&(pe.body=h.body);var xe=[];for(var he in pe)pe[he]!==Wl[he]&&xe.push(he.replace(Gr,Za).replace(Gr,r).replace(rn,Se)+"="+pe[he].replace(Gr,Za).replace(Gr,r).replace(nc,Se));return xe.length&&(P.query=xe.join("&")),P}},oc=/^([^\:]+)\:(.*)/,an={scheme:"urn",parse:function(h,_){var P=h.path&&h.path.match(oc),x=h;if(P){var N=_.scheme||x.scheme||"urn",W=P[1].toLowerCase(),ae=P[2],ie=N+":"+(_.nid||W),Ee=be[ie];x.nid=W,x.nss=ae,x.path=void 0,Ee&&(x=Ee.parse(x,_))}else x.error=x.error||"URN can not be parsed.";return x},serialize:function(h,_){var P=_.scheme||h.scheme||"urn",x=h.nid,N=P+":"+(_.nid||x),W=be[N];W&&(h=W.serialize(h,_));var ae=h,ie=h.nss;return ae.path=(x||_.nid)+":"+ie,ae}},ic=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,sn={scheme:"urn:uuid",parse:function(h,_){var P=h;return P.uuid=P.nss,P.nss=void 0,!_.tolerant&&(!P.uuid||!P.uuid.match(ic))&&(P.error=P.error||"UUID is not valid."),P},serialize:function(h,_){var P=h;return P.nss=(h.uuid||"").toLowerCase(),P}};be[gt.scheme]=gt,be[Gs.scheme]=Gs,be[yt.scheme]=yt,be[Xs.scheme]=Xs,be[tn.scheme]=tn,be[an.scheme]=an,be[sn.scheme]=sn,t.SCHEMES=be,t.pctEncChar=Se,t.pctDecChars=ke,t.parse=oe,t.removeDotSegments=Ve,t.serialize=De,t.resolveComponents=Ce,t.resolve=er,t.normalize=Me,t.equal=Dt,t.escapeComponent=Ua,t.unescapeComponent=We,Object.defineProperty(t,"__esModule",{value:!0})})});var _a=Q((Gm,lo)=>{"use strict";lo.exports=function t(e,a){if(e===a)return!0;if(e&&a&&typeof e=="object"&&typeof a=="object"){if(e.constructor!==a.constructor)return!1;var s,r,n;if(Array.isArray(e)){if(s=e.length,s!=a.length)return!1;for(r=s;r--!==0;)if(!t(e[r],a[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===a.source&&e.flags===a.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===a.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===a.toString();if(n=Object.keys(e),s=n.length,s!==Object.keys(a).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(a,n[r]))return!1;for(r=s;r--!==0;){var i=n[r];if(!t(e[i],a[i]))return!1}return!0}return e!==e&&a!==a}});var uo=Q((Ym,co)=>{"use strict";co.exports=function(e){for(var a=0,s=e.length,r=0,n;r<s;)a++,n=e.charCodeAt(r++),n>=55296&&n<=56319&&r<s&&(n=e.charCodeAt(r),(n&64512)==56320&&r++);return a}});var Jr=Q((Xm,po)=>{"use strict";po.exports={copy:Nd,checkDataType:ys,checkDataTypes:Ld,coerceToTypes:Fd,toHash:bs,getProperty:Ps,escapeQuotes:Es,equal:_a(),ucs2length:uo(),varOccurences:Hd,varReplace:zd,schemaHasRules:Vd,schemaHasRulesExcept:Ud,schemaUnknownRules:Zd,toQuotedString:_s,getPathExpr:Bd,getPath:Qd,getData:Wd,unescapeFragment:Gd,unescapeJsonPointer:Ss,escapeFragment:Yd,escapeJsonPointer:xs};function Nd(t,e){e=e||{};for(var a in t)e[a]=t[a];return e}function ys(t,e,a,s){var r=s?" !== ":" === ",n=s?" || ":" && ",i=s?"!":"",o=s?"":"!";switch(t){case"null":return e+r+"null";case"array":return i+"Array.isArray("+e+")";case"object":return"("+i+e+n+"typeof "+e+r+'"object"'+n+o+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+r+'"number"'+n+o+"("+e+" % 1)"+n+e+r+e+(a?n+i+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+r+'"'+t+'"'+(a?n+i+"isFinite("+e+")":"")+")";default:return"typeof "+e+r+'"'+t+'"'}}function Ld(t,e,a){switch(t.length){case 1:return ys(t[0],e,a,!0);default:var s="",r=bs(t);r.array&&r.object&&(s=r.null?"(":"(!"+e+" || ",s+="typeof "+e+' !== "object")',delete r.null,delete r.array,delete r.object),r.number&&delete r.integer;for(var n in r)s+=(s?" && ":"")+ys(n,e,a,!0);return s}}var fo=bs(["string","number","integer","boolean","null"]);function Fd(t,e){if(Array.isArray(e)){for(var a=[],s=0;s<e.length;s++){var r=e[s];(fo[r]||t==="array"&&r==="array")&&(a[a.length]=r)}if(a.length)return a}else{if(fo[e])return[e];if(t==="array"&&e==="array")return["array"]}}function bs(t){for(var e={},a=0;a<t.length;a++)e[t[a]]=!0;return e}var qd=/^[a-z$_][a-z$_0-9]*$/i,Md=/'|\\/g;function Ps(t){return typeof t=="number"?"["+t+"]":qd.test(t)?"."+t:"['"+Es(t)+"']"}function Es(t){return t.replace(Md,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Hd(t,e){e+="[^0-9]";var a=t.match(new RegExp(e,"g"));return a?a.length:0}function zd(t,e,a){return e+="([^0-9])",a=a.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),a+"$1")}function Vd(t,e){if(typeof t=="boolean")return!t;for(var a in t)if(e[a])return!0}function Ud(t,e,a){if(typeof t=="boolean")return!t&&a!="not";for(var s in t)if(s!=a&&e[s])return!0}function Zd(t,e){if(typeof t!="boolean"){for(var a in t)if(!e[a])return a}}function _s(t){return"'"+Es(t)+"'"}function Bd(t,e,a,s){var r=a?"'/' + "+e+(s?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):s?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return ho(t,r)}function Qd(t,e,a){var s=_s(a?"/"+xs(e):Ps(e));return ho(t,s)}var Kd=/^\/(?:[^~]|~0|~1)*$/,Jd=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Wd(t,e,a){var s,r,n,i;if(t==="")return"rootData";if(t[0]=="/"){if(!Kd.test(t))throw new Error("Invalid JSON-pointer: "+t);r=t,n="rootData"}else{if(i=t.match(Jd),!i)throw new Error("Invalid JSON-pointer: "+t);if(s=+i[1],r=i[2],r=="#"){if(s>=e)throw new Error("Cannot access property/index "+s+" levels up, current level is "+e);return a[e-s]}if(s>e)throw new Error("Cannot access data "+s+" levels up, current level is "+e);if(n="data"+(e-s||""),!r)return n}for(var o=n,l=r.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(n+=Ps(Ss(f)),o+=" && "+n)}return o}function ho(t,e){return t=='""'?e:(t+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function Gd(t){return Ss(decodeURIComponent(t))}function Yd(t){return encodeURIComponent(xs(t))}function xs(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function Ss(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}});var ws=Q((ev,mo)=>{"use strict";var Xd=Jr();mo.exports=ef;function ef(t){Xd.copy(t,this)}});var go=Q((rv,vo)=>{"use strict";var Er=vo.exports=function(t,e,a){typeof e=="function"&&(a=e,e={}),a=e.cb||a;var s=typeof a=="function"?a:a.pre||function(){},r=a.post||function(){};ba(e,s,r,t,"",t)};Er.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};Er.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Er.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Er.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ba(t,e,a,s,r,n,i,o,l,u){if(s&&typeof s=="object"&&!Array.isArray(s)){e(s,r,n,i,o,l,u);for(var f in s){var p=s[f];if(Array.isArray(p)){if(f in Er.arrayKeywords)for(var y=0;y<p.length;y++)ba(t,e,a,p[y],r+"/"+f+"/"+y,n,r,f,s,y)}else if(f in Er.propsKeywords){if(p&&typeof p=="object")for(var d in p)ba(t,e,a,p[d],r+"/"+f+"/"+rf(d),n,r,f,s,d)}else(f in Er.keywords||t.allKeys&&!(f in Er.skipKeywords))&&ba(t,e,a,p,r+"/"+f,n,r,f,s)}a(s,r,n,i,o,l,u)}}function rf(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Ra=Q((tv,Po)=>{"use strict";var Ct=io(),yo=_a(),Sa=Jr(),Pa=ws(),tf=go();Po.exports=Sr;Sr.normalizeId=xr;Sr.fullPath=Ea;Sr.url=xa;Sr.ids=lf;Sr.inlineRef=Rs;Sr.schema=wa;function Sr(t,e,a){var s=this._refs[a];if(typeof s=="string")if(this._refs[s])s=this._refs[s];else return Sr.call(this,t,e,s);if(s=s||this._schemas[a],s instanceof Pa)return Rs(s.schema,this._opts.inlineRefs)?s.schema:s.validate||this._compile(s);var r=wa.call(this,e,a),n,i,o;return r&&(n=r.schema,e=r.root,o=r.baseId),n instanceof Pa?i=n.validate||t.call(this,n.schema,e,void 0,o):n!==void 0&&(i=Rs(n,this._opts.inlineRefs)?n:t.call(this,n,e,void 0,o)),i}function wa(t,e){var a=Ct.parse(e),s=bo(a),r=Ea(this._getId(t.schema));if(Object.keys(t.schema).length===0||s!==r){var n=xr(s),i=this._refs[n];if(typeof i=="string")return af.call(this,t,i,a);if(i instanceof Pa)i.validate||this._compile(i),t=i;else if(i=this._schemas[n],i instanceof Pa){if(i.validate||this._compile(i),n==xr(e))return{schema:i,root:t,baseId:r};t=i}else return;if(!t.schema)return;r=Ea(this._getId(t.schema))}return _o.call(this,a,r,t.schema,t)}function af(t,e,a){var s=wa.call(this,t,e);if(s){var r=s.schema,n=s.baseId;t=s.root;var i=this._getId(r);return i&&(n=xa(n,i)),_o.call(this,a,n,r,t)}}var sf=Sa.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function _o(t,e,a,s){if(t.fragment=t.fragment||"",t.fragment.slice(0,1)=="/"){for(var r=t.fragment.split("/"),n=1;n<r.length;n++){var i=r[n];if(i){if(i=Sa.unescapeFragment(i),a=a[i],a===void 0)break;var o;if(!sf[i]&&(o=this._getId(a),o&&(e=xa(e,o)),a.$ref)){var l=xa(e,a.$ref),u=wa.call(this,s,l);u&&(a=u.schema,s=u.root,e=u.baseId)}}}if(a!==void 0&&a!==s.schema)return{schema:a,root:s,baseId:e}}}var nf=Sa.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function Rs(t,e){if(e===!1)return!1;if(e===void 0||e===!0)return Ts(t);if(e)return Os(t)<=e}function Ts(t){var e;if(Array.isArray(t)){for(var a=0;a<t.length;a++)if(e=t[a],typeof e=="object"&&!Ts(e))return!1}else for(var s in t)if(s=="$ref"||(e=t[s],typeof e=="object"&&!Ts(e)))return!1;return!0}function Os(t){var e=0,a;if(Array.isArray(t)){for(var s=0;s<t.length;s++)if(a=t[s],typeof a=="object"&&(e+=Os(a)),e==1/0)return 1/0}else for(var r in t){if(r=="$ref")return 1/0;if(nf[r])e++;else if(a=t[r],typeof a=="object"&&(e+=Os(a)+1),e==1/0)return 1/0}return e}function Ea(t,e){e!==!1&&(t=xr(t));var a=Ct.parse(t);return bo(a)}function bo(t){return Ct.serialize(t).split("#")[0]+"#"}var of=/#\/?$/;function xr(t){return t?t.replace(of,""):""}function xa(t,e){return e=xr(e),Ct.resolve(t,e)}function lf(t){var e=xr(this._getId(t)),a={"":e},s={"":Ea(e,!1)},r={},n=this;return tf(t,{allKeys:!0},function(i,o,l,u,f,p,y){if(o!==""){var d=n._getId(i),v=a[u],b=s[u]+"/"+f;if(y!==void 0&&(b+="/"+(typeof y=="number"?y:Sa.escapeFragment(y))),typeof d=="string"){d=v=xr(v?Ct.resolve(v,d):d);var g=n._refs[d];if(typeof g=="string"&&(g=n._refs[g]),g&&g.schema){if(!yo(i,g.schema))throw new Error('id "'+d+'" resolves to more than one schema')}else if(d!=xr(b))if(d[0]=="#"){if(r[d]&&!yo(i,r[d]))throw new Error('id "'+d+'" resolves to more than one schema');r[d]=i}else n._refs[d]=b}a[o]=v,s[o]=b}}),r}});var Ta=Q((av,xo)=>{"use strict";var As=Ra();xo.exports={Validation:Eo(cf),MissingRef:Eo($s)};function cf(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}$s.message=function(t,e){return"can't resolve reference "+e+" from id "+t};function $s(t,e,a){this.message=a||$s.message(t,e),this.missingRef=As.url(t,e),this.missingSchema=As.normalizeId(As.fullPath(this.missingRef))}function Eo(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}});var Is=Q((sv,So)=>{"use strict";So.exports=function(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var a=typeof e.cycles=="boolean"?e.cycles:!1,s=e.cmp&&function(n){return function(i){return function(o,l){var u={key:o,value:i[o]},f={key:l,value:i[l]};return n(u,f)}}}(e.cmp),r=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i!==void 0){if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);var o,l;if(Array.isArray(i)){for(l="[",o=0;o<i.length;o++)o&&(l+=","),l+=n(i[o])||"null";return l+"]"}if(i===null)return"null";if(r.indexOf(i)!==-1){if(a)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=r.push(i)-1,f=Object.keys(i).sort(s&&s(i));for(l="",o=0;o<f.length;o++){var p=f[o],y=n(i[p]);y&&(l&&(l+=","),l+=JSON.stringify(p)+":"+y)}return r.splice(u,1),"{"+l+"}"}}(t)}});var ks=Q((nv,wo)=>{"use strict";wo.exports=function(e,a,s){var r="",n=e.schema.$async===!0,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var u="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(u);else throw new Error(u)}}if(e.isTop&&(r+=" var validate = ",n&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" "+("/*# sourceURL="+o+" */")+" ")),typeof e.schema=="boolean"||!(i||e.schema.$ref)){var a="false schema",f=e.level,p=e.dataLevel,y=e.schema[a],d=e.schemaPath+e.util.getProperty(a),v=e.errSchemaPath+"/"+a,$=!e.opts.allErrors,M,b="data"+(p||""),w="valid"+f;if(e.schema===!1){e.isTop?$=!0:r+=" var "+w+" = false; ";var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(M||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ";var E=r;r=g.pop(),!e.compositeRule&&$?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?r+=" return data; ":r+=" validate.errors = null; return true; ":r+=" var "+w+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var R=e.isTop,f=e.level=0,p=e.dataLevel=0,b="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var S="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{var f=e.level,p=e.dataLevel,b="data"+(p||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),n&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+f+" = errors;"}var w="valid"+f,$=!e.opts.allErrors,k="",L="",M,O=e.schema.type,H=Array.isArray(O);if(O&&e.opts.nullable&&e.schema.nullable===!0&&(H?O.indexOf("null")==-1&&(O=O.concat("null")):O!="null"&&(O=[O,"null"],H=!0)),H&&O.length==1&&(O=O[0],H=!1),e.schema.$ref&&i){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),O){if(e.opts.coerceTypes)var z=e.util.coerceToTypes(e.opts.coerceTypes,O);var F=e.RULES.types[O];if(z||H||F===!0||F&&!we(F)){var d=e.schemaPath+".type",v=e.errSchemaPath+"/type",d=e.schemaPath+".type",v=e.errSchemaPath+"/type",I=H?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[I](O,b,e.opts.strictNumbers,!0)+") { ",z){var C="dataType"+f,q="coerced"+f;r+=" var "+C+" = typeof "+b+"; var "+q+" = undefined; ",e.opts.coerceTypes=="array"&&(r+=" if ("+C+" == 'object' && Array.isArray("+b+") && "+b+".length == 1) { "+b+" = "+b+"[0]; "+C+" = typeof "+b+"; if ("+e.util.checkDataType(e.schema.type,b,e.opts.strictNumbers)+") "+q+" = "+b+"; } "),r+=" if ("+q+" !== undefined) ; ";var le=z;if(le)for(var Y,re=-1,G=le.length-1;re<G;)Y=le[re+=1],Y=="string"?r+=" else if ("+C+" == 'number' || "+C+" == 'boolean') "+q+" = '' + "+b+"; else if ("+b+" === null) "+q+" = ''; ":Y=="number"||Y=="integer"?(r+=" else if ("+C+" == 'boolean' || "+b+" === null || ("+C+" == 'string' && "+b+" && "+b+" == +"+b+" ",Y=="integer"&&(r+=" && !("+b+" % 1)"),r+=")) "+q+" = +"+b+"; "):Y=="boolean"?r+=" else if ("+b+" === 'false' || "+b+" === 0 || "+b+" === null) "+q+" = false; else if ("+b+" === 'true' || "+b+" === 1) "+q+" = true; ":Y=="null"?r+=" else if ("+b+" === '' || "+b+" === 0 || "+b+" === false) "+q+" = null; ":e.opts.coerceTypes=="array"&&Y=="array"&&(r+=" else if ("+C+" == 'string' || "+C+" == 'number' || "+C+" == 'boolean' || "+b+" == null) "+q+" = ["+b+"]; ");r+=" else {   ";var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(M||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",H?r+=""+O.join(","):r+=""+O,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",H?r+=""+O.join(","):r+=""+O,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ";var E=r;r=g.pop(),!e.compositeRule&&$?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+q+" !== undefined) {  ";var U=p?"data"+(p-1||""):"parentData",ve=p?e.dataPathArr[p]:"parentDataProperty";r+=" "+b+" = "+q+"; ",p||(r+="if ("+U+" !== undefined)"),r+=" "+U+"["+ve+"] = "+q+"; } "}else{var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(M||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",H?r+=""+O.join(","):r+=""+O,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",H?r+=""+O.join(","):r+=""+O,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ";var E=r;r=g.pop(),!e.compositeRule&&$?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(e.schema.$ref&&!i)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",$&&(r+=" } if (errors === ",R?r+="0":r+="errs_"+f,r+=") { ",L+="}");else{var Te=e.RULES;if(Te){for(var F,Ie=-1,se=Te.length-1;Ie<se;)if(F=Te[Ie+=1],we(F)){if(F.type&&(r+=" if ("+e.util.checkDataType(F.type,b,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(F.type=="object"&&e.schema.properties){var y=e.schema.properties,be=Object.keys(y),Se=be;if(Se)for(var ke,vr=-1,ir=Se.length-1;vr<ir;){ke=Se[vr+=1];var Pe=y[ke];if(Pe.default!==void 0){var ge=b+e.util.getProperty(ke);if(e.compositeRule){if(e.opts.strictDefaults){var S="default is ignored for: "+ge;if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}}else r+=" if ("+ge+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+ge+" === null || "+ge+" === '' "),r+=" ) "+ge+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(Pe.default)+" ":r+=" "+JSON.stringify(Pe.default)+" ",r+="; "}}}else if(F.type=="array"&&Array.isArray(e.schema.items)){var wr=e.schema.items;if(wr){for(var Pe,re=-1,Oe=wr.length-1;re<Oe;)if(Pe=wr[re+=1],Pe.default!==void 0){var ge=b+"["+re+"]";if(e.compositeRule){if(e.opts.strictDefaults){var S="default is ignored for: "+ge;if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}}else r+=" if ("+ge+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+ge+" === null || "+ge+" === '' "),r+=" ) "+ge+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(Pe.default)+" ":r+=" "+JSON.stringify(Pe.default)+" ",r+="; "}}}}var oe=F.rules;if(oe){for(var gr,lr=-1,Rr=oe.length-1;lr<Rr;)if(gr=oe[lr+=1],Ve(gr)){var Tr=gr.code(e,gr.keyword,F.type);Tr&&(r+=" "+Tr+" ",$&&(k+="}"))}}if($&&(r+=" "+k+" ",k=""),F.type&&(r+=" } ",O&&O===F.type&&!z)){r+=" else { ";var d=e.schemaPath+".type",v=e.errSchemaPath+"/type",g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(M||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",H?r+=""+O.join(","):r+=""+O,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",H?r+=""+O.join(","):r+=""+O,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ";var E=r;r=g.pop(),!e.compositeRule&&$?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}$&&(r+=" if (errors === ",R?r+="0":r+="errs_"+f,r+=") { ",L+="}")}}}$&&(r+=" "+L+" "),R?(n?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+w+" = errors === errs_"+f+";";function we(Ce){for(var er=Ce.rules,Me=0;Me<er.length;Me++)if(Ve(er[Me]))return!0}function Ve(Ce){return e.schema[Ce.keyword]!==void 0||Ce.implements&&De(Ce)}function De(Ce){for(var er=Ce.implements,Me=0;Me<er.length;Me++)if(e.schema[er[Me]]!==void 0)return!0}return r}});var $o=Q((ov,Ao)=>{"use strict";var Oa=Ra(),$a=Jr(),To=Ta(),uf=Is(),Ro=ks(),df=$a.ucs2length,ff=_a(),hf=To.Validation;Ao.exports=Cs;function Cs(t,e,a,s){var r=this,n=this._opts,i=[void 0],o={},l=[],u={},f=[],p={},y=[];e=e||{schema:t,refVal:i,refs:o};var d=pf.call(this,t,e,s),v=this._compilations[d.index];if(d.compiling)return v.callValidate=S;var b=this._formats,g=this.RULES;try{var E=w(t,e,a,s);v.validate=E;var R=v.callValidate;return R&&(R.schema=E.schema,R.errors=null,R.refs=E.refs,R.refVal=E.refVal,R.root=E.root,R.$async=E.$async,n.sourceCode&&(R.source=E.source)),E}finally{mf.call(this,t,e,s)}function S(){var I=v.validate,C=I.apply(this,arguments);return S.errors=I.errors,C}function w(I,C,q,le){var Y=!C||C&&C.schema==I;if(C.schema!=e.schema)return Cs.call(r,I,C,q,le);var re=I.$async===!0,G=Ro({isTop:!0,schema:I,isRoot:Y,baseId:le,root:C,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:To.MissingRef,RULES:g,validate:Ro,util:$a,resolve:Oa,resolveRef:$,usePattern:H,useDefault:z,useCustomRule:F,opts:n,formats:b,logger:r.logger,self:r});G=Aa(i,yf)+Aa(l,vf)+Aa(f,gf)+Aa(y,_f)+G,n.processCode&&(G=n.processCode(G,I));var U;try{var ve=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",G);U=ve(r,g,b,e,i,f,y,ff,df,hf),i[0]=U}catch(Te){throw r.logger.error("Error compiling schema, function code:",G),Te}return U.schema=I,U.errors=null,U.refs=o,U.refVal=i,U.root=Y?U:C,re&&(U.$async=!0),n.sourceCode===!0&&(U.source={code:G,patterns:l,defaults:f}),U}function $(I,C,q){C=Oa.url(I,C);var le=o[C],Y,re;if(le!==void 0)return Y=i[le],re="refVal["+le+"]",O(Y,re);if(!q&&e.refs){var G=e.refs[C];if(G!==void 0)return Y=e.refVal[G],re=k(C,Y),O(Y,re)}re=k(C);var U=Oa.call(r,w,e,C);if(U===void 0){var ve=a&&a[C];ve&&(U=Oa.inlineRef(ve,n.inlineRefs)?ve:Cs.call(r,ve,e,a,I))}if(U===void 0)L(C);else return M(C,U),O(U,re)}function k(I,C){var q=i.length;return i[q]=C,o[I]=q,"refVal"+q}function L(I){delete o[I]}function M(I,C){var q=o[I];i[q]=C}function O(I,C){return typeof I=="object"||typeof I=="boolean"?{code:C,schema:I,inline:!0}:{code:C,$async:I&&!!I.$async}}function H(I){var C=u[I];return C===void 0&&(C=u[I]=l.length,l[C]=I),"pattern"+C}function z(I){switch(typeof I){case"boolean":case"number":return""+I;case"string":return $a.toQuotedString(I);case"object":if(I===null)return"null";var C=uf(I),q=p[C];return q===void 0&&(q=p[C]=f.length,f[q]=I),"default"+q}}function F(I,C,q,le){if(r._opts.validateSchema!==!1){var Y=I.definition.dependencies;if(Y&&!Y.every(function(Se){return Object.prototype.hasOwnProperty.call(q,Se)}))throw new Error("parent schema must have all required keywords: "+Y.join(","));var re=I.definition.validateSchema;if(re){var G=re(C);if(!G){var U="keyword schema is invalid: "+r.errorsText(re.errors);if(r._opts.validateSchema=="log")r.logger.error(U);else throw new Error(U)}}}var ve=I.definition.compile,Te=I.definition.inline,Ie=I.definition.macro,se;if(ve)se=ve.call(r,C,q,le);else if(Ie)se=Ie.call(r,C,q,le),n.validateSchema!==!1&&r.validateSchema(se,!0);else if(Te)se=Te.call(r,le,I.keyword,C,q);else if(se=I.definition.validate,!se)return;if(se===void 0)throw new Error('custom keyword "'+I.keyword+'"failed to compile');var be=y.length;return y[be]=se,{code:"customRule"+be,validate:se}}}function pf(t,e,a){var s=Oo.call(this,t,e,a);return s>=0?{index:s,compiling:!0}:(s=this._compilations.length,this._compilations[s]={schema:t,root:e,baseId:a},{index:s,compiling:!1})}function mf(t,e,a){var s=Oo.call(this,t,e,a);s>=0&&this._compilations.splice(s,1)}function Oo(t,e,a){for(var s=0;s<this._compilations.length;s++){var r=this._compilations[s];if(r.schema==t&&r.root==e&&r.baseId==a)return s}return-1}function vf(t,e){return"var pattern"+t+" = new RegExp("+$a.toQuotedString(e[t])+");"}function gf(t){return"var default"+t+" = defaults["+t+"];"}function yf(t,e){return e[t]===void 0?"":"var refVal"+t+" = refVal["+t+"];"}function _f(t){return"var customRule"+t+" = customRules["+t+"];"}function Aa(t,e){if(!t.length)return"";for(var a="",s=0;s<t.length;s++)a+=e(s,t);return a}});var ko=Q((iv,Io)=>{"use strict";var Ia=Io.exports=function(){this._cache={}};Ia.prototype.put=function(e,a){this._cache[e]=a};Ia.prototype.get=function(e){return this._cache[e]};Ia.prototype.del=function(e){delete this._cache[e]};Ia.prototype.clear=function(){this._cache={}}});var Uo=Q((lv,Vo)=>{"use strict";var bf=Jr(),Pf=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Ef=[0,31,28,31,30,31,30,31,31,30,31,30,31],xf=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Co=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Sf=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,wf=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,jo=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Do=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,No=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Lo=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Fo=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,qo=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Vo.exports=ka;function ka(t){return t=t=="full"?"full":"fast",bf.copy(ka[t])}ka.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":jo,url:Do,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:Co,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:zo,uuid:No,"json-pointer":Lo,"json-pointer-uri-fragment":Fo,"relative-json-pointer":qo};ka.full={date:Mo,time:Ho,"date-time":Of,uri:$f,"uri-reference":wf,"uri-template":jo,url:Do,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:Co,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:zo,uuid:No,"json-pointer":Lo,"json-pointer-uri-fragment":Fo,"relative-json-pointer":qo};function Rf(t){return t%4===0&&(t%100!==0||t%400===0)}function Mo(t){var e=t.match(Pf);if(!e)return!1;var a=+e[1],s=+e[2],r=+e[3];return s>=1&&s<=12&&r>=1&&r<=(s==2&&Rf(a)?29:Ef[s])}function Ho(t,e){var a=t.match(xf);if(!a)return!1;var s=a[1],r=a[2],n=a[3],i=a[5];return(s<=23&&r<=59&&n<=59||s==23&&r==59&&n==60)&&(!e||i)}var Tf=/t|\s/i;function Of(t){var e=t.split(Tf);return e.length==2&&Mo(e[0])&&Ho(e[1],!0)}var Af=/\/|:/;function $f(t){return Af.test(t)&&Sf.test(t)}var If=/[^\\]\\Z/;function zo(t){if(If.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Bo=Q((cv,Zo)=>{"use strict";Zo.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.errSchemaPath+"/"+a,u=!e.opts.allErrors,f="data"+(i||""),p="valid"+n,y,d;if(o=="#"||o=="#/")e.isRoot?(y=e.async,d="validate"):(y=e.root.schema.$async===!0,d="root.refVal[0]");else{var v=e.resolveRef(e.baseId,o,e.isRoot);if(v===void 0){var b=e.MissingRefError.message(e.baseId,o);if(e.opts.missingRefs=="fail"){e.logger.error(b);var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",e.opts.messages!==!1&&(r+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(r+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var E=r;r=g.pop(),!e.compositeRule&&u?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(r+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(b),u&&(r+=" if (true) { ");else throw new e.MissingRefError(e.baseId,o,b)}else if(v.inline){var R=e.util.copy(e);R.level++;var S="valid"+R.level;R.schema=v.schema,R.schemaPath="",R.errSchemaPath=o;var w=e.validate(R).replace(/validate\.schema/g,v.code);r+=" "+w+" ",u&&(r+=" if ("+S+") { ")}else y=v.$async===!0||e.async&&v.$async!==!1,d=v.code}if(d){var g=g||[];g.push(r),r="",e.opts.passContext?r+=" "+d+".call(this, ":r+=" "+d+"( ",r+=" "+f+", (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var $=i?"data"+(i-1||""):"parentData",k=i?e.dataPathArr[i]:"parentDataProperty";r+=" , "+$+" , "+k+", rootData)  ";var L=r;if(r=g.pop(),y){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(r+=" var "+p+"; "),r+=" try { await "+L+"; ",u&&(r+=" "+p+" = true; "),r+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(r+=" "+p+" = false; "),r+=" } ",u&&(r+=" if ("+p+") { ")}else r+=" if (!"+L+") { if (vErrors === null) vErrors = "+d+".errors; else vErrors = vErrors.concat("+d+".errors); errors = vErrors.length; } ",u&&(r+=" else { ")}return r}});var Ko=Q((uv,Qo)=>{"use strict";Qo.exports=function(e,a,s){var r=" ",n=e.schema[a],i=e.schemaPath+e.util.getProperty(a),o=e.errSchemaPath+"/"+a,l=!e.opts.allErrors,u=e.util.copy(e),f="";u.level++;var p="valid"+u.level,y=u.baseId,d=!0,v=n;if(v)for(var b,g=-1,E=v.length-1;g<E;)b=v[g+=1],(e.opts.strictKeywords?typeof b=="object"&&Object.keys(b).length>0||b===!1:e.util.schemaHasRules(b,e.RULES.all))&&(d=!1,u.schema=b,u.schemaPath=i+"["+g+"]",u.errSchemaPath=o+"/"+g,r+="  "+e.validate(u)+" ",u.baseId=y,l&&(r+=" if ("+p+") { ",f+="}"));return l&&(d?r+=" if (true) { ":r+=" "+f.slice(0,-1)+" "),r}});var Wo=Q((dv,Jo)=>{"use strict";Jo.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d="errs__"+n,v=e.util.copy(e),b="";v.level++;var g="valid"+v.level,E=o.every(function(M){return e.opts.strictKeywords?typeof M=="object"&&Object.keys(M).length>0||M===!1:e.util.schemaHasRules(M,e.RULES.all)});if(E){var R=v.baseId;r+=" var "+d+" = errors; var "+y+" = false;  ";var S=e.compositeRule;e.compositeRule=v.compositeRule=!0;var w=o;if(w)for(var $,k=-1,L=w.length-1;k<L;)$=w[k+=1],v.schema=$,v.schemaPath=l+"["+k+"]",v.errSchemaPath=u+"/"+k,r+="  "+e.validate(v)+" ",v.baseId=R,r+=" "+y+" = "+y+" || "+g+"; if (!"+y+") { ",b+="}";e.compositeRule=v.compositeRule=S,r+=" "+b+" if (!"+y+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else f&&(r+=" if (true) { ");return r}});var Yo=Q((fv,Go)=>{"use strict";Go.exports=function(e,a,s){var r=" ",n=e.schema[a],i=e.errSchemaPath+"/"+a,o=!e.opts.allErrors,l=e.util.toQuotedString(n);return e.opts.$comment===!0?r+=" console.log("+l+");":typeof e.opts.$comment=="function"&&(r+=" self._opts.$comment("+l+", "+e.util.toQuotedString(i)+", validate.root.schema);"),r}});var ei=Q((hv,Xo)=>{"use strict";Xo.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d=e.opts.$data&&o&&o.$data,v;d?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o,d||(r+=" var schema"+n+" = validate.schema"+l+";"),r+="var "+y+" = equal("+p+", schema"+n+"); if (!"+y+") {   ";var b=b||[];b.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var g=r;return r=b.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",f&&(r+=" else { "),r}});var ti=Q((pv,ri)=>{"use strict";ri.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d="errs__"+n,v=e.util.copy(e),b="";v.level++;var g="valid"+v.level,E="i"+n,R=v.dataLevel=e.dataLevel+1,S="data"+R,w=e.baseId,$=e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all);if(r+="var "+d+" = errors;var "+y+";",$){var k=e.compositeRule;e.compositeRule=v.compositeRule=!0,v.schema=o,v.schemaPath=l,v.errSchemaPath=u,r+=" var "+g+" = false; for (var "+E+" = 0; "+E+" < "+p+".length; "+E+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var L=p+"["+E+"]";v.dataPathArr[R]=E;var M=e.validate(v);v.baseId=w,e.util.varOccurences(M,S)<2?r+=" "+e.util.varReplace(M,S,L)+" ":r+=" var "+S+" = "+L+"; "+M+" ",r+=" if ("+g+") break; }  ",e.compositeRule=v.compositeRule=k,r+=" "+b+" if (!"+g+") {"}else r+=" if ("+p+".length == 0) {";var O=O||[];O.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var H=r;return r=O.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+H+"]); ":r+=" validate.errors = ["+H+"]; return false; ":r+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",$&&(r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}});var si=Q((mv,ai)=>{"use strict";ai.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,d=e.util.copy(e),v="";d.level++;var b="valid"+d.level,g={},E={},R=e.opts.ownProperties;for(k in o)if(k!="__proto__"){var S=o[k],w=Array.isArray(S)?E:g;w[k]=S}r+="var "+y+" = errors;";var $=e.errorPath;r+="var missing"+n+";";for(var k in E)if(w=E[k],w.length){if(r+=" if ( "+p+e.util.getProperty(k)+" !== undefined ",R&&(r+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(k)+"') "),f){r+=" && ( ";var L=w;if(L)for(var M,O=-1,H=L.length-1;O<H;){M=L[O+=1],O&&(r+=" || ");var z=e.util.getProperty(M),F=p+z;r+=" ( ( "+F+" === undefined ",R&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(M)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?M:z)+") ) "}r+=")) {  ";var I="missing"+n,C="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr($,I,!0):$+" + "+I);var q=q||[];q.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(k)+"', missingProperty: '"+C+"', depsCount: "+w.length+", deps: '"+e.util.escapeQuotes(w.length==1?w[0]:w.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",w.length==1?r+="property "+e.util.escapeQuotes(w[0]):r+="properties "+e.util.escapeQuotes(w.join(", ")),r+=" when property "+e.util.escapeQuotes(k)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var le=r;r=q.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+le+"]); ":r+=" validate.errors = ["+le+"]; return false; ":r+=" var err = "+le+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var Y=w;if(Y)for(var M,re=-1,G=Y.length-1;re<G;){M=Y[re+=1];var z=e.util.getProperty(M),C=e.util.escapeQuotes(M),F=p+z;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath($,M,e.opts.jsonPointers)),r+=" if ( "+F+" === undefined ",R&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(M)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(k)+"', missingProperty: '"+C+"', depsCount: "+w.length+", deps: '"+e.util.escapeQuotes(w.length==1?w[0]:w.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",w.length==1?r+="property "+e.util.escapeQuotes(w[0]):r+="properties "+e.util.escapeQuotes(w.join(", ")),r+=" when property "+e.util.escapeQuotes(k)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",f&&(v+="}",r+=" else { ")}e.errorPath=$;var U=d.baseId;for(var k in g){var S=g[k];(e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===!1:e.util.schemaHasRules(S,e.RULES.all))&&(r+=" "+b+" = true; if ( "+p+e.util.getProperty(k)+" !== undefined ",R&&(r+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(k)+"') "),r+=") { ",d.schema=S,d.schemaPath=l+e.util.getProperty(k),d.errSchemaPath=u+"/"+e.util.escapeFragment(k),r+="  "+e.validate(d)+" ",d.baseId=U,r+=" }  ",f&&(r+=" if ("+b+") { ",v+="}"))}return f&&(r+="   "+v+" if ("+y+" == errors) {"),r}});var oi=Q((vv,ni)=>{"use strict";ni.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d=e.opts.$data&&o&&o.$data,v;d?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o;var b="i"+n,g="schema"+n;d||(r+=" var "+g+" = validate.schema"+l+";"),r+="var "+y+";",d&&(r+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),r+=""+y+" = false;for (var "+b+"=0; "+b+"<"+g+".length; "+b+"++) if (equal("+p+", "+g+"["+b+"])) { "+y+" = true; break; }",d&&(r+="  }  "),r+=" if (!"+y+") {   ";var E=E||[];E.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var R=r;return r=E.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+R+"]); ":r+=" validate.errors = ["+R+"]; return false; ":r+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",f&&(r+=" else { "),r}});var li=Q((gv,ii)=>{"use strict";ii.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||"");if(e.opts.format===!1)return f&&(r+=" if (true) { "),r;var y=e.opts.$data&&o&&o.$data,d;y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var v=e.opts.unknownFormats,b=Array.isArray(v);if(y){var g="format"+n,E="isObject"+n,R="formatType"+n;r+=" var "+g+" = formats["+d+"]; var "+E+" = typeof "+g+" == 'object' && !("+g+" instanceof RegExp) && "+g+".validate; var "+R+" = "+E+" && "+g+".type || 'string'; if ("+E+") { ",e.async&&(r+=" var async"+n+" = "+g+".async; "),r+=" "+g+" = "+g+".validate; } if (  ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" (",v!="ignore"&&(r+=" ("+d+" && !"+g+" ",b&&(r+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),r+=") || "),r+=" ("+g+" && "+R+" == '"+s+"' && !(typeof "+g+" == 'function' ? ",e.async?r+=" (async"+n+" ? await "+g+"("+p+") : "+g+"("+p+")) ":r+=" "+g+"("+p+") ",r+=" : "+g+".test("+p+"))))) {"}else{var g=e.formats[o];if(!g){if(v=="ignore")return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),f&&(r+=" if (true) { "),r;if(b&&v.indexOf(o)>=0)return f&&(r+=" if (true) { "),r;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var E=typeof g=="object"&&!(g instanceof RegExp)&&g.validate,R=E&&g.type||"string";if(E){var S=g.async===!0;g=g.validate}if(R!=s)return f&&(r+=" if (true) { "),r;if(S){if(!e.async)throw new Error("async format in sync schema");var w="formats"+e.util.getProperty(o)+".validate";r+=" if (!(await "+w+"("+p+"))) { "}else{r+=" if (! ";var w="formats"+e.util.getProperty(o);E&&(w+=".validate"),typeof g=="function"?r+=" "+w+"("+p+") ":r+=" "+w+".test("+p+") ",r+=") { "}}var $=$||[];$.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",y?r+=""+d:r+=""+e.util.toQuotedString(o),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match format "`,y?r+="' + "+d+" + '":r+=""+e.util.escapeQuotes(o),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+e.util.toQuotedString(o),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var k=r;return r=$.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { "),r}});var ui=Q((yv,ci)=>{"use strict";ci.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d="errs__"+n,v=e.util.copy(e);v.level++;var b="valid"+v.level,g=e.schema.then,E=e.schema.else,R=g!==void 0&&(e.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:e.util.schemaHasRules(g,e.RULES.all)),S=E!==void 0&&(e.opts.strictKeywords?typeof E=="object"&&Object.keys(E).length>0||E===!1:e.util.schemaHasRules(E,e.RULES.all)),w=v.baseId;if(R||S){var $;v.createErrors=!1,v.schema=o,v.schemaPath=l,v.errSchemaPath=u,r+=" var "+d+" = errors; var "+y+" = true;  ";var k=e.compositeRule;e.compositeRule=v.compositeRule=!0,r+="  "+e.validate(v)+" ",v.baseId=w,v.createErrors=!0,r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=v.compositeRule=k,R?(r+=" if ("+b+") {  ",v.schema=e.schema.then,v.schemaPath=e.schemaPath+".then",v.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(v)+" ",v.baseId=w,r+=" "+y+" = "+b+"; ",R&&S?($="ifClause"+n,r+=" var "+$+" = 'then'; "):$="'then'",r+=" } ",S&&(r+=" else { ")):r+=" if (!"+b+") { ",S&&(v.schema=e.schema.else,v.schemaPath=e.schemaPath+".else",v.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(v)+" ",v.baseId=w,r+=" "+y+" = "+b+"; ",R&&S?($="ifClause"+n,r+=" var "+$+" = 'else'; "):$="'else'",r+=" } "),r+=" if (!"+y+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+$+" } ",e.opts.messages!==!1&&(r+=` , message: 'should match "' + `+$+` + '" schema' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",f&&(r+=" else { ")}else f&&(r+=" if (true) { ");return r}});var fi=Q((_v,di)=>{"use strict";di.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d="errs__"+n,v=e.util.copy(e),b="";v.level++;var g="valid"+v.level,E="i"+n,R=v.dataLevel=e.dataLevel+1,S="data"+R,w=e.baseId;if(r+="var "+d+" = errors;var "+y+";",Array.isArray(o)){var $=e.schema.additionalItems;if($===!1){r+=" "+y+" = "+p+".length <= "+o.length+"; ";var k=u;u=e.errSchemaPath+"/additionalItems",r+="  if (!"+y+") {   ";var L=L||[];L.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+o.length+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var M=r;r=L.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+M+"]); ":r+=" validate.errors = ["+M+"]; return false; ":r+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",u=k,f&&(b+="}",r+=" else { ")}var O=o;if(O){for(var H,z=-1,F=O.length-1;z<F;)if(H=O[z+=1],e.opts.strictKeywords?typeof H=="object"&&Object.keys(H).length>0||H===!1:e.util.schemaHasRules(H,e.RULES.all)){r+=" "+g+" = true; if ("+p+".length > "+z+") { ";var I=p+"["+z+"]";v.schema=H,v.schemaPath=l+"["+z+"]",v.errSchemaPath=u+"/"+z,v.errorPath=e.util.getPathExpr(e.errorPath,z,e.opts.jsonPointers,!0),v.dataPathArr[R]=z;var C=e.validate(v);v.baseId=w,e.util.varOccurences(C,S)<2?r+=" "+e.util.varReplace(C,S,I)+" ":r+=" var "+S+" = "+I+"; "+C+" ",r+=" }  ",f&&(r+=" if ("+g+") { ",b+="}")}}if(typeof $=="object"&&(e.opts.strictKeywords?typeof $=="object"&&Object.keys($).length>0||$===!1:e.util.schemaHasRules($,e.RULES.all))){v.schema=$,v.schemaPath=e.schemaPath+".additionalItems",v.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+g+" = true; if ("+p+".length > "+o.length+") {  for (var "+E+" = "+o.length+"; "+E+" < "+p+".length; "+E+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var I=p+"["+E+"]";v.dataPathArr[R]=E;var C=e.validate(v);v.baseId=w,e.util.varOccurences(C,S)<2?r+=" "+e.util.varReplace(C,S,I)+" ":r+=" var "+S+" = "+I+"; "+C+" ",f&&(r+=" if (!"+g+") break; "),r+=" } }  ",f&&(r+=" if ("+g+") { ",b+="}")}}else if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){v.schema=o,v.schemaPath=l,v.errSchemaPath=u,r+="  for (var "+E+" = 0; "+E+" < "+p+".length; "+E+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var I=p+"["+E+"]";v.dataPathArr[R]=E;var C=e.validate(v);v.baseId=w,e.util.varOccurences(C,S)<2?r+=" "+e.util.varReplace(C,S,I)+" ":r+=" var "+S+" = "+I+"; "+C+" ",f&&(r+=" if (!"+g+") break; "),r+=" }"}return f&&(r+=" "+b+" if ("+d+" == errors) {"),r}});var js=Q((bv,hi)=>{"use strict";hi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,w,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var v=a=="maximum",b=v?"exclusiveMaximum":"exclusiveMinimum",g=e.schema[b],E=e.opts.$data&&g&&g.$data,R=v?"<":">",S=v?">":"<",w=void 0;if(!(y||typeof o=="number"||o===void 0))throw new Error(a+" must be number");if(!(E||g===void 0||typeof g=="number"||typeof g=="boolean"))throw new Error(b+" must be number or boolean");if(E){var $=e.util.getData(g.$data,i,e.dataPathArr),k="exclusive"+n,L="exclType"+n,M="exclIsNumber"+n,O="op"+n,H="' + "+O+" + '";r+=" var schemaExcl"+n+" = "+$+"; ",$="schemaExcl"+n,r+=" var "+k+"; var "+L+" = typeof "+$+"; if ("+L+" != 'boolean' && "+L+" != 'undefined' && "+L+" != 'number') { ";var w=b,z=z||[];z.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(w||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: '"+b+" should be boolean' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;r=z.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+L+" == 'number' ? ( ("+k+" = "+d+" === undefined || "+$+" "+R+"= "+d+") ? "+p+" "+S+"= "+$+" : "+p+" "+S+" "+d+" ) : ( ("+k+" = "+$+" === true) ? "+p+" "+S+"= "+d+" : "+p+" "+S+" "+d+" ) || "+p+" !== "+p+") { var op"+n+" = "+k+" ? '"+R+"' : '"+R+"='; ",o===void 0&&(w=b,u=e.errSchemaPath+"/"+b,d=$,y=E)}else{var M=typeof g=="number",H=R;if(M&&y){var O="'"+H+"'";r+=" if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" ( "+d+" === undefined || "+g+" "+R+"= "+d+" ? "+p+" "+S+"= "+g+" : "+p+" "+S+" "+d+" ) || "+p+" !== "+p+") { "}else{M&&o===void 0?(k=!0,w=b,u=e.errSchemaPath+"/"+b,d=g,S+="="):(M&&(d=Math[v?"min":"max"](g,o)),g===(M?d:!0)?(k=!0,w=b,u=e.errSchemaPath+"/"+b,S+="="):(k=!1,H+="="));var O="'"+H+"'";r+=" if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+p+" "+S+" "+d+" || "+p+" !== "+p+") { "}}w=w||a;var z=z||[];z.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(w||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+O+", limit: "+d+", exclusive: "+k+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be "+H+" ",y?r+="' + "+d:r+=""+d+"'"),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;return r=z.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { "),r}});var Ds=Q((Pv,pi)=>{"use strict";pi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,b,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;if(y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(y||typeof o=="number"))throw new Error(a+" must be number");var v=a=="maxItems"?">":"<";r+="if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+p+".length "+v+" "+d+") { ";var b=a,g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(b||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",a=="maxItems"?r+="more":r+="fewer",r+=" than ",y?r+="' + "+d+" + '":r+=""+o,r+=" items' "),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var E=r;return r=g.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}});var Ns=Q((Ev,mi)=>{"use strict";mi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,b,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;if(y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(y||typeof o=="number"))throw new Error(a+" must be number");var v=a=="maxLength"?">":"<";r+="if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),e.opts.unicode===!1?r+=" "+p+".length ":r+=" ucs2length("+p+") ",r+=" "+v+" "+d+") { ";var b=a,g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(b||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be ",a=="maxLength"?r+="longer":r+="shorter",r+=" than ",y?r+="' + "+d+" + '":r+=""+o,r+=" characters' "),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var E=r;return r=g.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}});var Ls=Q((xv,vi)=>{"use strict";vi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,b,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;if(y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(y||typeof o=="number"))throw new Error(a+" must be number");var v=a=="maxProperties"?">":"<";r+="if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" Object.keys("+p+").length "+v+" "+d+") { ";var b=a,g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(b||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",a=="maxProperties"?r+="more":r+="fewer",r+=" than ",y?r+="' + "+d+" + '":r+=""+o,r+=" properties' "),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var E=r;return r=g.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}});var yi=Q((Sv,gi)=>{"use strict";gi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;if(y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(y||typeof o=="number"))throw new Error(a+" must be number");r+="var division"+n+";if (",y&&(r+=" "+d+" !== undefined && ( typeof "+d+" != 'number' || "),r+=" (division"+n+" = "+p+" / "+d+", ",e.opts.multipleOfPrecision?r+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":r+=" division"+n+" !== parseInt(division"+n+") ",r+=" ) ",y&&(r+="  )  "),r+=" ) {   ";var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be multiple of ",y?r+="' + "+d:r+=""+d+"'"),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var b=r;return r=v.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+b+"]); ":r+=" validate.errors = ["+b+"]; return false; ":r+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}});var bi=Q((wv,_i)=>{"use strict";_i.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,d=e.util.copy(e);d.level++;var v="valid"+d.level;if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=l,d.errSchemaPath=u,r+=" var "+y+" = errors;  ";var b=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1;var g;d.opts.allErrors&&(g=d.opts.allErrors,d.opts.allErrors=!1),r+=" "+e.validate(d)+" ",d.createErrors=!0,g&&(d.opts.allErrors=g),e.compositeRule=d.compositeRule=b,r+=" if ("+v+") {   ";var E=E||[];E.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var R=r;r=E.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+R+"]); ":r+=" validate.errors = ["+R+"]; return false; ":r+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+y+"; if (vErrors !== null) { if ("+y+") vErrors.length = "+y+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f&&(r+=" if (false) { ");return r}});var Ei=Q((Rv,Pi)=>{"use strict";Pi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d="errs__"+n,v=e.util.copy(e),b="";v.level++;var g="valid"+v.level,E=v.baseId,R="prevValid"+n,S="passingSchemas"+n;r+="var "+d+" = errors , "+R+" = false , "+y+" = false , "+S+" = null; ";var w=e.compositeRule;e.compositeRule=v.compositeRule=!0;var $=o;if($)for(var k,L=-1,M=$.length-1;L<M;)k=$[L+=1],(e.opts.strictKeywords?typeof k=="object"&&Object.keys(k).length>0||k===!1:e.util.schemaHasRules(k,e.RULES.all))?(v.schema=k,v.schemaPath=l+"["+L+"]",v.errSchemaPath=u+"/"+L,r+="  "+e.validate(v)+" ",v.baseId=E):r+=" var "+g+" = true; ",L&&(r+=" if ("+g+" && "+R+") { "+y+" = false; "+S+" = ["+S+", "+L+"]; } else { ",b+="}"),r+=" if ("+g+") { "+y+" = "+R+" = true; "+S+" = "+L+"; }";return e.compositeRule=v.compositeRule=w,r+=""+b+"if (!"+y+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+S+" } ",e.opts.messages!==!1&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}});var Si=Q((Tv,xi)=>{"use strict";xi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,d;y?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var v=y?"(new RegExp("+d+"))":e.usePattern(o);r+="if ( ",y&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" !"+v+".test("+p+") ) {   ";var b=b||[];b.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",y?r+=""+d:r+=""+e.util.toQuotedString(o),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match pattern "`,y?r+="' + "+d+" + '":r+=""+e.util.escapeQuotes(o),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",y?r+="validate.schema"+l:r+=""+e.util.toQuotedString(o),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var g=r;return r=b.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}});var Ri=Q((Ov,wi)=>{"use strict";wi.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,d=e.util.copy(e),v="";d.level++;var b="valid"+d.level,g="key"+n,E="idx"+n,R=d.dataLevel=e.dataLevel+1,S="data"+R,w="dataProperties"+n,$=Object.keys(o||{}).filter(re),k=e.schema.patternProperties||{},L=Object.keys(k).filter(re),M=e.schema.additionalProperties,O=$.length||L.length,H=M===!1,z=typeof M=="object"&&Object.keys(M).length,F=e.opts.removeAdditional,I=H||z||F,C=e.opts.ownProperties,q=e.baseId,le=e.schema.required;if(le&&!(e.opts.$data&&le.$data)&&le.length<e.opts.loopRequired)var Y=e.util.toHash(le);function re(We){return We!=="__proto__"}if(r+="var "+y+" = errors;var "+b+" = true;",C&&(r+=" var "+w+" = undefined;"),I){if(C?r+=" "+w+" = "+w+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+w+".length; "+E+"++) { var "+g+" = "+w+"["+E+"]; ":r+=" for (var "+g+" in "+p+") { ",O){if(r+=" var isAdditional"+n+" = !(false ",$.length)if($.length>8)r+=" || validate.schema"+l+".hasOwnProperty("+g+") ";else{var G=$;if(G)for(var U,ve=-1,Te=G.length-1;ve<Te;)U=G[ve+=1],r+=" || "+g+" == "+e.util.toQuotedString(U)+" "}if(L.length){var Ie=L;if(Ie)for(var se,be=-1,Se=Ie.length-1;be<Se;)se=Ie[be+=1],r+=" || "+e.usePattern(se)+".test("+g+") "}r+=" ); if (isAdditional"+n+") { "}if(F=="all")r+=" delete "+p+"["+g+"]; ";else{var ke=e.errorPath,vr="' + "+g+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers)),H)if(F)r+=" delete "+p+"["+g+"]; ";else{r+=" "+b+" = false; ";var ir=u;u=e.errSchemaPath+"/additionalProperties";var Pe=Pe||[];Pe.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+vr+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var ge=r;r=Pe.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+ge+"]); ":r+=" validate.errors = ["+ge+"]; return false; ":r+=" var err = "+ge+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=ir,f&&(r+=" break; ")}else if(z)if(F=="failing"){r+=" var "+y+" = errors;  ";var wr=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=M,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Oe=p+"["+g+"]";d.dataPathArr[R]=g;var oe=e.validate(d);d.baseId=q,e.util.varOccurences(oe,S)<2?r+=" "+e.util.varReplace(oe,S,Oe)+" ":r+=" var "+S+" = "+Oe+"; "+oe+" ",r+=" if (!"+b+") { errors = "+y+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+g+"]; }  ",e.compositeRule=d.compositeRule=wr}else{d.schema=M,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Oe=p+"["+g+"]";d.dataPathArr[R]=g;var oe=e.validate(d);d.baseId=q,e.util.varOccurences(oe,S)<2?r+=" "+e.util.varReplace(oe,S,Oe)+" ":r+=" var "+S+" = "+Oe+"; "+oe+" ",f&&(r+=" if (!"+b+") break; ")}e.errorPath=ke}O&&(r+=" } "),r+=" }  ",f&&(r+=" if ("+b+") { ",v+="}")}var gr=e.opts.useDefaults&&!e.compositeRule;if($.length){var lr=$;if(lr)for(var U,Rr=-1,Tr=lr.length-1;Rr<Tr;){U=lr[Rr+=1];var we=o[U];if(e.opts.strictKeywords?typeof we=="object"&&Object.keys(we).length>0||we===!1:e.util.schemaHasRules(we,e.RULES.all)){var Ve=e.util.getProperty(U),Oe=p+Ve,De=gr&&we.default!==void 0;d.schema=we,d.schemaPath=l+Ve,d.errSchemaPath=u+"/"+e.util.escapeFragment(U),d.errorPath=e.util.getPath(e.errorPath,U,e.opts.jsonPointers),d.dataPathArr[R]=e.util.toQuotedString(U);var oe=e.validate(d);if(d.baseId=q,e.util.varOccurences(oe,S)<2){oe=e.util.varReplace(oe,S,Oe);var Ce=Oe}else{var Ce=S;r+=" var "+S+" = "+Oe+"; "}if(De)r+=" "+oe+" ";else{if(Y&&Y[U]){r+=" if ( "+Ce+" === undefined ",C&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(U)+"') "),r+=") { "+b+" = false; ";var ke=e.errorPath,ir=u,er=e.util.escapeQuotes(U);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(ke,U,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var Pe=Pe||[];Pe.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+er+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+er+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var ge=r;r=Pe.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+ge+"]); ":r+=" validate.errors = ["+ge+"]; return false; ":r+=" var err = "+ge+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=ir,e.errorPath=ke,r+=" } else { "}else f?(r+=" if ( "+Ce+" === undefined ",C&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(U)+"') "),r+=") { "+b+" = true; } else { "):(r+=" if ("+Ce+" !== undefined ",C&&(r+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(U)+"') "),r+=" ) { ");r+=" "+oe+" } "}}f&&(r+=" if ("+b+") { ",v+="}")}}if(L.length){var Me=L;if(Me)for(var se,Dt=-1,Ua=Me.length-1;Dt<Ua;){se=Me[Dt+=1];var we=k[se];if(e.opts.strictKeywords?typeof we=="object"&&Object.keys(we).length>0||we===!1:e.util.schemaHasRules(we,e.RULES.all)){d.schema=we,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),C?r+=" "+w+" = "+w+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+w+".length; "+E+"++) { var "+g+" = "+w+"["+E+"]; ":r+=" for (var "+g+" in "+p+") { ",r+=" if ("+e.usePattern(se)+".test("+g+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Oe=p+"["+g+"]";d.dataPathArr[R]=g;var oe=e.validate(d);d.baseId=q,e.util.varOccurences(oe,S)<2?r+=" "+e.util.varReplace(oe,S,Oe)+" ":r+=" var "+S+" = "+Oe+"; "+oe+" ",f&&(r+=" if (!"+b+") break; "),r+=" } ",f&&(r+=" else "+b+" = true; "),r+=" }  ",f&&(r+=" if ("+b+") { ",v+="}")}}}return f&&(r+=" "+v+" if ("+y+" == errors) {"),r}});var Oi=Q((Av,Ti)=>{"use strict";Ti.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,d=e.util.copy(e),v="";d.level++;var b="valid"+d.level;if(r+="var "+y+" = errors;",e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=l,d.errSchemaPath=u;var g="key"+n,E="idx"+n,R="i"+n,S="' + "+g+" + '",w=d.dataLevel=e.dataLevel+1,$="data"+w,k="dataProperties"+n,L=e.opts.ownProperties,M=e.baseId;L&&(r+=" var "+k+" = undefined; "),L?r+=" "+k+" = "+k+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+k+".length; "+E+"++) { var "+g+" = "+k+"["+E+"]; ":r+=" for (var "+g+" in "+p+") { ",r+=" var startErrs"+n+" = errors; ";var O=g,H=e.compositeRule;e.compositeRule=d.compositeRule=!0;var z=e.validate(d);d.baseId=M,e.util.varOccurences(z,$)<2?r+=" "+e.util.varReplace(z,$,O)+" ":r+=" var "+$+" = "+O+"; "+z+" ",e.compositeRule=d.compositeRule=H,r+=" if (!"+b+") { for (var "+R+"=startErrs"+n+"; "+R+"<errors; "+R+"++) { vErrors["+R+"].propertyName = "+g+"; }   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+S+"' } ",e.opts.messages!==!1&&(r+=" , message: 'property name \\'"+S+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),f&&(r+=" break; "),r+=" } }"}return f&&(r+=" "+v+" if ("+y+" == errors) {"),r}});var $i=Q(($v,Ai)=>{"use strict";Ai.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d=e.opts.$data&&o&&o.$data,v;d?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o;var b="schema"+n;if(!d)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var g=[],E=o;if(E)for(var R,S=-1,w=E.length-1;S<w;){R=E[S+=1];var $=e.schema.properties[R];$&&(e.opts.strictKeywords?typeof $=="object"&&Object.keys($).length>0||$===!1:e.util.schemaHasRules($,e.RULES.all))||(g[g.length]=R)}}else var g=o;if(d||g.length){var k=e.errorPath,L=d||g.length>=e.opts.loopRequired,M=e.opts.ownProperties;if(f)if(r+=" var missing"+n+"; ",L){d||(r+=" var "+b+" = validate.schema"+l+"; ");var O="i"+n,H="schema"+n+"["+O+"]",z="' + "+H+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(k,H,e.opts.jsonPointers)),r+=" var "+y+" = true; ",d&&(r+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),r+=" for (var "+O+" = 0; "+O+" < "+b+".length; "+O+"++) { "+y+" = "+p+"["+b+"["+O+"]] !== undefined ",M&&(r+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+b+"["+O+"]) "),r+="; if (!"+y+") break; } ",d&&(r+="  }  "),r+="  if (!"+y+") {   ";var F=F||[];F.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+z+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var I=r;r=F.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+I+"]); ":r+=" validate.errors = ["+I+"]; return false; ":r+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var C=g;if(C)for(var q,O=-1,le=C.length-1;O<le;){q=C[O+=1],O&&(r+=" || ");var Y=e.util.getProperty(q),re=p+Y;r+=" ( ( "+re+" === undefined ",M&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(q)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?q:Y)+") ) "}r+=") {  ";var H="missing"+n,z="' + "+H+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(k,H,!0):k+" + "+H);var F=F||[];F.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+z+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var I=r;r=F.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+I+"]); ":r+=" validate.errors = ["+I+"]; return false; ":r+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(L){d||(r+=" var "+b+" = validate.schema"+l+"; ");var O="i"+n,H="schema"+n+"["+O+"]",z="' + "+H+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(k,H,e.opts.jsonPointers)),d&&(r+=" if ("+b+" && !Array.isArray("+b+")) {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+z+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+b+" !== undefined) { "),r+=" for (var "+O+" = 0; "+O+" < "+b+".length; "+O+"++) { if ("+p+"["+b+"["+O+"]] === undefined ",M&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+b+"["+O+"]) "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+z+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(r+="  }  ")}else{var G=g;if(G)for(var q,U=-1,ve=G.length-1;U<ve;){q=G[U+=1];var Y=e.util.getProperty(q),z=e.util.escapeQuotes(q),re=p+Y;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(k,q,e.opts.jsonPointers)),r+=" if ( "+re+" === undefined ",M&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(q)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+z+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=k}else f&&(r+=" if (true) {");return r}});var ki=Q((Iv,Ii)=>{"use strict";Ii.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,d=e.opts.$data&&o&&o.$data,v;if(d?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o,(o||d)&&e.opts.uniqueItems!==!1){d&&(r+=" var "+y+"; if ("+v+" === false || "+v+" === undefined) "+y+" = true; else if (typeof "+v+" != 'boolean') "+y+" = false; else { "),r+=" var i = "+p+".length , "+y+" = true , j; if (i > 1) { ";var b=e.schema.items&&e.schema.items.type,g=Array.isArray(b);if(!b||b=="object"||b=="array"||g&&(b.indexOf("object")>=0||b.indexOf("array")>=0))r+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+p+"[i], "+p+"[j])) { "+y+" = false; break outer; } } } ";else{r+=" var itemIndices = {}, item; for (;i--;) { var item = "+p+"[i]; ";var E="checkDataType"+(g?"s":"");r+=" if ("+e.util[E](b,"item",e.opts.strictNumbers,!0)+") continue; ",g&&(r+=` if (typeof item == 'string') item = '"' + item; `),r+=" if (typeof itemIndices[item] == 'number') { "+y+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}r+=" } ",d&&(r+="  }  "),r+=" if (!"+y+") {   ";var R=R||[];R.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(r+=" , schema:  ",d?r+="validate.schema"+l:r+=""+o,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;r=R.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { ")}else f&&(r+=" if (true) { ");return r}});var ji=Q((kv,Ci)=>{"use strict";Ci.exports={$ref:Bo(),allOf:Ko(),anyOf:Wo(),$comment:Yo(),const:ei(),contains:ti(),dependencies:si(),enum:oi(),format:li(),if:ui(),items:fi(),maximum:js(),minimum:js(),maxItems:Ds(),minItems:Ds(),maxLength:Ns(),minLength:Ns(),maxProperties:Ls(),minProperties:Ls(),multipleOf:yi(),not:bi(),oneOf:Ei(),pattern:Si(),properties:Ri(),propertyNames:Oi(),required:$i(),uniqueItems:ki(),validate:ks()}});var Li=Q((Cv,Ni)=>{"use strict";var Di=ji(),Fs=Jr().toHash;Ni.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],a=["type","$comment"],s=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],r=["number","integer","string","array","object","boolean","null"];return e.all=Fs(a),e.types=Fs(r),e.forEach(function(n){n.rules=n.rules.map(function(i){var o;if(typeof i=="object"){var l=Object.keys(i)[0];o=i[l],i=l,o.forEach(function(f){a.push(f),e.all[f]=!0})}a.push(i);var u=e.all[i]={keyword:i,code:Di[i],implements:o};return u}),e.all.$comment={keyword:"$comment",code:Di.$comment},n.type&&(e.types[n.type]=n)}),e.keywords=Fs(a.concat(s)),e.custom={},e}});var Mi=Q((jv,qi)=>{"use strict";var Fi=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];qi.exports=function(t,e){for(var a=0;a<e.length;a++){t=JSON.parse(JSON.stringify(t));var s=e[a].split("/"),r=t,n;for(n=1;n<s.length;n++)r=r[s[n]];for(n=0;n<Fi.length;n++){var i=Fi[n],o=r[i];o&&(r[i]={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return t}});var Vi=Q((Dv,zi)=>{"use strict";var kf=Ta().MissingRef;zi.exports=Hi;function Hi(t,e,a){var s=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(a=e,e=void 0);var r=n(t).then(function(){var o=s._addSchema(t,void 0,e);return o.validate||i(o)});return a&&r.then(function(o){a(null,o)},a),r;function n(o){var l=o.$schema;return l&&!s.getSchema(l)?Hi.call(s,{$ref:l},!0):Promise.resolve()}function i(o){try{return s._compile(o)}catch(u){if(u instanceof kf)return l(u);throw u}function l(u){var f=u.missingSchema;if(d(f))throw new Error("Schema "+f+" is loaded but "+u.missingRef+" cannot be resolved");var p=s._loadingSchemas[f];return p||(p=s._loadingSchemas[f]=s._opts.loadSchema(f),p.then(y,y)),p.then(function(v){if(!d(f))return n(v).then(function(){d(f)||s.addSchema(v,f,void 0,e)})}).then(function(){return i(o)});function y(){delete s._loadingSchemas[f]}function d(v){return s._refs[v]||s._schemas[v]}}}}});var Zi=Q((Nv,Ui)=>{"use strict";Ui.exports=function(e,a,s){var r=" ",n=e.level,i=e.dataLevel,o=e.schema[a],l=e.schemaPath+e.util.getProperty(a),u=e.errSchemaPath+"/"+a,f=!e.opts.allErrors,p,y="data"+(i||""),d="valid"+n,v="errs__"+n,b=e.opts.$data&&o&&o.$data,g;b?(r+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",g="schema"+n):g=o;var E=this,R="definition"+n,S=E.definition,w="",$,k,L,M,O;if(b&&S.$data){O="keywordValidate"+n;var H=S.validateSchema;r+=" var "+R+" = RULES.custom['"+a+"'].definition; var "+O+" = "+R+".validate;"}else{if(M=e.useCustomRule(E,o,e.schema,e),!M)return;g="validate.schema"+l,O=M.code,$=S.compile,k=S.inline,L=S.macro}var z=O+".errors",F="i"+n,I="ruleErr"+n,C=S.async;if(C&&!e.async)throw new Error("async keyword in sync schema");if(k||L||(r+=""+z+" = null;"),r+="var "+v+" = errors;var "+d+";",b&&S.$data&&(w+="}",r+=" if ("+g+" === undefined) { "+d+" = true; } else { ",H&&(w+="}",r+=" "+d+" = "+R+".validateSchema("+g+"); if ("+d+") { ")),k)S.statements?r+=" "+M.validate+" ":r+=" "+d+" = "+M.validate+"; ";else if(L){var q=e.util.copy(e),w="";q.level++;var le="valid"+q.level;q.schema=M.validate,q.schemaPath="";var Y=e.compositeRule;e.compositeRule=q.compositeRule=!0;var re=e.validate(q).replace(/validate\.schema/g,O);e.compositeRule=q.compositeRule=Y,r+=" "+re}else{var G=G||[];G.push(r),r="",r+="  "+O+".call( ",e.opts.passContext?r+="this":r+="self",$||S.schema===!1?r+=" , "+y+" ":r+=" , "+g+" , "+y+" , validate.schema"+e.schemaPath+" ",r+=" , (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var U=i?"data"+(i-1||""):"parentData",ve=i?e.dataPathArr[i]:"parentDataProperty";r+=" , "+U+" , "+ve+" , rootData )  ";var Te=r;r=G.pop(),S.errors===!1?(r+=" "+d+" = ",C&&(r+="await "),r+=""+Te+"; "):C?(z="customErrors"+n,r+=" var "+z+" = null; try { "+d+" = await "+Te+"; } catch (e) { "+d+" = false; if (e instanceof ValidationError) "+z+" = e.errors; else throw e; } "):r+=" "+z+" = null; "+d+" = "+Te+"; "}if(S.modifying&&(r+=" if ("+U+") "+y+" = "+U+"["+ve+"];"),r+=""+w,S.valid)f&&(r+=" if (true) { ");else{r+=" if ( ",S.valid===void 0?(r+=" !",L?r+=""+le:r+=""+d):r+=" "+!S.valid+" ",r+=") { ",p=E.keyword;var G=G||[];G.push(r),r="";var G=G||[];G.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+E.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ";var Ie=r;r=G.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+Ie+"]); ":r+=" validate.errors = ["+Ie+"]; return false; ":r+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var se=r;r=G.pop(),k?S.errors?S.errors!="full"&&(r+="  for (var "+F+"="+v+"; "+F+"<errors; "+F+"++) { var "+I+" = vErrors["+F+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+I+".schema = "+g+"; "+I+".data = "+y+"; "),r+=" } "):S.errors===!1?r+=" "+se+" ":(r+=" if ("+v+" == errors) { "+se+" } else {  for (var "+F+"="+v+"; "+F+"<errors; "+F+"++) { var "+I+" = vErrors["+F+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+I+".schema = "+g+"; "+I+".data = "+y+"; "),r+=" } } "):L?(r+="   var err =   ",e.createErrors!==!1?(r+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+E.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; ")):S.errors===!1?r+=" "+se+" ":(r+=" if (Array.isArray("+z+")) { if (vErrors === null) vErrors = "+z+"; else vErrors = vErrors.concat("+z+"); errors = vErrors.length;  for (var "+F+"="+v+"; "+F+"<errors; "+F+"++) { var "+I+" = vErrors["+F+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+";  "+I+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(r+=" "+I+".schema = "+g+"; "+I+".data = "+y+"; "),r+=" } } else { "+se+" } "),r+=" } ",f&&(r+=" else { ")}return r}});var qs=Q((Lv,Cf)=>{Cf.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Ki=Q((Fv,Qi)=>{"use strict";var Bi=qs();Qi.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Bi.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Bi.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var Wi=Q((qv,Ji)=>{"use strict";var jf=/^[a-z_$][a-z0-9_$-]*$/i,Df=Zi(),Nf=Ki();Ji.exports={add:Lf,get:Ff,remove:qf,validate:Ms};function Lf(t,e){var a=this.RULES;if(a.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!jf.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var s=e.type;if(Array.isArray(s))for(var r=0;r<s.length;r++)i(t,s[r],e);else i(t,s,e);var n=e.metaSchema;n&&(e.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(n,!0))}a.keywords[t]=a.all[t]=!0;function i(o,l,u){for(var f,p=0;p<a.length;p++){var y=a[p];if(y.type==l){f=y;break}}f||(f={type:l,rules:[]},a.push(f));var d={keyword:o,definition:u,custom:!0,code:Df,implements:u.implements};f.rules.push(d),a.custom[o]=d}return this}function Ff(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1}function qf(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var a=0;a<e.length;a++)for(var s=e[a].rules,r=0;r<s.length;r++)if(s[r].keyword==t){s.splice(r,1);break}return this}function Ms(t,e){Ms.errors=null;var a=this._validateKeyword=this._validateKeyword||this.compile(Nf,!0);if(a(t))return!0;if(Ms.errors=a.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(a.errors));return!1}});var Gi=Q((Mv,Mf)=>{Mf.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var il=Q((Hv,ol)=>{"use strict";var Xi=$o(),Wr=Ra(),Hf=ko(),el=ws(),zf=Is(),Vf=Uo(),Uf=Li(),rl=Mi(),tl=Jr();ol.exports=_e;_e.prototype.validate=Bf;_e.prototype.compile=Qf;_e.prototype.addSchema=Kf;_e.prototype.addMetaSchema=Jf;_e.prototype.validateSchema=Wf;_e.prototype.getSchema=Yf;_e.prototype.removeSchema=eh;_e.prototype.addFormat=lh;_e.prototype.errorsText=ih;_e.prototype._addSchema=rh;_e.prototype._compile=th;_e.prototype.compileAsync=Vi();var Da=Wi();_e.prototype.addKeyword=Da.add;_e.prototype.getKeyword=Da.get;_e.prototype.removeKeyword=Da.remove;_e.prototype.validateKeyword=Da.validate;var al=Ta();_e.ValidationError=al.Validation;_e.MissingRefError=al.MissingRef;_e.$dataMetaSchema=rl;var ja="http://json-schema.org/draft-07/schema",Yi=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],Zf=["/properties"];function _e(t){if(!(this instanceof _e))return new _e(t);t=this._opts=tl.copy(t)||{},ph(this),this._schemas={},this._refs={},this._fragments={},this._formats=Vf(t.format),this._cache=t.cache||new Hf,this._loadingSchemas={},this._compilations=[],this.RULES=Uf(),this._getId=ah(t),t.loopRequired=t.loopRequired||1/0,t.errorDataPath=="property"&&(t._errorDataPathProperty=!0),t.serialize===void 0&&(t.serialize=zf),this._metaOpts=hh(this),t.formats&&dh(this),t.keywords&&fh(this),ch(this),typeof t.meta=="object"&&this.addMetaSchema(t.meta),t.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),uh(this)}function Bf(t,e){var a;if(typeof t=="string"){if(a=this.getSchema(t),!a)throw new Error('no schema with key or ref "'+t+'"')}else{var s=this._addSchema(t);a=s.validate||this._compile(s)}var r=a(e);return a.$async!==!0&&(this.errors=a.errors),r}function Qf(t,e){var a=this._addSchema(t,void 0,e);return a.validate||this._compile(a)}function Kf(t,e,a,s){if(Array.isArray(t)){for(var r=0;r<t.length;r++)this.addSchema(t[r],void 0,a,s);return this}var n=this._getId(t);if(n!==void 0&&typeof n!="string")throw new Error("schema id must be string");return e=Wr.normalizeId(e||n),nl(this,e),this._schemas[e]=this._addSchema(t,a,s,!0),this}function Jf(t,e,a){return this.addSchema(t,e,a,!0),this}function Wf(t,e){var a=t.$schema;if(a!==void 0&&typeof a!="string")throw new Error("$schema must be a string");if(a=a||this._opts.defaultMeta||Gf(this),!a)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var s=this.validate(a,t);if(!s&&e){var r="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(r);else throw new Error(r)}return s}function Gf(t){var e=t._opts.meta;return t._opts.defaultMeta=typeof e=="object"?t._getId(e)||e:t.getSchema(ja)?ja:void 0,t._opts.defaultMeta}function Yf(t){var e=sl(this,t);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return Xf(this,t)}}function Xf(t,e){var a=Wr.schema.call(t,{schema:{}},e);if(a){var s=a.schema,r=a.root,n=a.baseId,i=Xi.call(t,s,r,void 0,n);return t._fragments[e]=new el({ref:e,fragment:!0,schema:s,root:r,baseId:n,validate:i}),i}}function sl(t,e){return e=Wr.normalizeId(e),t._schemas[e]||t._refs[e]||t._fragments[e]}function eh(t){if(t instanceof RegExp)return Ca(this,this._schemas,t),Ca(this,this._refs,t),this;switch(typeof t){case"undefined":return Ca(this,this._schemas),Ca(this,this._refs),this._cache.clear(),this;case"string":var e=sl(this,t);return e&&this._cache.del(e.cacheKey),delete this._schemas[t],delete this._refs[t],this;case"object":var a=this._opts.serialize,s=a?a(t):t;this._cache.del(s);var r=this._getId(t);r&&(r=Wr.normalizeId(r),delete this._schemas[r],delete this._refs[r])}return this}function Ca(t,e,a){for(var s in e){var r=e[s];!r.meta&&(!a||a.test(s))&&(t._cache.del(r.cacheKey),delete e[s])}}function rh(t,e,a,s){if(typeof t!="object"&&typeof t!="boolean")throw new Error("schema should be object or boolean");var r=this._opts.serialize,n=r?r(t):t,i=this._cache.get(n);if(i)return i;s=s||this._opts.addUsedSchema!==!1;var o=Wr.normalizeId(this._getId(t));o&&s&&nl(this,o);var l=this._opts.validateSchema!==!1&&!e,u;l&&!(u=o&&o==Wr.normalizeId(t.$schema))&&this.validateSchema(t,!0);var f=Wr.ids.call(this,t),p=new el({id:o,schema:t,localRefs:f,cacheKey:n,meta:a});return o[0]!="#"&&s&&(this._refs[o]=p),this._cache.put(n,p),l&&u&&this.validateSchema(t,!0),p}function th(t,e){if(t.compiling)return t.validate=r,r.schema=t.schema,r.errors=null,r.root=e||r,t.schema.$async===!0&&(r.$async=!0),r;t.compiling=!0;var a;t.meta&&(a=this._opts,this._opts=this._metaOpts);var s;try{s=Xi.call(this,t.schema,e,t.localRefs)}catch(n){throw delete t.validate,n}finally{t.compiling=!1,t.meta&&(this._opts=a)}return t.validate=s,t.refs=s.refs,t.refVal=s.refVal,t.root=s.root,s;function r(){var n=t.validate,i=n.apply(this,arguments);return r.errors=n.errors,i}}function ah(t){switch(t.schemaId){case"auto":return oh;case"id":return sh;default:return nh}}function sh(t){return t.$id&&this.logger.warn("schema $id ignored",t.$id),t.id}function nh(t){return t.id&&this.logger.warn("schema id ignored",t.id),t.$id}function oh(t){if(t.$id&&t.id&&t.$id!=t.id)throw new Error("schema $id is different from id");return t.$id||t.id}function ih(t,e){if(t=t||this.errors,!t)return"No errors";e=e||{};for(var a=e.separator===void 0?", ":e.separator,s=e.dataVar===void 0?"data":e.dataVar,r="",n=0;n<t.length;n++){var i=t[n];i&&(r+=s+i.dataPath+" "+i.message+a)}return r.slice(0,-a.length)}function lh(t,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[t]=e,this}function ch(t){var e;if(t._opts.$data&&(e=Gi(),t.addMetaSchema(e,e.$id,!0)),t._opts.meta!==!1){var a=qs();t._opts.$data&&(a=rl(a,Zf)),t.addMetaSchema(a,ja,!0),t._refs["http://json-schema.org/schema"]=ja}}function uh(t){var e=t._opts.schemas;if(e)if(Array.isArray(e))t.addSchema(e);else for(var a in e)t.addSchema(e[a],a)}function dh(t){for(var e in t._opts.formats){var a=t._opts.formats[e];t.addFormat(e,a)}}function fh(t){for(var e in t._opts.keywords){var a=t._opts.keywords[e];t.addKeyword(e,a)}}function nl(t,e){if(t._schemas[e]||t._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function hh(t){for(var e=tl.copy(t._opts),a=0;a<Yi.length;a++)delete e[Yi[a]];return e}function ph(t){var e=t._opts.logger;if(e===!1)t.logger={log:Hs,warn:Hs,error:Hs};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");t.logger=e}}function Hs(){}});var Qh={};un(Qh,{default:()=>Bh,handler:()=>Zh});module.exports=Pc(Qh);var Jl=require("node:crypto");var Ka=(t,e,a)=>(s,r)=>{let n=-1;return i(0);async function i(o){if(o<=n)throw new Error("next() called multiple times");n=o;let l,u=!1,f;if(t[o]?(f=t[o][0][0],s.req.routeIndex=o):f=o===t.length&&r||void 0,f)try{l=await f(s,()=>i(o+1))}catch(p){if(p instanceof Error&&e)s.error=p,l=await e(p,s),u=!0;else throw p}else s.finalized===!1&&a&&(l=await a(s));return l&&(s.finalized===!1||u)&&(s.res=l),s}};var fn=Symbol();var hn=async(t,e=Object.create(null))=>{let{all:a=!1,dot:s=!1}=e,n=(t instanceof Mt?t.raw.headers:t.headers).get("Content-Type");return n?.startsWith("multipart/form-data")||n?.startsWith("application/x-www-form-urlencoded")?Ec(t,{all:a,dot:s}):{}};async function Ec(t,e){let a=await t.formData();return a?xc(a,e):{}}function xc(t,e){let a=Object.create(null);return t.forEach((s,r)=>{e.all||r.endsWith("[]")?Sc(a,r,s):a[r]=s}),e.dot&&Object.entries(a).forEach(([s,r])=>{s.includes(".")&&(wc(a,s,r),delete a[s])}),a}var Sc=(t,e,a)=>{t[e]!==void 0?Array.isArray(t[e])?t[e].push(a):t[e]=[t[e],a]:e.endsWith("[]")?t[e]=[a]:t[e]=a},wc=(t,e,a)=>{let s=t,r=e.split(".");r.forEach((n,i)=>{i===r.length-1?s[n]=a:((!s[n]||typeof s[n]!="object"||Array.isArray(s[n])||s[n]instanceof File)&&(s[n]=Object.create(null)),s=s[n])})};var Wa=t=>{let e=t.split("/");return e[0]===""&&e.shift(),e},pn=t=>{let{groups:e,path:a}=Rc(t),s=Wa(a);return Tc(s,e)},Rc=t=>{let e=[];return t=t.replace(/\{[^}]+\}/g,(a,s)=>{let r=`@${s}`;return e.push([r,a]),r}),{groups:e,path:t}},Tc=(t,e)=>{for(let a=e.length-1;a>=0;a--){let[s]=e[a];for(let r=t.length-1;r>=0;r--)if(t[r].includes(s)){t[r]=t[r].replace(s,e[a][1]);break}}return t},Ht={},mn=(t,e)=>{if(t==="*")return"*";let a=t.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(a){let s=`${t}#${e}`;return Ht[s]||(a[2]?Ht[s]=e&&e[0]!==":"&&e[0]!=="*"?[s,a[1],new RegExp(`^${a[2]}(?=/${e})`)]:[t,a[1],new RegExp(`^${a[2]}$`)]:Ht[s]=[t,a[1],!0]),Ht[s]}return null},zt=(t,e)=>{try{return e(t)}catch{return t.replace(/(?:%[0-9A-Fa-f]{2})+/g,a=>{try{return e(a)}catch{return a}})}},Oc=t=>zt(t,decodeURI),Ga=t=>{let e=t.url,a=e.indexOf("/",e.charCodeAt(9)===58?13:8),s=a;for(;s<e.length;s++){let r=e.charCodeAt(s);if(r===37){let n=e.indexOf("?",s),i=e.slice(a,n===-1?void 0:n);return Oc(i.includes("%25")?i.replace(/%25/g,"%2525"):i)}else if(r===63)break}return e.slice(a,s)};var vn=t=>{let e=Ga(t);return e.length>1&&e.at(-1)==="/"?e.slice(0,-1):e},Ir=(t,e,...a)=>(a.length&&(e=Ir(e,...a)),`${t?.[0]==="/"?"":"/"}${t}${e==="/"?"":`${t?.at(-1)==="/"?"":"/"}${e?.[0]==="/"?e.slice(1):e}`}`),Vt=t=>{if(t.charCodeAt(t.length-1)!==63||!t.includes(":"))return null;let e=t.split("/"),a=[],s="";return e.forEach(r=>{if(r!==""&&!/\:/.test(r))s+="/"+r;else if(/\:/.test(r))if(/\?/.test(r)){a.length===0&&s===""?a.push("/"):a.push(s);let n=r.replace("?","");s+="/"+n,a.push(s)}else s+="/"+r}),a.filter((r,n,i)=>i.indexOf(r)===n)},Ja=t=>/[%+]/.test(t)?(t.indexOf("+")!==-1&&(t=t.replace(/\+/g," ")),t.indexOf("%")!==-1?zt(t,Ya):t):t,gn=(t,e,a)=>{let s;if(!a&&e&&!/[%+]/.test(e)){let i=t.indexOf(`?${e}`,8);for(i===-1&&(i=t.indexOf(`&${e}`,8));i!==-1;){let o=t.charCodeAt(i+e.length+1);if(o===61){let l=i+e.length+2,u=t.indexOf("&",l);return Ja(t.slice(l,u===-1?void 0:u))}else if(o==38||isNaN(o))return"";i=t.indexOf(`&${e}`,i+1)}if(s=/[%+]/.test(t),!s)return}let r={};s??=/[%+]/.test(t);let n=t.indexOf("?",8);for(;n!==-1;){let i=t.indexOf("&",n+1),o=t.indexOf("=",n);o>i&&i!==-1&&(o=-1);let l=t.slice(n+1,o===-1?i===-1?void 0:i:o);if(s&&(l=Ja(l)),n=i,l==="")continue;let u;o===-1?u="":(u=t.slice(o+1,i===-1?void 0:i),s&&(u=Ja(u))),a?(r[l]&&Array.isArray(r[l])||(r[l]=[]),r[l].push(u)):r[l]??=u}return e?r[e]:r},yn=gn,_n=(t,e)=>gn(t,e,!0),Ya=decodeURIComponent;var bn=t=>zt(t,Ya),Mt=class{raw;#r;#e;routeIndex=0;path;bodyCache={};constructor(t,e="/",a=[[]]){this.raw=t,this.path=e,this.#e=a,this.#r={}}param(t){return t?this.#t(t):this.#n()}#t(t){let e=this.#e[0][this.routeIndex][1][t],a=this.#a(e);return a?/\%/.test(a)?bn(a):a:void 0}#n(){let t={},e=Object.keys(this.#e[0][this.routeIndex][1]);for(let a of e){let s=this.#a(this.#e[0][this.routeIndex][1][a]);s&&typeof s=="string"&&(t[a]=/\%/.test(s)?bn(s):s)}return t}#a(t){return this.#e[1]?this.#e[1][t]:t}query(t){return yn(this.url,t)}queries(t){return _n(this.url,t)}header(t){if(t)return this.raw.headers.get(t)??void 0;let e={};return this.raw.headers.forEach((a,s)=>{e[s]=a}),e}async parseBody(t){return this.bodyCache.parsedBody??=await hn(this,t)}#s=t=>{let{bodyCache:e,raw:a}=this,s=e[t];if(s)return s;let r=Object.keys(e)[0];return r?e[r].then(n=>(r==="json"&&(n=JSON.stringify(n)),new Response(n)[t]())):e[t]=a[t]()};json(){return this.#s("json")}text(){return this.#s("text")}arrayBuffer(){return this.#s("arrayBuffer")}blob(){return this.#s("blob")}formData(){return this.#s("formData")}addValidatedData(t,e){this.#r[t]=e}valid(t){return this.#r[t]}get url(){return this.raw.url}get method(){return this.raw.method}get[fn](){return this.#e}get matchedRoutes(){return this.#e[0].map(([[,t]])=>t)}get routePath(){return this.#e[0].map(([[,t]])=>t)[this.routeIndex].path}};var Ut={Stringify:1,BeforeStream:2,Stream:3},Ac=(t,e)=>{let a=new String(t);return a.isEscaped=!0,a.callbacks=e,a};var St=async(t,e,a,s,r)=>{typeof t=="object"&&!(t instanceof String)&&(t instanceof Promise||(t=t.toString()),t instanceof Promise&&(t=await t));let n=t.callbacks;if(!n?.length)return Promise.resolve(t);r?r[0]+=t:r=[t];let i=Promise.all(n.map(o=>o({phase:e,buffer:r,context:s}))).then(o=>Promise.all(o.filter(Boolean).map(l=>St(l,e,!1,s,r))).then(()=>r[0]));return a?Ac(await i,n):i};var Pn="text/plain; charset=UTF-8",Xa=(t,e)=>({"Content-Type":t,...e}),En=class{#r;#e;env={};#t;finalized=!1;error;#n;#a;#s;#c;#o;#l;#i;#d;#f;constructor(t,e){this.#r=t,e&&(this.#a=e.executionCtx,this.env=e.env,this.#l=e.notFoundHandler,this.#f=e.path,this.#d=e.matchResult)}get req(){return this.#e??=new Mt(this.#r,this.#f,this.#d),this.#e}get event(){if(this.#a&&"respondWith"in this.#a)return this.#a;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#a)return this.#a;throw Error("This context has no ExecutionContext")}get res(){return this.#s||=new Response(null,{headers:this.#i??=new Headers})}set res(t){if(this.#s&&t){t=new Response(t.body,t);for(let[e,a]of this.#s.headers.entries())if(e!=="content-type")if(e==="set-cookie"){let s=this.#s.headers.getSetCookie();t.headers.delete("set-cookie");for(let r of s)t.headers.append("set-cookie",r)}else t.headers.set(e,a)}this.#s=t,this.finalized=!0}render=(...t)=>(this.#o??=e=>this.html(e),this.#o(...t));setLayout=t=>this.#c=t;getLayout=()=>this.#c;setRenderer=t=>{this.#o=t};header=(t,e,a)=>{this.finalized&&(this.#s=new Response(this.#s.body,this.#s));let s=this.#s?this.#s.headers:this.#i??=new Headers;e===void 0?s.delete(t):a?.append?s.append(t,e):s.set(t,e)};status=t=>{this.#n=t};set=(t,e)=>{this.#t??=new Map,this.#t.set(t,e)};get=t=>this.#t?this.#t.get(t):void 0;get var(){return this.#t?Object.fromEntries(this.#t):{}}#u(t,e,a){let s=this.#s?new Headers(this.#s.headers):this.#i??new Headers;if(typeof e=="object"&&"headers"in e){let n=e.headers instanceof Headers?e.headers:new Headers(e.headers);for(let[i,o]of n)i.toLowerCase()==="set-cookie"?s.append(i,o):s.set(i,o)}if(a)for(let[n,i]of Object.entries(a))if(typeof i=="string")s.set(n,i);else{s.delete(n);for(let o of i)s.append(n,o)}let r=typeof e=="number"?e:e?.status??this.#n;return new Response(t,{status:r,headers:s})}newResponse=(...t)=>this.#u(...t);body=(t,e,a)=>this.#u(t,e,a);text=(t,e,a)=>!this.#i&&!this.#n&&!e&&!a&&!this.finalized?new Response(t):this.#u(t,e,Xa(Pn,a));json=(t,e,a)=>this.#u(JSON.stringify(t),e,Xa("application/json",a));html=(t,e,a)=>{let s=r=>this.#u(r,e,Xa("text/html; charset=UTF-8",a));return typeof t=="object"?St(t,Ut.Stringify,!1,{}).then(s):s(t)};redirect=(t,e)=>(this.header("Location",String(t)),this.newResponse(null,e??302));notFound=()=>(this.#l??=()=>new Response,this.#l(this))};var ye="ALL",xn="all",Sn=["get","post","put","delete","options","patch"],Zt="Can not add a route since the matcher is already built.",Bt=class extends Error{};var wn="__COMPOSED_HANDLER";var $c=t=>t.text("404 Not Found",404),Rn=(t,e)=>{if("getResponse"in t){let a=t.getResponse();return e.newResponse(a.body,a)}return console.error(t),e.text("Internal Server Error",500)},es=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#r="/";routes=[];constructor(t={}){[...Sn,xn].forEach(r=>{this[r]=(n,...i)=>(typeof n=="string"?this.#r=n:this.#n(r,this.#r,n),i.forEach(o=>{this.#n(r,this.#r,o)}),this)}),this.on=(r,n,...i)=>{for(let o of[n].flat()){this.#r=o;for(let l of[r].flat())i.map(u=>{this.#n(l.toUpperCase(),this.#r,u)})}return this},this.use=(r,...n)=>(typeof r=="string"?this.#r=r:(this.#r="*",n.unshift(r)),n.forEach(i=>{this.#n(ye,this.#r,i)}),this);let{strict:a,...s}=t;Object.assign(this,s),this.getPath=a??!0?t.getPath??Ga:vn}#e(){let t=new es({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,t.#t=this.#t,t.routes=this.routes,t}#t=$c;errorHandler=Rn;route(t,e){let a=this.basePath(t);return e.routes.map(s=>{let r;e.errorHandler===Rn?r=s.handler:(r=async(n,i)=>(await Ka([],e.errorHandler)(n,()=>s.handler(n,i))).res,r[wn]=s.handler),a.#n(s.method,s.path,r)}),this}basePath(t){let e=this.#e();return e._basePath=Ir(this._basePath,t),e}onError=t=>(this.errorHandler=t,this);notFound=t=>(this.#t=t,this);mount(t,e,a){let s,r;a&&(typeof a=="function"?r=a:(r=a.optionHandler,a.replaceRequest===!1?s=o=>o:s=a.replaceRequest));let n=r?o=>{let l=r(o);return Array.isArray(l)?l:[l]}:o=>{let l;try{l=o.executionCtx}catch{}return[o.env,l]};s||=(()=>{let o=Ir(this._basePath,t),l=o==="/"?0:o.length;return u=>{let f=new URL(u.url);return f.pathname=f.pathname.slice(l)||"/",new Request(f,u)}})();let i=async(o,l)=>{let u=await e(s(o.req.raw),...n(o));if(u)return u;await l()};return this.#n(ye,Ir(t,"*"),i),this}#n(t,e,a){t=t.toUpperCase(),e=Ir(this._basePath,e);let s={basePath:this._basePath,path:e,method:t,handler:a};this.router.add(t,e,[a,s]),this.routes.push(s)}#a(t,e){if(t instanceof Error)return this.errorHandler(t,e);throw t}#s(t,e,a,s){if(s==="HEAD")return(async()=>new Response(null,await this.#s(t,e,a,"GET")))();let r=this.getPath(t,{env:a}),n=this.router.match(s,r),i=new En(t,{path:r,matchResult:n,env:a,executionCtx:e,notFoundHandler:this.#t});if(n[0].length===1){let l;try{l=n[0][0][0][0](i,async()=>{i.res=await this.#t(i)})}catch(u){return this.#a(u,i)}return l instanceof Promise?l.then(u=>u||(i.finalized?i.res:this.#t(i))).catch(u=>this.#a(u,i)):l??this.#t(i)}let o=Ka(n[0],this.errorHandler,this.#t);return(async()=>{try{let l=await o(i);if(!l.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return l.res}catch(l){return this.#a(l,i)}})()}fetch=(t,...e)=>this.#s(t,e[1],e[0],t.method);request=(t,e,a,s)=>t instanceof Request?this.fetch(e?new Request(t,e):t,a,s):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${Ir("/",t)}`,e),a,s));fire=()=>{addEventListener("fetch",t=>{t.respondWith(this.#s(t.request,t,void 0,t.request.method))})}};var Qt="[^/]+",wt=".*",Rt="(?:|/.*)",st=Symbol(),Ic=new Set(".\\+*[^]$()");function kc(t,e){return t.length===1?e.length===1?t<e?-1:1:-1:e.length===1||t===wt||t===Rt?1:e===wt||e===Rt?-1:t===Qt?1:e===Qt?-1:t.length===e.length?t<e?-1:1:e.length-t.length}var Kt=class{#r;#e;#t=Object.create(null);insert(t,e,a,s,r){if(t.length===0){if(this.#r!==void 0)throw st;if(r)return;this.#r=e;return}let[n,...i]=t,o=n==="*"?i.length===0?["","",wt]:["","",Qt]:n==="/*"?["","",Rt]:n.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),l;if(o){let u=o[1],f=o[2]||Qt;if(u&&o[2]&&(f=f.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(f)))throw st;if(l=this.#t[f],!l){if(Object.keys(this.#t).some(p=>p!==wt&&p!==Rt))throw st;if(r)return;l=this.#t[f]=new Kt,u!==""&&(l.#e=s.varIndex++)}!r&&u!==""&&a.push([u,l.#e])}else if(l=this.#t[n],!l){if(Object.keys(this.#t).some(u=>u.length>1&&u!==wt&&u!==Rt))throw st;if(r)return;l=this.#t[n]=new Kt}l.insert(i,e,a,s,r)}buildRegExpStr(){let e=Object.keys(this.#t).sort(kc).map(a=>{let s=this.#t[a];return(typeof s.#e=="number"?`(${a})@${s.#e}`:Ic.has(a)?`\\${a}`:a)+s.buildRegExpStr()});return typeof this.#r=="number"&&e.unshift(`#${this.#r}`),e.length===0?"":e.length===1?e[0]:"(?:"+e.join("|")+")"}};var Tn=class{#r={varIndex:0};#e=new Kt;insert(t,e,a){let s=[],r=[];for(let i=0;;){let o=!1;if(t=t.replace(/\{[^}]+\}/g,l=>{let u=`@\\${i}`;return r[i]=[u,l],i++,o=!0,u}),!o)break}let n=t.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let i=r.length-1;i>=0;i--){let[o]=r[i];for(let l=n.length-1;l>=0;l--)if(n[l].indexOf(o)!==-1){n[l]=n[l].replace(o,r[i][1]);break}}return this.#e.insert(n,e,s,this.#r,a),s}buildRegExp(){let t=this.#e.buildRegExpStr();if(t==="")return[/^$/,[],[]];let e=0,a=[],s=[];return t=t.replace(/#(\d+)|@(\d+)|\.\*\$/g,(r,n,i)=>n!==void 0?(a[++e]=Number(n),"$()"):(i!==void 0&&(s[Number(i)]=++e),"")),[new RegExp(`^${t}`),a,s]}};var On=[],Cc=[/^$/,[],Object.create(null)],An=Object.create(null);function $n(t){return An[t]??=new RegExp(t==="*"?"":`^${t.replace(/\/\*$|([.\\+*[^\]$()])/g,(e,a)=>a?`\\${a}`:"(?:|/.*)")}$`)}function jc(){An=Object.create(null)}function Dc(t){let e=new Tn,a=[];if(t.length===0)return Cc;let s=t.map(u=>[!/\*|\/:/.test(u[0]),...u]).sort(([u,f],[p,y])=>u?1:p?-1:f.length-y.length),r=Object.create(null);for(let u=0,f=-1,p=s.length;u<p;u++){let[y,d,v]=s[u];y?r[d]=[v.map(([g])=>[g,Object.create(null)]),On]:f++;let b;try{b=e.insert(d,f,y)}catch(g){throw g===st?new Bt(d):g}y||(a[f]=v.map(([g,E])=>{let R=Object.create(null);for(E-=1;E>=0;E--){let[S,w]=b[E];R[S]=w}return[g,R]}))}let[n,i,o]=e.buildRegExp();for(let u=0,f=a.length;u<f;u++)for(let p=0,y=a[u].length;p<y;p++){let d=a[u][p]?.[1];if(!d)continue;let v=Object.keys(d);for(let b=0,g=v.length;b<g;b++)d[v[b]]=o[d[v[b]]]}let l=[];for(let u in i)l[u]=a[i[u]];return[n,l,r]}function nt(t,e){if(t){for(let a of Object.keys(t).sort((s,r)=>r.length-s.length))if($n(a).test(e))return[...t[a]]}}var rs=class{name="RegExpRouter";#r;#e;constructor(){this.#r={[ye]:Object.create(null)},this.#e={[ye]:Object.create(null)}}add(t,e,a){let s=this.#r,r=this.#e;if(!s||!r)throw new Error(Zt);s[t]||[s,r].forEach(o=>{o[t]=Object.create(null),Object.keys(o[ye]).forEach(l=>{o[t][l]=[...o[ye][l]]})}),e==="/*"&&(e="*");let n=(e.match(/\/:/g)||[]).length;if(/\*$/.test(e)){let o=$n(e);t===ye?Object.keys(s).forEach(l=>{s[l][e]||=nt(s[l],e)||nt(s[ye],e)||[]}):s[t][e]||=nt(s[t],e)||nt(s[ye],e)||[],Object.keys(s).forEach(l=>{(t===ye||t===l)&&Object.keys(s[l]).forEach(u=>{o.test(u)&&s[l][u].push([a,n])})}),Object.keys(r).forEach(l=>{(t===ye||t===l)&&Object.keys(r[l]).forEach(u=>o.test(u)&&r[l][u].push([a,n]))});return}let i=Vt(e)||[e];for(let o=0,l=i.length;o<l;o++){let u=i[o];Object.keys(r).forEach(f=>{(t===ye||t===f)&&(r[f][u]||=[...nt(s[f],u)||nt(s[ye],u)||[]],r[f][u].push([a,n-l+o+1]))})}}match(t,e){jc();let a=this.#t();return this.match=(s,r)=>{let n=a[s]||a[ye],i=n[2][r];if(i)return i;let o=r.match(n[0]);if(!o)return[[],On];let l=o.indexOf("",1);return[n[1][l],o]},this.match(t,e)}#t(){let t=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#r)).forEach(e=>{t[e]||=this.#n(e)}),this.#r=this.#e=void 0,t}#n(t){let e=[],a=t===ye;return[this.#r,this.#e].forEach(s=>{let r=s[t]?Object.keys(s[t]).map(n=>[n,s[t][n]]):[];r.length!==0?(a||=!0,e.push(...r)):t!==ye&&e.push(...Object.keys(s[ye]).map(n=>[n,s[ye][n]]))}),a?Dc(e):null}};var ts=class{name="SmartRouter";#r=[];#e=[];constructor(t){this.#r=t.routers}add(t,e,a){if(!this.#e)throw new Error(Zt);this.#e.push([t,e,a])}match(t,e){if(!this.#e)throw new Error("Fatal error");let a=this.#r,s=this.#e,r=a.length,n=0,i;for(;n<r;n++){let o=a[n];try{for(let l=0,u=s.length;l<u;l++)o.add(...s[l]);i=o.match(t,e)}catch(l){if(l instanceof Bt)continue;throw l}this.match=o.match.bind(o),this.#r=[o],this.#e=void 0;break}if(n===r)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,i}get activeRouter(){if(this.#e||this.#r.length!==1)throw new Error("No active router has been determined yet.");return this.#r[0]}};var Tt=Object.create(null),as=class{#r;#e;#t;#n=0;#a=Tt;constructor(t,e,a){if(this.#e=a||Object.create(null),this.#r=[],t&&e){let s=Object.create(null);s[t]={handler:e,possibleKeys:[],score:0},this.#r=[s]}this.#t=[]}insert(t,e,a){this.#n=++this.#n;let s=this,r=pn(e),n=[];for(let i=0,o=r.length;i<o;i++){let l=r[i],u=r[i+1],f=mn(l,u),p=Array.isArray(f)?f[0]:l;if(p in s.#e){s=s.#e[p],f&&n.push(f[1]);continue}s.#e[p]=new as,f&&(s.#t.push(f),n.push(f[1])),s=s.#e[p]}return s.#r.push({[t]:{handler:a,possibleKeys:n.filter((i,o,l)=>l.indexOf(i)===o),score:this.#n}}),s}#s(t,e,a,s){let r=[];for(let n=0,i=t.#r.length;n<i;n++){let o=t.#r[n],l=o[e]||o[ye],u={};if(l!==void 0&&(l.params=Object.create(null),r.push(l),a!==Tt||s&&s!==Tt))for(let f=0,p=l.possibleKeys.length;f<p;f++){let y=l.possibleKeys[f],d=u[l.score];l.params[y]=s?.[y]&&!d?s[y]:a[y]??s?.[y],u[l.score]=!0}}return r}search(t,e){let a=[];this.#a=Tt;let r=[this],n=Wa(e),i=[];for(let o=0,l=n.length;o<l;o++){let u=n[o],f=o===l-1,p=[];for(let y=0,d=r.length;y<d;y++){let v=r[y],b=v.#e[u];b&&(b.#a=v.#a,f?(b.#e["*"]&&a.push(...this.#s(b.#e["*"],t,v.#a)),a.push(...this.#s(b,t,v.#a))):p.push(b));for(let g=0,E=v.#t.length;g<E;g++){let R=v.#t[g],S=v.#a===Tt?{}:{...v.#a};if(R==="*"){let O=v.#e["*"];O&&(a.push(...this.#s(O,t,v.#a)),O.#a=S,p.push(O));continue}if(!u)continue;let[w,$,k]=R,L=v.#e[w],M=n.slice(o).join("/");if(k instanceof RegExp){let O=k.exec(M);if(O){if(S[$]=O[0],a.push(...this.#s(L,t,v.#a,S)),Object.keys(L.#e).length){L.#a=S;let H=O[0].match(/\//)?.length??0;(i[H]||=[]).push(L)}continue}}(k===!0||k.test(u))&&(S[$]=u,f?(a.push(...this.#s(L,t,S,v.#a)),L.#e["*"]&&a.push(...this.#s(L.#e["*"],t,S,v.#a))):(L.#a=S,p.push(L)))}}r=p.concat(i.shift()??[])}return a.length>1&&a.sort((o,l)=>o.score-l.score),[a.map(({handler:o,params:l})=>[o,l])]}};var ss=class{name="TrieRouter";#r;constructor(){this.#r=new as}add(t,e,a){let s=Vt(e);if(s){for(let r=0,n=s.length;r<n;r++)this.#r.insert(t,s[r],a);return}this.#r.insert(t,e,a)}match(t,e){return this.#r.search(t,e)}};var ns=class extends es{constructor(t={}){super(t),this.router=t.router??new ts({routers:[new rs,new ss]})}};var c={};un(c,{BRAND:()=>iu,DIRTY:()=>kr,EMPTY_PATH:()=>qc,INVALID:()=>Z,NEVER:()=>Zu,OK:()=>Ae,ParseStatus:()=>Re,Schema:()=>J,ZodAny:()=>br,ZodArray:()=>mr,ZodBigInt:()=>jr,ZodBoolean:()=>Dr,ZodBranded:()=>At,ZodCatch:()=>Br,ZodDate:()=>Nr,ZodDefault:()=>Zr,ZodDiscriminatedUnion:()=>Gt,ZodEffects:()=>Qe,ZodEnum:()=>Vr,ZodError:()=>Ne,ZodFirstPartyTypeKind:()=>A,ZodFunction:()=>Xt,ZodIntersection:()=>Mr,ZodIssueCode:()=>T,ZodLazy:()=>Hr,ZodLiteral:()=>zr,ZodMap:()=>dt,ZodNaN:()=>ht,ZodNativeEnum:()=>Ur,ZodNever:()=>Ge,ZodNull:()=>Fr,ZodNullable:()=>nr,ZodNumber:()=>Cr,ZodObject:()=>Fe,ZodOptional:()=>Le,ZodParsedType:()=>D,ZodPipeline:()=>$t,ZodPromise:()=>Pr,ZodReadonly:()=>Qr,ZodRecord:()=>Yt,ZodSchema:()=>J,ZodSet:()=>ft,ZodString:()=>_r,ZodSymbol:()=>ct,ZodTransformer:()=>Qe,ZodTuple:()=>sr,ZodType:()=>J,ZodUndefined:()=>Lr,ZodUnion:()=>qr,ZodUnknown:()=>pr,ZodVoid:()=>ut,addIssueToContext:()=>j,any:()=>vu,array:()=>bu,bigint:()=>du,boolean:()=>Hn,coerce:()=>Uu,custom:()=>Fn,date:()=>fu,datetimeRegex:()=>Nn,defaultErrorMap:()=>fr,discriminatedUnion:()=>Su,effect:()=>Nu,enum:()=>Cu,function:()=>$u,getErrorMap:()=>ot,getParsedType:()=>ar,instanceof:()=>cu,intersection:()=>wu,isAborted:()=>Jt,isAsync:()=>it,isDirty:()=>Wt,isValid:()=>yr,late:()=>lu,lazy:()=>Iu,literal:()=>ku,makeIssue:()=>Ot,map:()=>Ou,nan:()=>uu,nativeEnum:()=>ju,never:()=>yu,null:()=>mu,nullable:()=>Fu,number:()=>Mn,object:()=>Pu,objectUtil:()=>os,oboolean:()=>Vu,onumber:()=>zu,optional:()=>Lu,ostring:()=>Hu,pipeline:()=>Mu,preprocess:()=>qu,promise:()=>Du,quotelessJson:()=>Nc,record:()=>Tu,set:()=>Au,setErrorMap:()=>Fc,strictObject:()=>Eu,string:()=>qn,symbol:()=>hu,transformer:()=>Nu,tuple:()=>Ru,undefined:()=>pu,union:()=>xu,unknown:()=>gu,util:()=>X,void:()=>_u});var X;(function(t){t.assertEqual=r=>{};function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let n={};for(let i of r)n[i]=i;return n},t.getValidEnumValues=r=>{let n=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),i={};for(let o of n)i[o]=r[o];return t.objectValues(i)},t.objectValues=r=>t.objectKeys(r).map(function(n){return r[n]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let n=[];for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&n.push(i);return n},t.find=(r,n)=>{for(let i of r)if(n(i))return i},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,n=" | "){return r.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}t.joinValues=s,t.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n})(X||(X={}));var os;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(os||(os={}));var D=X.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ar=t=>{switch(typeof t){case"undefined":return D.undefined;case"string":return D.string;case"number":return Number.isNaN(t)?D.nan:D.number;case"boolean":return D.boolean;case"function":return D.function;case"bigint":return D.bigint;case"symbol":return D.symbol;case"object":return Array.isArray(t)?D.array:t===null?D.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?D.promise:typeof Map<"u"&&t instanceof Map?D.map:typeof Set<"u"&&t instanceof Set?D.set:typeof Date<"u"&&t instanceof Date?D.date:D.object;default:return D.unknown}};var T=X.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Nc=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Ne=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(n){return n.message},s={_errors:[]},r=n=>{for(let i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(r);else if(i.code==="invalid_return_type")r(i.returnTypeError);else if(i.code==="invalid_arguments")r(i.argumentsError);else if(i.path.length===0)s._errors.push(a(i));else{let o=s,l=0;for(;l<i.path.length;){let u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(a(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return r(this),s}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,X.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):s.push(e(r));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};Ne.create=t=>new Ne(t);var Lc=(t,e)=>{let a;switch(t.code){case T.invalid_type:t.received===D.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case T.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,X.jsonStringifyReplacer)}`;break;case T.unrecognized_keys:a=`Unrecognized key(s) in object: ${X.joinValues(t.keys,", ")}`;break;case T.invalid_union:a="Invalid input";break;case T.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${X.joinValues(t.options)}`;break;case T.invalid_enum_value:a=`Invalid enum value. Expected ${X.joinValues(t.options)}, received '${t.received}'`;break;case T.invalid_arguments:a="Invalid function arguments";break;case T.invalid_return_type:a="Invalid function return type";break;case T.invalid_date:a="Invalid date";break;case T.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:X.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case T.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case T.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case T.custom:a="Invalid input";break;case T.invalid_intersection_types:a="Intersection results could not be merged";break;case T.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case T.not_finite:a="Number must be finite";break;default:a=e.defaultError,X.assertNever(t)}return{message:a}},fr=Lc;var In=fr;function Fc(t){In=t}function ot(){return In}var Ot=t=>{let{data:e,path:a,errorMaps:s,issueData:r}=t,n=[...a,...r.path||[]],i={...r,path:n};if(r.message!==void 0)return{...r,path:n,message:r.message};let o="",l=s.filter(u=>!!u).slice().reverse();for(let u of l)o=u(i,{data:e,defaultError:o}).message;return{...r,path:n,message:o}},qc=[];function j(t,e){let a=ot(),s=Ot({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===fr?void 0:fr].filter(r=>!!r)});t.common.issues.push(s)}var Re=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let r of a){if(r.status==="aborted")return Z;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let r of a){let n=await r.key,i=await r.value;s.push({key:n,value:i})}return t.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let r of a){let{key:n,value:i}=r;if(n.status==="aborted"||i.status==="aborted")return Z;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof i.value<"u"||r.alwaysSet)&&(s[n.value]=i.value)}return{status:e.value,value:s}}},Z=Object.freeze({status:"aborted"}),kr=t=>({status:"dirty",value:t}),Ae=t=>({status:"valid",value:t}),Jt=t=>t.status==="aborted",Wt=t=>t.status==="dirty",yr=t=>t.status==="valid",it=t=>typeof Promise<"u"&&t instanceof Promise;var V;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(V||(V={}));var Be=class{constructor(e,a,s,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},kn=(t,e)=>{if(yr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Ne(t.common.issues);return this._error=a,this._error}}};function K(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:r}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,o)=>{let{message:l}=t;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??s??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??a??o.defaultError}},description:r}}var J=class{get description(){return this._def.description}_getType(e){return ar(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:ar(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:ar(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(it(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){let s={common:{issues:[],async:a?.async??!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)},r=this._parseSync({data:e,path:s.path,parent:s});return kn(s,r)}"~validate"(e){let a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)};if(!this["~standard"].async)try{let s=this._parseSync({data:e,path:[],parent:a});return yr(s)?{value:s.value}:{issues:a.common.issues}}catch(s){s?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:a}).then(s=>yr(s)?{value:s.value}:{issues:a.common.issues})}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)},r=this._parse({data:e,path:s.path,parent:s}),n=await(it(r)?r:Promise.resolve(r));return kn(s,n)}refine(e,a){let s=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,n)=>{let i=e(r),o=()=>n.addIssue({code:T.custom,...s(r)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,a){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof a=="function"?a(s,r):a),!1))}_refinement(e){return new Qe({schema:this,typeName:A.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Le.create(this,this._def)}nullable(){return nr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return mr.create(this)}promise(){return Pr.create(this,this._def)}or(e){return qr.create([this,e],this._def)}and(e){return Mr.create(this,e,this._def)}transform(e){return new Qe({...K(this._def),schema:this,typeName:A.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new Zr({...K(this._def),innerType:this,defaultValue:a,typeName:A.ZodDefault})}brand(){return new At({typeName:A.ZodBranded,type:this,...K(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new Br({...K(this._def),innerType:this,catchValue:a,typeName:A.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return $t.create(this,e)}readonly(){return Qr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Mc=/^c[^\s-]{8,}$/i,Hc=/^[0-9a-z]+$/,zc=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Vc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Uc=/^[a-z0-9_-]{21}$/i,Zc=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Bc=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Qc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Kc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",is,Jc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Wc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Gc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Yc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eu=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,jn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ru=new RegExp(`^${jn}$`);function Dn(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let a=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${a}`}function tu(t){return new RegExp(`^${Dn(t)}$`)}function Nn(t){let e=`${jn}T${Dn(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function au(t,e){return!!((e==="v4"||!e)&&Jc.test(t)||(e==="v6"||!e)&&Gc.test(t))}function su(t,e){if(!Zc.test(t))return!1;try{let[a]=t.split("."),s=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function nu(t,e){return!!((e==="v4"||!e)&&Wc.test(t)||(e==="v6"||!e)&&Yc.test(t))}var _r=class t extends J{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==D.string){let n=this._getOrReturnCtx(e);return j(n,{code:T.invalid_type,expected:D.string,received:n.parsedType}),Z}let s=new Re,r;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),j(r,{code:T.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="max")e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),j(r,{code:T.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,o=e.data.length<n.value;(i||o)&&(r=this._getOrReturnCtx(e,r),i?j(r,{code:T.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&j(r,{code:T.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),s.dirty())}else if(n.kind==="email")Qc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"email",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="emoji")is||(is=new RegExp(Kc,"u")),is.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"emoji",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="uuid")Vc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"uuid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="nanoid")Uc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"nanoid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid")Mc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"cuid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid2")Hc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"cuid2",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="ulid")zc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"ulid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),j(r,{validation:"url",code:T.invalid_string,message:n.message}),s.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"regex",code:T.invalid_string,message:n.message}),s.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),s.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:{startsWith:n.value},message:n.message}),s.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:{endsWith:n.value},message:n.message}),s.dirty()):n.kind==="datetime"?Nn(n).test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:"datetime",message:n.message}),s.dirty()):n.kind==="date"?ru.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:"date",message:n.message}),s.dirty()):n.kind==="time"?tu(n).test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{code:T.invalid_string,validation:"time",message:n.message}),s.dirty()):n.kind==="duration"?Bc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"duration",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="ip"?au(e.data,n.version)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"ip",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="jwt"?su(e.data,n.alg)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"jwt",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="cidr"?nu(e.data,n.version)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"cidr",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="base64"?Xc.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"base64",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="base64url"?eu.test(e.data)||(r=this._getOrReturnCtx(e,r),j(r,{validation:"base64url",code:T.invalid_string,message:n.message}),s.dirty()):X.assertNever(n);return{status:s.value,value:e.data}}_regex(e,a,s){return this.refinement(r=>e.test(r),{validation:a,code:T.invalid_string,...V.errToObj(s)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...V.errToObj(e)})}url(e){return this._addCheck({kind:"url",...V.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...V.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...V.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...V.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...V.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...V.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...V.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...V.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...V.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...V.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...V.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...V.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...V.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...V.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...V.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...V.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...V.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...V.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...V.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...V.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...V.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...V.errToObj(a)})}nonempty(e){return this.min(1,V.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};_r.create=t=>new _r({checks:[],typeName:A.ZodString,coerce:t?.coerce??!1,...K(t)});function ou(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=a>s?a:s,n=Number.parseInt(t.toFixed(r).replace(".","")),i=Number.parseInt(e.toFixed(r).replace(".",""));return n%i/10**r}var Cr=class t extends J{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==D.number){let n=this._getOrReturnCtx(e);return j(n,{code:T.invalid_type,expected:D.number,received:n.parsedType}),Z}let s,r=new Re;for(let n of this._def.checks)n.kind==="int"?X.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{code:T.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?ou(e.data,n.value)!==0&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{code:T.not_finite,message:n.message}),r.dirty()):X.assertNever(n);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,V.toString(a))}gt(e,a){return this.setLimit("min",e,!1,V.toString(a))}lte(e,a){return this.setLimit("max",e,!0,V.toString(a))}lt(e,a){return this.setLimit("max",e,!1,V.toString(a))}setLimit(e,a,s,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:V.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:V.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:V.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:V.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:V.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:V.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:V.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:V.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:V.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:V.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&X.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Cr.create=t=>new Cr({checks:[],typeName:A.ZodNumber,coerce:t?.coerce||!1,...K(t)});var jr=class t extends J{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==D.bigint)return this._getInvalidInput(e);let s,r=new Re;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),j(s,{code:T.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):X.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return j(a,{code:T.invalid_type,expected:D.bigint,received:a.parsedType}),Z}gte(e,a){return this.setLimit("min",e,!0,V.toString(a))}gt(e,a){return this.setLimit("min",e,!1,V.toString(a))}lte(e,a){return this.setLimit("max",e,!0,V.toString(a))}lt(e,a){return this.setLimit("max",e,!1,V.toString(a))}setLimit(e,a,s,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:V.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:V.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:V.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:V.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:V.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:V.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};jr.create=t=>new jr({checks:[],typeName:A.ZodBigInt,coerce:t?.coerce??!1,...K(t)});var Dr=class extends J{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==D.boolean){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.boolean,received:s.parsedType}),Z}return Ae(e.data)}};Dr.create=t=>new Dr({typeName:A.ZodBoolean,coerce:t?.coerce||!1,...K(t)});var Nr=class t extends J{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==D.date){let n=this._getOrReturnCtx(e);return j(n,{code:T.invalid_type,expected:D.date,received:n.parsedType}),Z}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return j(n,{code:T.invalid_date}),Z}let s=new Re,r;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),j(r,{code:T.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),s.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),j(r,{code:T.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),s.dirty()):X.assertNever(n);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:V.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:V.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Nr.create=t=>new Nr({checks:[],coerce:t?.coerce||!1,typeName:A.ZodDate,...K(t)});var ct=class extends J{_parse(e){if(this._getType(e)!==D.symbol){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.symbol,received:s.parsedType}),Z}return Ae(e.data)}};ct.create=t=>new ct({typeName:A.ZodSymbol,...K(t)});var Lr=class extends J{_parse(e){if(this._getType(e)!==D.undefined){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.undefined,received:s.parsedType}),Z}return Ae(e.data)}};Lr.create=t=>new Lr({typeName:A.ZodUndefined,...K(t)});var Fr=class extends J{_parse(e){if(this._getType(e)!==D.null){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.null,received:s.parsedType}),Z}return Ae(e.data)}};Fr.create=t=>new Fr({typeName:A.ZodNull,...K(t)});var br=class extends J{constructor(){super(...arguments),this._any=!0}_parse(e){return Ae(e.data)}};br.create=t=>new br({typeName:A.ZodAny,...K(t)});var pr=class extends J{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ae(e.data)}};pr.create=t=>new pr({typeName:A.ZodUnknown,...K(t)});var Ge=class extends J{_parse(e){let a=this._getOrReturnCtx(e);return j(a,{code:T.invalid_type,expected:D.never,received:a.parsedType}),Z}};Ge.create=t=>new Ge({typeName:A.ZodNever,...K(t)});var ut=class extends J{_parse(e){if(this._getType(e)!==D.undefined){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.void,received:s.parsedType}),Z}return Ae(e.data)}};ut.create=t=>new ut({typeName:A.ZodVoid,...K(t)});var mr=class t extends J{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),r=this._def;if(a.parsedType!==D.array)return j(a,{code:T.invalid_type,expected:D.array,received:a.parsedType}),Z;if(r.exactLength!==null){let i=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(i||o)&&(j(a,{code:i?T.too_big:T.too_small,minimum:o?r.exactLength.value:void 0,maximum:i?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(j(a,{code:T.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(j(a,{code:T.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((i,o)=>r.type._parseAsync(new Be(a,i,a.path,o)))).then(i=>Re.mergeArray(s,i));let n=[...a.data].map((i,o)=>r.type._parseSync(new Be(a,i,a.path,o)));return Re.mergeArray(s,n)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:V.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:V.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:V.toString(a)}})}nonempty(e){return this.min(1,e)}};mr.create=(t,e)=>new mr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:A.ZodArray,...K(e)});function lt(t){if(t instanceof Fe){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Le.create(lt(s))}return new Fe({...t._def,shape:()=>e})}else return t instanceof mr?new mr({...t._def,type:lt(t.element)}):t instanceof Le?Le.create(lt(t.unwrap())):t instanceof nr?nr.create(lt(t.unwrap())):t instanceof sr?sr.create(t.items.map(e=>lt(e))):t}var Fe=class t extends J{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=X.objectKeys(e);return this._cached={shape:e,keys:a},this._cached}_parse(e){if(this._getType(e)!==D.object){let u=this._getOrReturnCtx(e);return j(u,{code:T.invalid_type,expected:D.object,received:u.parsedType}),Z}let{status:s,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ge&&this._def.unknownKeys==="strip"))for(let u in r.data)i.includes(u)||o.push(u);let l=[];for(let u of i){let f=n[u],p=r.data[u];l.push({key:{status:"valid",value:u},value:f._parse(new Be(r,p,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof Ge){let u=this._def.unknownKeys;if(u==="passthrough")for(let f of o)l.push({key:{status:"valid",value:f},value:{status:"valid",value:r.data[f]}});else if(u==="strict")o.length>0&&(j(r,{code:T.unrecognized_keys,keys:o}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let f of o){let p=r.data[f];l.push({key:{status:"valid",value:f},value:u._parse(new Be(r,p,r.path,f)),alwaysSet:f in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let u=[];for(let f of l){let p=await f.key,y=await f.value;u.push({key:p,value:y,alwaysSet:f.alwaysSet})}return u}).then(u=>Re.mergeObjectSync(s,u)):Re.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return V.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{let r=this._def.errorMap?.(a,s).message??s.defaultError;return a.code==="unrecognized_keys"?{message:V.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:A.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let a={};for(let s of X.objectKeys(e))e[s]&&this.shape[s]&&(a[s]=this.shape[s]);return new t({...this._def,shape:()=>a})}omit(e){let a={};for(let s of X.objectKeys(this.shape))e[s]||(a[s]=this.shape[s]);return new t({...this._def,shape:()=>a})}deepPartial(){return lt(this)}partial(e){let a={};for(let s of X.objectKeys(this.shape)){let r=this.shape[s];e&&!e[s]?a[s]=r:a[s]=r.optional()}return new t({...this._def,shape:()=>a})}required(e){let a={};for(let s of X.objectKeys(this.shape))if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Le;)n=n._def.innerType;a[s]=n}return new t({...this._def,shape:()=>a})}keyof(){return Ln(X.objectKeys(this.shape))}};Fe.create=(t,e)=>new Fe({shape:()=>t,unknownKeys:"strip",catchall:Ge.create(),typeName:A.ZodObject,...K(e)});Fe.strictCreate=(t,e)=>new Fe({shape:()=>t,unknownKeys:"strict",catchall:Ge.create(),typeName:A.ZodObject,...K(e)});Fe.lazycreate=(t,e)=>new Fe({shape:t,unknownKeys:"strip",catchall:Ge.create(),typeName:A.ZodObject,...K(e)});var qr=class extends J{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function r(n){for(let o of n)if(o.result.status==="valid")return o.result;for(let o of n)if(o.result.status==="dirty")return a.common.issues.push(...o.ctx.common.issues),o.result;let i=n.map(o=>new Ne(o.ctx.common.issues));return j(a,{code:T.invalid_union,unionErrors:i}),Z}if(a.common.async)return Promise.all(s.map(async n=>{let i={...a,common:{...a.common,issues:[]},parent:null};return{result:await n._parseAsync({data:a.data,path:a.path,parent:i}),ctx:i}})).then(r);{let n,i=[];for(let l of s){let u={...a,common:{...a.common,issues:[]},parent:null},f=l._parseSync({data:a.data,path:a.path,parent:u});if(f.status==="valid")return f;f.status==="dirty"&&!n&&(n={result:f,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(n)return a.common.issues.push(...n.ctx.common.issues),n.result;let o=i.map(l=>new Ne(l));return j(a,{code:T.invalid_union,unionErrors:o}),Z}}get options(){return this._def.options}};qr.create=(t,e)=>new qr({options:t,typeName:A.ZodUnion,...K(e)});var hr=t=>t instanceof Hr?hr(t.schema):t instanceof Qe?hr(t.innerType()):t instanceof zr?[t.value]:t instanceof Vr?t.options:t instanceof Ur?X.objectValues(t.enum):t instanceof Zr?hr(t._def.innerType):t instanceof Lr?[void 0]:t instanceof Fr?[null]:t instanceof Le?[void 0,...hr(t.unwrap())]:t instanceof nr?[null,...hr(t.unwrap())]:t instanceof At||t instanceof Qr?hr(t.unwrap()):t instanceof Br?hr(t._def.innerType):[],Gt=class t extends J{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==D.object)return j(a,{code:T.invalid_type,expected:D.object,received:a.parsedType}),Z;let s=this.discriminator,r=a.data[s],n=this.optionsMap.get(r);return n?a.common.async?n._parseAsync({data:a.data,path:a.path,parent:a}):n._parseSync({data:a.data,path:a.path,parent:a}):(j(a,{code:T.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Z)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let r=new Map;for(let n of a){let i=hr(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let o of i){if(r.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);r.set(o,n)}}return new t({typeName:A.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:r,...K(s)})}};function ls(t,e){let a=ar(t),s=ar(e);if(t===e)return{valid:!0,data:t};if(a===D.object&&s===D.object){let r=X.objectKeys(e),n=X.objectKeys(t).filter(o=>r.indexOf(o)!==-1),i={...t,...e};for(let o of n){let l=ls(t[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(a===D.array&&s===D.array){if(t.length!==e.length)return{valid:!1};let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=e[n],l=ls(i,o);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return a===D.date&&s===D.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Mr=class extends J{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),r=(n,i)=>{if(Jt(n)||Jt(i))return Z;let o=ls(n.value,i.value);return o.valid?((Wt(n)||Wt(i))&&a.dirty(),{status:a.value,value:o.data}):(j(s,{code:T.invalid_intersection_types}),Z)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([n,i])=>r(n,i)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Mr.create=(t,e,a)=>new Mr({left:t,right:e,typeName:A.ZodIntersection,...K(a)});var sr=class t extends J{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==D.array)return j(s,{code:T.invalid_type,expected:D.array,received:s.parsedType}),Z;if(s.data.length<this._def.items.length)return j(s,{code:T.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Z;!this._def.rest&&s.data.length>this._def.items.length&&(j(s,{code:T.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Be(s,i,s.path,o)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>Re.mergeArray(a,i)):Re.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};sr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new sr({items:t,typeName:A.ZodTuple,rest:null,...K(e)})};var Yt=class t extends J{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==D.object)return j(s,{code:T.invalid_type,expected:D.object,received:s.parsedType}),Z;let r=[],n=this._def.keyType,i=this._def.valueType;for(let o in s.data)r.push({key:n._parse(new Be(s,o,s.path,o)),value:i._parse(new Be(s,s.data[o],s.path,o)),alwaysSet:o in s.data});return s.common.async?Re.mergeObjectAsync(a,r):Re.mergeObjectSync(a,r)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof J?new t({keyType:e,valueType:a,typeName:A.ZodRecord,...K(s)}):new t({keyType:_r.create(),valueType:e,typeName:A.ZodRecord,...K(a)})}},dt=class extends J{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==D.map)return j(s,{code:T.invalid_type,expected:D.map,received:s.parsedType}),Z;let r=this._def.keyType,n=this._def.valueType,i=[...s.data.entries()].map(([o,l],u)=>({key:r._parse(new Be(s,o,s.path,[u,"key"])),value:n._parse(new Be(s,l,s.path,[u,"value"]))}));if(s.common.async){let o=new Map;return Promise.resolve().then(async()=>{for(let l of i){let u=await l.key,f=await l.value;if(u.status==="aborted"||f.status==="aborted")return Z;(u.status==="dirty"||f.status==="dirty")&&a.dirty(),o.set(u.value,f.value)}return{status:a.value,value:o}})}else{let o=new Map;for(let l of i){let u=l.key,f=l.value;if(u.status==="aborted"||f.status==="aborted")return Z;(u.status==="dirty"||f.status==="dirty")&&a.dirty(),o.set(u.value,f.value)}return{status:a.value,value:o}}}};dt.create=(t,e,a)=>new dt({valueType:e,keyType:t,typeName:A.ZodMap,...K(a)});var ft=class t extends J{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==D.set)return j(s,{code:T.invalid_type,expected:D.set,received:s.parsedType}),Z;let r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(j(s,{code:T.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),a.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(j(s,{code:T.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),a.dirty());let n=this._def.valueType;function i(l){let u=new Set;for(let f of l){if(f.status==="aborted")return Z;f.status==="dirty"&&a.dirty(),u.add(f.value)}return{status:a.value,value:u}}let o=[...s.data.values()].map((l,u)=>n._parse(new Be(s,l,s.path,u)));return s.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,a){return new t({...this._def,minSize:{value:e,message:V.toString(a)}})}max(e,a){return new t({...this._def,maxSize:{value:e,message:V.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};ft.create=(t,e)=>new ft({valueType:t,minSize:null,maxSize:null,typeName:A.ZodSet,...K(e)});var Xt=class t extends J{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==D.function)return j(a,{code:T.invalid_type,expected:D.function,received:a.parsedType}),Z;function s(o,l){return Ot({data:o,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,ot(),fr].filter(u=>!!u),issueData:{code:T.invalid_arguments,argumentsError:l}})}function r(o,l){return Ot({data:o,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,ot(),fr].filter(u=>!!u),issueData:{code:T.invalid_return_type,returnTypeError:l}})}let n={errorMap:a.common.contextualErrorMap},i=a.data;if(this._def.returns instanceof Pr){let o=this;return Ae(async function(...l){let u=new Ne([]),f=await o._def.args.parseAsync(l,n).catch(d=>{throw u.addIssue(s(l,d)),u}),p=await Reflect.apply(i,this,f);return await o._def.returns._def.type.parseAsync(p,n).catch(d=>{throw u.addIssue(r(p,d)),u})})}else{let o=this;return Ae(function(...l){let u=o._def.args.safeParse(l,n);if(!u.success)throw new Ne([s(l,u.error)]);let f=Reflect.apply(i,this,u.data),p=o._def.returns.safeParse(f,n);if(!p.success)throw new Ne([r(f,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:sr.create(e).rest(pr.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new t({args:e||sr.create([]).rest(pr.create()),returns:a||pr.create(),typeName:A.ZodFunction,...K(s)})}},Hr=class extends J{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Hr.create=(t,e)=>new Hr({getter:t,typeName:A.ZodLazy,...K(e)});var zr=class extends J{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return j(a,{received:a.data,code:T.invalid_literal,expected:this._def.value}),Z}return{status:"valid",value:e.data}}get value(){return this._def.value}};zr.create=(t,e)=>new zr({value:t,typeName:A.ZodLiteral,...K(e)});function Ln(t,e){return new Vr({values:t,typeName:A.ZodEnum,...K(e)})}var Vr=class t extends J{_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return j(a,{expected:X.joinValues(s),received:a.parsedType,code:T.invalid_type}),Z}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return j(a,{received:a.data,code:T.invalid_enum_value,options:s}),Z}return Ae(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return t.create(e,{...this._def,...a})}exclude(e,a=this._def){return t.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Vr.create=Ln;var Ur=class extends J{_parse(e){let a=X.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==D.string&&s.parsedType!==D.number){let r=X.objectValues(a);return j(s,{expected:X.joinValues(r),received:s.parsedType,code:T.invalid_type}),Z}if(this._cache||(this._cache=new Set(X.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let r=X.objectValues(a);return j(s,{received:s.data,code:T.invalid_enum_value,options:r}),Z}return Ae(e.data)}get enum(){return this._def.values}};Ur.create=(t,e)=>new Ur({values:t,typeName:A.ZodNativeEnum,...K(e)});var Pr=class extends J{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==D.promise&&a.common.async===!1)return j(a,{code:T.invalid_type,expected:D.promise,received:a.parsedType}),Z;let s=a.parsedType===D.promise?a.data:Promise.resolve(a.data);return Ae(s.then(r=>this._def.type.parseAsync(r,{path:a.path,errorMap:a.common.contextualErrorMap})))}};Pr.create=(t,e)=>new Pr({type:t,typeName:A.ZodPromise,...K(e)});var Qe=class extends J{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===A.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),r=this._def.effect||null,n={addIssue:i=>{j(s,i),i.fatal?a.abort():a.dirty()},get path(){return s.path}};if(n.addIssue=n.addIssue.bind(n),r.type==="preprocess"){let i=r.transform(s.data,n);if(s.common.async)return Promise.resolve(i).then(async o=>{if(a.value==="aborted")return Z;let l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?Z:l.status==="dirty"?kr(l.value):a.value==="dirty"?kr(l.value):l});{if(a.value==="aborted")return Z;let o=this._def.schema._parseSync({data:i,path:s.path,parent:s});return o.status==="aborted"?Z:o.status==="dirty"?kr(o.value):a.value==="dirty"?kr(o.value):o}}if(r.type==="refinement"){let i=o=>{let l=r.refinement(o,n);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?Z:(o.status==="dirty"&&a.dirty(),i(o.value),{status:a.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?Z:(o.status==="dirty"&&a.dirty(),i(o.value).then(()=>({status:a.value,value:o.value}))))}if(r.type==="transform")if(s.common.async===!1){let i=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!yr(i))return Z;let o=r.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(i=>yr(i)?Promise.resolve(r.transform(i.value,n)).then(o=>({status:a.value,value:o})):Z);X.assertNever(r)}};Qe.create=(t,e,a)=>new Qe({schema:t,typeName:A.ZodEffects,effect:e,...K(a)});Qe.createWithPreprocess=(t,e,a)=>new Qe({schema:e,effect:{type:"preprocess",transform:t},typeName:A.ZodEffects,...K(a)});var Le=class extends J{_parse(e){return this._getType(e)===D.undefined?Ae(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Le.create=(t,e)=>new Le({innerType:t,typeName:A.ZodOptional,...K(e)});var nr=class extends J{_parse(e){return this._getType(e)===D.null?Ae(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};nr.create=(t,e)=>new nr({innerType:t,typeName:A.ZodNullable,...K(e)});var Zr=class extends J{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===D.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};Zr.create=(t,e)=>new Zr({innerType:t,typeName:A.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...K(e)});var Br=class extends J{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return it(r)?r.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Ne(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Ne(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Br.create=(t,e)=>new Br({innerType:t,typeName:A.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...K(e)});var ht=class extends J{_parse(e){if(this._getType(e)!==D.nan){let s=this._getOrReturnCtx(e);return j(s,{code:T.invalid_type,expected:D.nan,received:s.parsedType}),Z}return{status:"valid",value:e.data}}};ht.create=t=>new ht({typeName:A.ZodNaN,...K(t)});var iu=Symbol("zod_brand"),At=class extends J{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},$t=class t extends J{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Z:n.status==="dirty"?(a.dirty(),kr(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?Z:r.status==="dirty"?(a.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,a){return new t({in:e,out:a,typeName:A.ZodPipeline})}},Qr=class extends J{_parse(e){let a=this._def.innerType._parse(e),s=r=>(yr(r)&&(r.value=Object.freeze(r.value)),r);return it(a)?a.then(r=>s(r)):s(a)}unwrap(){return this._def.innerType}};Qr.create=(t,e)=>new Qr({innerType:t,typeName:A.ZodReadonly,...K(e)});function Cn(t,e){let a=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof a=="string"?{message:a}:a}function Fn(t,e={},a){return t?br.create().superRefine((s,r)=>{let n=t(s);if(n instanceof Promise)return n.then(i=>{if(!i){let o=Cn(e,s),l=o.fatal??a??!0;r.addIssue({code:"custom",...o,fatal:l})}});if(!n){let i=Cn(e,s),o=i.fatal??a??!0;r.addIssue({code:"custom",...i,fatal:o})}}):br.create()}var lu={object:Fe.lazycreate},A;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(A||(A={}));var cu=(t,e={message:`Input not instance of ${t.name}`})=>Fn(a=>a instanceof t,e),qn=_r.create,Mn=Cr.create,uu=ht.create,du=jr.create,Hn=Dr.create,fu=Nr.create,hu=ct.create,pu=Lr.create,mu=Fr.create,vu=br.create,gu=pr.create,yu=Ge.create,_u=ut.create,bu=mr.create,Pu=Fe.create,Eu=Fe.strictCreate,xu=qr.create,Su=Gt.create,wu=Mr.create,Ru=sr.create,Tu=Yt.create,Ou=dt.create,Au=ft.create,$u=Xt.create,Iu=Hr.create,ku=zr.create,Cu=Vr.create,ju=Ur.create,Du=Pr.create,Nu=Qe.create,Lu=Le.create,Fu=nr.create,qu=Qe.createWithPreprocess,Mu=$t.create,Hu=()=>qn().optional(),zu=()=>Mn().optional(),Vu=()=>Hn().optional(),Uu={string:t=>_r.create({...t,coerce:!0}),number:t=>Cr.create({...t,coerce:!0}),boolean:t=>Dr.create({...t,coerce:!0}),bigint:t=>jr.create({...t,coerce:!0}),date:t=>Nr.create({...t,coerce:!0})};var Zu=Z;var cs="2025-06-18";var zn=[cs,"2025-03-26","2024-11-05","2024-10-07"],ea="2.0",Vn=c.union([c.string(),c.number().int()]),Un=c.string(),Bu=c.object({progressToken:c.optional(Vn)}).passthrough(),Ke=c.object({_meta:c.optional(Bu)}).passthrough(),qe=c.object({method:c.string(),params:c.optional(Ke)}),It=c.object({_meta:c.optional(c.object({}).passthrough())}).passthrough(),or=c.object({method:c.string(),params:c.optional(It)}),Je=c.object({_meta:c.optional(c.object({}).passthrough())}).passthrough(),ra=c.union([c.string(),c.number().int()]),Zn=c.object({jsonrpc:c.literal(ea),id:ra}).merge(qe).strict(),pt=t=>Zn.safeParse(t).success,Bn=c.object({jsonrpc:c.literal(ea)}).merge(or).strict(),Qn=t=>Bn.safeParse(t).success,Kn=c.object({jsonrpc:c.literal(ea),id:ra,result:Je}).strict(),Kr=t=>Kn.safeParse(t).success,de;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError"})(de||(de={}));var Jn=c.object({jsonrpc:c.literal(ea),id:ra,error:c.object({code:c.number().int(),message:c.string(),data:c.optional(c.unknown())})}).strict(),mt=t=>Jn.safeParse(t).success,us=c.union([Zn,Bn,Kn,Jn]),ta=Je.strict(),aa=or.extend({method:c.literal("notifications/cancelled"),params:It.extend({requestId:ra,reason:c.string().optional()})}),kt=c.object({name:c.string(),title:c.optional(c.string())}).passthrough(),Wn=kt.extend({version:c.string()}),Qu=c.object({experimental:c.optional(c.object({}).passthrough()),sampling:c.optional(c.object({}).passthrough()),elicitation:c.optional(c.object({}).passthrough()),roots:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough())}).passthrough(),sa=qe.extend({method:c.literal("initialize"),params:Ke.extend({protocolVersion:c.string(),capabilities:Qu,clientInfo:Wn})}),Gn=t=>sa.safeParse(t).success,Ku=c.object({experimental:c.optional(c.object({}).passthrough()),logging:c.optional(c.object({}).passthrough()),completions:c.optional(c.object({}).passthrough()),prompts:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough()),resources:c.optional(c.object({subscribe:c.optional(c.boolean()),listChanged:c.optional(c.boolean())}).passthrough()),tools:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough())}).passthrough(),Ju=Je.extend({protocolVersion:c.string(),capabilities:Ku,serverInfo:Wn,instructions:c.optional(c.string())}),ds=or.extend({method:c.literal("notifications/initialized")});var na=qe.extend({method:c.literal("ping")}),Wu=c.object({progress:c.number(),total:c.optional(c.number()),message:c.optional(c.string())}).passthrough(),oa=or.extend({method:c.literal("notifications/progress"),params:It.merge(Wu).extend({progressToken:Vn})}),ia=qe.extend({params:Ke.extend({cursor:c.optional(Un)}).optional()}),la=Je.extend({nextCursor:c.optional(Un)}),Yn=c.object({uri:c.string(),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).passthrough(),Xn=Yn.extend({text:c.string()}),eo=Yn.extend({blob:c.string().base64()}),ro=kt.extend({uri:c.string(),description:c.optional(c.string()),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}),Gu=kt.extend({uriTemplate:c.string(),description:c.optional(c.string()),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}),ca=ia.extend({method:c.literal("resources/list")}),Yu=la.extend({resources:c.array(ro)}),ua=ia.extend({method:c.literal("resources/templates/list")}),Xu=la.extend({resourceTemplates:c.array(Gu)}),da=qe.extend({method:c.literal("resources/read"),params:Ke.extend({uri:c.string()})}),ed=Je.extend({contents:c.array(c.union([Xn,eo]))}),rd=or.extend({method:c.literal("notifications/resources/list_changed")}),td=qe.extend({method:c.literal("resources/subscribe"),params:Ke.extend({uri:c.string()})}),ad=qe.extend({method:c.literal("resources/unsubscribe"),params:Ke.extend({uri:c.string()})}),sd=or.extend({method:c.literal("notifications/resources/updated"),params:It.extend({uri:c.string()})}),nd=c.object({name:c.string(),description:c.optional(c.string()),required:c.optional(c.boolean())}).passthrough(),od=kt.extend({description:c.optional(c.string()),arguments:c.optional(c.array(nd)),_meta:c.optional(c.object({}).passthrough())}),fa=ia.extend({method:c.literal("prompts/list")}),id=la.extend({prompts:c.array(od)}),ha=qe.extend({method:c.literal("prompts/get"),params:Ke.extend({name:c.string(),arguments:c.optional(c.record(c.string()))})}),fs=c.object({type:c.literal("text"),text:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),hs=c.object({type:c.literal("image"),data:c.string().base64(),mimeType:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),ps=c.object({type:c.literal("audio"),data:c.string().base64(),mimeType:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),ld=c.object({type:c.literal("resource"),resource:c.union([Xn,eo]),_meta:c.optional(c.object({}).passthrough())}).passthrough(),cd=ro.extend({type:c.literal("resource_link")}),to=c.union([fs,hs,ps,cd,ld]),ud=c.object({role:c.enum(["user","assistant"]),content:to}).passthrough(),dd=Je.extend({description:c.optional(c.string()),messages:c.array(ud)}),fd=or.extend({method:c.literal("notifications/prompts/list_changed")}),hd=c.object({title:c.optional(c.string()),readOnlyHint:c.optional(c.boolean()),destructiveHint:c.optional(c.boolean()),idempotentHint:c.optional(c.boolean()),openWorldHint:c.optional(c.boolean())}).passthrough(),pd=kt.extend({description:c.optional(c.string()),inputSchema:c.object({type:c.literal("object"),properties:c.optional(c.object({}).passthrough()),required:c.optional(c.array(c.string()))}).passthrough(),outputSchema:c.optional(c.object({type:c.literal("object"),properties:c.optional(c.object({}).passthrough()),required:c.optional(c.array(c.string()))}).passthrough()),annotations:c.optional(hd),_meta:c.optional(c.object({}).passthrough())}),pa=ia.extend({method:c.literal("tools/list")}),md=la.extend({tools:c.array(pd)}),ao=Je.extend({content:c.array(to).default([]),structuredContent:c.object({}).passthrough().optional(),isError:c.optional(c.boolean())}),Hm=ao.or(Je.extend({toolResult:c.unknown()})),ma=qe.extend({method:c.literal("tools/call"),params:Ke.extend({name:c.string(),arguments:c.optional(c.record(c.unknown()))})}),vd=or.extend({method:c.literal("notifications/tools/list_changed")}),so=c.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),gd=qe.extend({method:c.literal("logging/setLevel"),params:Ke.extend({level:so})}),yd=or.extend({method:c.literal("notifications/message"),params:It.extend({level:so,logger:c.optional(c.string()),data:c.unknown()})}),_d=c.object({name:c.string().optional()}).passthrough(),bd=c.object({hints:c.optional(c.array(_d)),costPriority:c.optional(c.number().min(0).max(1)),speedPriority:c.optional(c.number().min(0).max(1)),intelligencePriority:c.optional(c.number().min(0).max(1))}).passthrough(),Pd=c.object({role:c.enum(["user","assistant"]),content:c.union([fs,hs,ps])}).passthrough(),Ed=qe.extend({method:c.literal("sampling/createMessage"),params:Ke.extend({messages:c.array(Pd),systemPrompt:c.optional(c.string()),includeContext:c.optional(c.enum(["none","thisServer","allServers"])),temperature:c.optional(c.number()),maxTokens:c.number().int(),stopSequences:c.optional(c.array(c.string())),metadata:c.optional(c.object({}).passthrough()),modelPreferences:c.optional(bd)})}),ms=Je.extend({model:c.string(),stopReason:c.optional(c.enum(["endTurn","stopSequence","maxTokens"]).or(c.string())),role:c.enum(["user","assistant"]),content:c.discriminatedUnion("type",[fs,hs,ps])}),xd=c.object({type:c.literal("boolean"),title:c.optional(c.string()),description:c.optional(c.string()),default:c.optional(c.boolean())}).passthrough(),Sd=c.object({type:c.literal("string"),title:c.optional(c.string()),description:c.optional(c.string()),minLength:c.optional(c.number()),maxLength:c.optional(c.number()),format:c.optional(c.enum(["email","uri","date","date-time"]))}).passthrough(),wd=c.object({type:c.enum(["number","integer"]),title:c.optional(c.string()),description:c.optional(c.string()),minimum:c.optional(c.number()),maximum:c.optional(c.number())}).passthrough(),Rd=c.object({type:c.literal("string"),title:c.optional(c.string()),description:c.optional(c.string()),enum:c.array(c.string()),enumNames:c.optional(c.array(c.string()))}).passthrough(),Td=c.union([xd,Sd,wd,Rd]),Od=qe.extend({method:c.literal("elicitation/create"),params:Ke.extend({message:c.string(),requestedSchema:c.object({type:c.literal("object"),properties:c.record(c.string(),Td),required:c.optional(c.array(c.string()))}).passthrough()})}),vs=Je.extend({action:c.enum(["accept","reject","cancel"]),content:c.optional(c.record(c.string(),c.unknown()))}),Ad=c.object({type:c.literal("ref/resource"),uri:c.string()}).passthrough();var $d=c.object({type:c.literal("ref/prompt"),name:c.string()}).passthrough(),va=qe.extend({method:c.literal("completion/complete"),params:Ke.extend({ref:c.union([$d,Ad]),argument:c.object({name:c.string(),value:c.string()}).passthrough(),context:c.optional(c.object({arguments:c.optional(c.record(c.string(),c.string()))}))})}),Id=Je.extend({completion:c.object({values:c.array(c.string()).max(100),total:c.optional(c.number().int()),hasMore:c.optional(c.boolean())}).passthrough()}),kd=c.object({uri:c.string().startsWith("file://"),name:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).passthrough(),Cd=qe.extend({method:c.literal("roots/list")}),gs=Je.extend({roots:c.array(kd)}),jd=or.extend({method:c.literal("notifications/roots/list_changed")}),zm=c.union([na,sa,va,gd,ha,fa,ca,ua,da,td,ad,ma,pa]),Vm=c.union([aa,oa,ds,jd]),Um=c.union([ta,ms,vs,gs]),Zm=c.union([na,Ed,Od,Cd]),Bm=c.union([aa,oa,yd,sd,rd,vd,fd]),Qm=c.union([ta,Ju,Id,dd,id,Yu,Xu,ed,ao,md]),fe=class extends Error{constructor(e,a,s){super(`MCP error ${e}: ${a}`),this.code=e,this.data=s,this.name="McpError"}};var Dd=6e4,ga=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(aa,a=>{let s=this._requestHandlerAbortControllers.get(a.params.requestId);s?.abort(a.params.reason)}),this.setNotificationHandler(oa,a=>{this._onprogress(a)}),this.setRequestHandler(na,a=>({}))}_setupTimeout(e,a,s,r,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(r,a),startTime:Date.now(),timeout:a,maxTotalTimeout:s,resetTimeoutOnProgress:n,onTimeout:r})}_resetTimeout(e){let a=this._timeoutInfo.get(e);if(!a)return!1;let s=Date.now()-a.startTime;if(a.maxTotalTimeout&&s>=a.maxTotalTimeout)throw this._timeoutInfo.delete(e),new fe(de.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:a.maxTotalTimeout,totalElapsed:s});return clearTimeout(a.timeoutId),a.timeoutId=setTimeout(a.onTimeout,a.timeout),!0}_cleanupTimeout(e){let a=this._timeoutInfo.get(e);a&&(clearTimeout(a.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=a=>{this._onerror(a)},this._transport.onmessage=(a,s)=>{Kr(a)||mt(a)?this._onresponse(a):pt(a)?this._onrequest(a,s):Qn(a)?this._onnotification(a):this._onerror(new Error(`Unknown message type: ${JSON.stringify(a)}`))},await this._transport.start()}_onclose(){var e;let a=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let s=new fe(de.ConnectionClosed,"Connection closed");for(let r of a.values())r(s)}_onerror(e){var a;(a=this.onerror)===null||a===void 0||a.call(this,e)}_onnotification(e){var a;let s=(a=this._notificationHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackNotificationHandler;s!==void 0&&Promise.resolve().then(()=>s(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,a){var s,r,n,i;let o=(s=this._requestHandlers.get(e.method))!==null&&s!==void 0?s:this.fallbackRequestHandler;if(o===void 0){(r=this._transport)===null||r===void 0||r.send({jsonrpc:"2.0",id:e.id,error:{code:de.MethodNotFound,message:"Method not found"}}).catch(f=>this._onerror(new Error(`Failed to send an error response: ${f}`)));return}let l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);let u={signal:l.signal,sessionId:(n=this._transport)===null||n===void 0?void 0:n.sessionId,_meta:(i=e.params)===null||i===void 0?void 0:i._meta,sendNotification:f=>this.notification(f,{relatedRequestId:e.id}),sendRequest:(f,p,y)=>this.request(f,p,{...y,relatedRequestId:e.id}),authInfo:a?.authInfo,requestId:e.id};Promise.resolve().then(()=>o(e,u)).then(f=>{var p;if(!l.signal.aborted)return(p=this._transport)===null||p===void 0?void 0:p.send({result:f,jsonrpc:"2.0",id:e.id})},f=>{var p,y;if(!l.signal.aborted)return(p=this._transport)===null||p===void 0?void 0:p.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(f.code)?f.code:de.InternalError,message:(y=f.message)!==null&&y!==void 0?y:"Internal error"}})}).catch(f=>this._onerror(new Error(`Failed to send response: ${f}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:a,...s}=e.params,r=Number(a),n=this._progressHandlers.get(r);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(r),o=this._timeoutInfo.get(r);if(o&&i&&o.resetTimeoutOnProgress)try{this._resetTimeout(r)}catch(l){i(l);return}n(s)}_onresponse(e){let a=Number(e.id),s=this._responseHandlers.get(a);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(a),this._progressHandlers.delete(a),this._cleanupTimeout(a),Kr(e))s(e);else{let r=new fe(e.error.code,e.error.message,e.error.data);s(r)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,a,s){let{relatedRequestId:r,resumptionToken:n,onresumptiontoken:i}=s??{};return new Promise((o,l)=>{var u,f,p,y,d,v;if(!this._transport){l(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(f=s?.signal)===null||f===void 0||f.throwIfAborted();let b=this._requestMessageId++,g={...e,jsonrpc:"2.0",id:b};s?.onprogress&&(this._progressHandlers.set(b,s.onprogress),g.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:b}});let E=w=>{var $;this._responseHandlers.delete(b),this._progressHandlers.delete(b),this._cleanupTimeout(b),($=this._transport)===null||$===void 0||$.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:b,reason:String(w)}},{relatedRequestId:r,resumptionToken:n,onresumptiontoken:i}).catch(k=>this._onerror(new Error(`Failed to send cancellation: ${k}`))),l(w)};this._responseHandlers.set(b,w=>{var $;if(!(!(($=s?.signal)===null||$===void 0)&&$.aborted)){if(w instanceof Error)return l(w);try{let k=a.parse(w.result);o(k)}catch(k){l(k)}}}),(y=s?.signal)===null||y===void 0||y.addEventListener("abort",()=>{var w;E((w=s?.signal)===null||w===void 0?void 0:w.reason)});let R=(d=s?.timeout)!==null&&d!==void 0?d:Dd,S=()=>E(new fe(de.RequestTimeout,"Request timed out",{timeout:R}));this._setupTimeout(b,R,s?.maxTotalTimeout,S,(v=s?.resetTimeoutOnProgress)!==null&&v!==void 0?v:!1),this._transport.send(g,{relatedRequestId:r,resumptionToken:n,onresumptiontoken:i}).catch(w=>{this._cleanupTimeout(b),l(w)})})}async notification(e,a){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let s={...e,jsonrpc:"2.0"};await this._transport.send(s,a)}setRequestHandler(e,a){let s=e.shape.method.value;this.assertRequestHandlerCapability(s),this._requestHandlers.set(s,(r,n)=>Promise.resolve(a(e.parse(r),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,a){this._notificationHandlers.set(e.shape.method.value,s=>Promise.resolve(a(e.parse(s))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function no(t,e){return Object.entries(e).reduce((a,[s,r])=>(r&&typeof r=="object"?a[s]=a[s]?{...a[s],...r}:r:a[s]=r,a),{...t})}var ll=bc(il(),1),Na=class extends ga{constructor(e,a){var s;super(a),this._serverInfo=e,this._capabilities=(s=a?.capabilities)!==null&&s!==void 0?s:{},this._instructions=a?.instructions,this.setRequestHandler(sa,r=>this._oninitialize(r)),this.setNotificationHandler(ds,()=>{var r;return(r=this.oninitialized)===null||r===void 0?void 0:r.call(this)})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=no(this._capabilities,e)}assertCapabilityForMethod(e){var a,s,r;switch(e){case"sampling/createMessage":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((s=this._clientCapabilities)===null||s===void 0)&&s.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let a=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:zn.includes(a)?a:cs,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},ta)}async createMessage(e,a){return this.request({method:"sampling/createMessage",params:e},ms,a)}async elicitInput(e,a){let s=await this.request({method:"elicitation/create",params:e},vs,a);if(s.action==="accept"&&s.content)try{let r=new ll.default,n=r.compile(e.requestedSchema);if(!n(s.content))throw new fe(de.InvalidParams,`Elicitation response content does not match requested schema: ${r.errorsText(n.errors)}`)}catch(r){throw r instanceof fe?r:new fe(de.InternalError,`Error validating elicitation response: ${r}`)}return s}async listRoots(e,a){return this.request({method:"roots/list",params:e},gs,a)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var ul=Symbol("Let zodToJsonSchema decide on which parser to use");var cl={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},dl=t=>typeof t=="string"?{...cl,name:t}:{...cl,...t};var fl=t=>{let e=dl(t),a=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:a,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([s,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,s],jsonSchema:void 0}]))}};function zs(t,e,a,s){s?.errorMessages&&a&&(t.errorMessage={...t.errorMessage,[e]:a})}function ee(t,e,a,s,r){t[e]=a,zs(t,e,s,r)}function hl(){return{}}function pl(t,e){let a={type:"array"};return t.type?._def&&t.type?._def?.typeName!==A.ZodAny&&(a.items=B(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&ee(a,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&ee(a,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(ee(a,"minItems",t.exactLength.value,t.exactLength.message,e),ee(a,"maxItems",t.exactLength.value,t.exactLength.message,e)),a}function ml(t,e){let a={type:"integer",format:"int64"};if(!t.checks)return a;for(let s of t.checks)switch(s.kind){case"min":e.target==="jsonSchema7"?s.inclusive?ee(a,"minimum",s.value,s.message,e):ee(a,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(a.exclusiveMinimum=!0),ee(a,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?ee(a,"maximum",s.value,s.message,e):ee(a,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(a.exclusiveMaximum=!0),ee(a,"maximum",s.value,s.message,e));break;case"multipleOf":ee(a,"multipleOf",s.value,s.message,e);break}return a}function vl(){return{type:"boolean"}}function La(t,e){return B(t.type._def,e)}var gl=(t,e)=>B(t.innerType._def,e);function Vs(t,e,a){let s=a??e.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((r,n)=>Vs(t,e,r))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return mh(t,e)}}var mh=(t,e)=>{let a={type:"integer",format:"unix-time"};if(e.target==="openApi3")return a;for(let s of t.checks)switch(s.kind){case"min":ee(a,"minimum",s.value,s.message,e);break;case"max":ee(a,"maximum",s.value,s.message,e);break}return a};function yl(t,e){return{...B(t.innerType._def,e),default:t.defaultValue()}}function _l(t,e){return e.effectStrategy==="input"?B(t.schema._def,e):{}}function bl(t){return{type:"string",enum:Array.from(t.values)}}var vh=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Pl(t,e){let a=[B(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),B(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n),s=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,r=[];return a.forEach(n=>{if(vh(n))r.push(...n.allOf),n.unevaluatedProperties===void 0&&(s=void 0);else{let i=n;if("additionalProperties"in n&&n.additionalProperties===!1){let{additionalProperties:o,...l}=n;i=l}else s=void 0;r.push(i)}}),r.length?{allOf:r,...s}:void 0}function El(t,e){let a=typeof t.value;return a!=="bigint"&&a!=="number"&&a!=="boolean"&&a!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:a==="bigint"?"integer":a,enum:[t.value]}:{type:a==="bigint"?"integer":a,const:t.value}}var Us,Ye={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Us===void 0&&(Us=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Us),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Fa(t,e){let a={type:"string"};if(t.checks)for(let s of t.checks)switch(s.kind){case"min":ee(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,s.value):s.value,s.message,e);break;case"max":ee(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Xe(a,"email",s.message,e);break;case"format:idn-email":Xe(a,"idn-email",s.message,e);break;case"pattern:zod":je(a,Ye.email,s.message,e);break}break;case"url":Xe(a,"uri",s.message,e);break;case"uuid":Xe(a,"uuid",s.message,e);break;case"regex":je(a,s.regex,s.message,e);break;case"cuid":je(a,Ye.cuid,s.message,e);break;case"cuid2":je(a,Ye.cuid2,s.message,e);break;case"startsWith":je(a,RegExp(`^${Zs(s.value,e)}`),s.message,e);break;case"endsWith":je(a,RegExp(`${Zs(s.value,e)}$`),s.message,e);break;case"datetime":Xe(a,"date-time",s.message,e);break;case"date":Xe(a,"date",s.message,e);break;case"time":Xe(a,"time",s.message,e);break;case"duration":Xe(a,"duration",s.message,e);break;case"length":ee(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,s.value):s.value,s.message,e),ee(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,s.value):s.value,s.message,e);break;case"includes":{je(a,RegExp(Zs(s.value,e)),s.message,e);break}case"ip":{s.version!=="v6"&&Xe(a,"ipv4",s.message,e),s.version!=="v4"&&Xe(a,"ipv6",s.message,e);break}case"base64url":je(a,Ye.base64url,s.message,e);break;case"jwt":je(a,Ye.jwt,s.message,e);break;case"cidr":{s.version!=="v6"&&je(a,Ye.ipv4Cidr,s.message,e),s.version!=="v4"&&je(a,Ye.ipv6Cidr,s.message,e);break}case"emoji":je(a,Ye.emoji(),s.message,e);break;case"ulid":{je(a,Ye.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Xe(a,"binary",s.message,e);break}case"contentEncoding:base64":{ee(a,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{je(a,Ye.base64,s.message,e);break}}break}case"nanoid":je(a,Ye.nanoid,s.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return a}function Zs(t,e){return e.patternStrategy==="escape"?yh(t):t}var gh=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function yh(t){let e="";for(let a=0;a<t.length;a++)gh.has(t[a])||(e+="\\"),e+=t[a];return e}function Xe(t,e,a,s){t.format||t.anyOf?.some(r=>r.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&s.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...a&&s.errorMessages&&{errorMessage:{format:a}}})):ee(t,"format",e,a,s)}function je(t,e,a,s){t.pattern||t.allOf?.some(r=>r.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&s.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:xl(e,s),...a&&s.errorMessages&&{errorMessage:{pattern:a}}})):ee(t,"pattern",xl(e,s),a,s)}function xl(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let a={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},s=a.i?t.source.toLowerCase():t.source,r="",n=!1,i=!1,o=!1;for(let l=0;l<s.length;l++){if(n){r+=s[l],n=!1;continue}if(a.i){if(i){if(s[l].match(/[a-z]/)){o?(r+=s[l],r+=`${s[l-2]}-${s[l]}`.toUpperCase(),o=!1):s[l+1]==="-"&&s[l+2]?.match(/[a-z]/)?(r+=s[l],o=!0):r+=`${s[l]}${s[l].toUpperCase()}`;continue}}else if(s[l].match(/[a-z]/)){r+=`[${s[l]}${s[l].toUpperCase()}]`;continue}}if(a.m){if(s[l]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(s[l]==="$"){r+=`($|(?=[\r
]))`;continue}}if(a.s&&s[l]==="."){r+=i?`${s[l]}\r
`:`[${s[l]}\r
]`;continue}r+=s[l],s[l]==="\\"?n=!0:i&&s[l]==="]"?i=!1:!i&&s[l]==="["&&(i=!0)}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return r}function qa(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===A.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((s,r)=>({...s,[r]:B(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};let a={type:"object",additionalProperties:B(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return a;if(t.keyType?._def.typeName===A.ZodString&&t.keyType._def.checks?.length){let{type:s,...r}=Fa(t.keyType._def,e);return{...a,propertyNames:r}}else{if(t.keyType?._def.typeName===A.ZodEnum)return{...a,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===A.ZodBranded&&t.keyType._def.type._def.typeName===A.ZodString&&t.keyType._def.type._def.checks?.length){let{type:s,...r}=La(t.keyType._def,e);return{...a,propertyNames:r}}}return a}function Sl(t,e){if(e.mapStrategy==="record")return qa(t,e);let a=B(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},s=B(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,s],minItems:2,maxItems:2}}}function wl(t){let e=t.values,s=Object.keys(t.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),r=Array.from(new Set(s.map(n=>typeof n)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:s}}function Rl(){return{not:{}}}function Tl(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var jt={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Al(t,e){if(e.target==="openApi3")return Ol(t,e);let a=t.options instanceof Map?Array.from(t.options.values()):t.options;if(a.every(s=>s._def.typeName in jt&&(!s._def.checks||!s._def.checks.length))){let s=a.reduce((r,n)=>{let i=jt[n._def.typeName];return i&&!r.includes(i)?[...r,i]:r},[]);return{type:s.length>1?s:s[0]}}else if(a.every(s=>s._def.typeName==="ZodLiteral"&&!s.description)){let s=a.reduce((r,n)=>{let i=typeof n._def.value;switch(i){case"string":case"number":case"boolean":return[...r,i];case"bigint":return[...r,"integer"];case"object":if(n._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(s.length===a.length){let r=s.filter((n,i,o)=>o.indexOf(n)===i);return{type:r.length>1?r:r[0],enum:a.reduce((n,i)=>n.includes(i._def.value)?n:[...n,i._def.value],[])}}}else if(a.every(s=>s._def.typeName==="ZodEnum"))return{type:"string",enum:a.reduce((s,r)=>[...s,...r._def.values.filter(n=>!s.includes(n))],[])};return Ol(t,e)}var Ol=(t,e)=>{let a=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((s,r)=>B(s._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(s=>!!s&&(!e.strictUnions||typeof s=="object"&&Object.keys(s).length>0));return a.length?{anyOf:a}:void 0};function $l(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:jt[t.innerType._def.typeName],nullable:!0}:{type:[jt[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let s=B(t.innerType._def,{...e,currentPath:[...e.currentPath]});return s&&"$ref"in s?{allOf:[s],nullable:!0}:s&&{...s,nullable:!0}}let a=B(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return a&&{anyOf:[a,{type:"null"}]}}function Il(t,e){let a={type:"number"};if(!t.checks)return a;for(let s of t.checks)switch(s.kind){case"int":a.type="integer",zs(a,"type",s.message,e);break;case"min":e.target==="jsonSchema7"?s.inclusive?ee(a,"minimum",s.value,s.message,e):ee(a,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(a.exclusiveMinimum=!0),ee(a,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?ee(a,"maximum",s.value,s.message,e):ee(a,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(a.exclusiveMaximum=!0),ee(a,"maximum",s.value,s.message,e));break;case"multipleOf":ee(a,"multipleOf",s.value,s.message,e);break}return a}function kl(t,e){let a=e.target==="openAi",s={type:"object",properties:{}},r=[],n=t.shape();for(let o in n){let l=n[o];if(l===void 0||l._def===void 0)continue;let u=bh(l);u&&a&&(l instanceof Le&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);let f=B(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});f!==void 0&&(s.properties[o]=f,u||r.push(o))}r.length&&(s.required=r);let i=_h(t,e);return i!==void 0&&(s.additionalProperties=i),s}function _h(t,e){if(t.catchall._def.typeName!=="ZodNever")return B(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function bh(t){try{return t.isOptional()}catch{return!0}}var Cl=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return B(t.innerType._def,e);let a=B(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return a?{anyOf:[{not:{}},a]}:{}};var jl=(t,e)=>{if(e.pipeStrategy==="input")return B(t.in._def,e);if(e.pipeStrategy==="output")return B(t.out._def,e);let a=B(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),s=B(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",a?"1":"0"]});return{allOf:[a,s].filter(r=>r!==void 0)}};function Dl(t,e){return B(t.type._def,e)}function Nl(t,e){let s={type:"array",uniqueItems:!0,items:B(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&ee(s,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&ee(s,"maxItems",t.maxSize.value,t.maxSize.message,e),s}function Ll(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((a,s)=>B(a._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((a,s)=>s===void 0?a:[...a,s],[]),additionalItems:B(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((a,s)=>B(a._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((a,s)=>s===void 0?a:[...a,s],[])}}function Fl(){return{not:{}}}function ql(){return{}}var Ml=(t,e)=>B(t.innerType._def,e);var Hl=(t,e,a)=>{switch(e){case A.ZodString:return Fa(t,a);case A.ZodNumber:return Il(t,a);case A.ZodObject:return kl(t,a);case A.ZodBigInt:return ml(t,a);case A.ZodBoolean:return vl();case A.ZodDate:return Vs(t,a);case A.ZodUndefined:return Fl();case A.ZodNull:return Tl(a);case A.ZodArray:return pl(t,a);case A.ZodUnion:case A.ZodDiscriminatedUnion:return Al(t,a);case A.ZodIntersection:return Pl(t,a);case A.ZodTuple:return Ll(t,a);case A.ZodRecord:return qa(t,a);case A.ZodLiteral:return El(t,a);case A.ZodEnum:return bl(t);case A.ZodNativeEnum:return wl(t);case A.ZodNullable:return $l(t,a);case A.ZodOptional:return Cl(t,a);case A.ZodMap:return Sl(t,a);case A.ZodSet:return Nl(t,a);case A.ZodLazy:return()=>t.getter()._def;case A.ZodPromise:return Dl(t,a);case A.ZodNaN:case A.ZodNever:return Rl();case A.ZodEffects:return _l(t,a);case A.ZodAny:return hl();case A.ZodUnknown:return ql();case A.ZodDefault:return yl(t,a);case A.ZodBranded:return La(t,a);case A.ZodReadonly:return Ml(t,a);case A.ZodCatch:return gl(t,a);case A.ZodPipeline:return jl(t,a);case A.ZodFunction:case A.ZodVoid:case A.ZodSymbol:return;default:return(s=>{})(e)}};function B(t,e,a=!1){let s=e.seen.get(t);if(e.override){let o=e.override?.(t,e,s,a);if(o!==ul)return o}if(s&&!a){let o=Ph(s,e);if(o!==void 0)return o}let r={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,r);let n=Hl(t,t.typeName,e),i=typeof n=="function"?B(n(),e):n;if(i&&xh(t,e,i),e.postProcess){let o=e.postProcess(i,t,e);return r.jsonSchema=i,o}return r.jsonSchema=i,i}var Ph=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:Eh(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((a,s)=>e.currentPath[s]===a)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},Eh=(t,e)=>{let a=0;for(;a<t.length&&a<e.length&&t[a]===e[a];a++);return[(t.length-a).toString(),...e.slice(a)].join("/")},xh=(t,e,a)=>(t.description&&(a.description=t.description,e.markdownDescription&&(a.markdownDescription=t.description)),a);var Ma=(t,e)=>{let a=fl(e),s=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[u,f])=>({...l,[u]:B(f._def,{...a,currentPath:[...a.basePath,a.definitionPath,u]},!0)??{}}),{}):void 0,r=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=B(t._def,r===void 0?a:{...a,currentPath:[...a.basePath,a.definitionPath,r]},!1)??{},i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(n.title=i);let o=r===void 0?s?{...n,[a.definitionPath]:s}:n:{$ref:[...a.$refStrategy==="relative"?[]:a.basePath,a.definitionPath,r].join("/"),[a.definitionPath]:{...s,[r]:n}};return a.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(a.target==="jsonSchema2019-09"||a.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),a.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Bs;(function(t){t.Completable="McpCompletable"})(Bs||(Bs={}));var vt=class extends J{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}};vt.create=(t,e)=>new vt({type:t,typeName:Bs.Completable,complete:e.complete,...Sh(e)});function Sh(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:r}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,o)=>{var l,u;let{message:f}=t;return i.code==="invalid_enum_value"?{message:f??o.defaultError}:typeof o.data>"u"?{message:(l=f??s)!==null&&l!==void 0?l:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(u=f??a)!==null&&u!==void 0?u:o.defaultError}},description:r}}var za=class{constructor(e,a){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new Na(e,a)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(pa.shape.method.value),this.server.assertCanSetRequestHandler(ma.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(pa,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,a])=>{let s={name:e,title:a.title,description:a.description,inputSchema:a.inputSchema?Ma(a.inputSchema,{strictUnions:!0}):wh,annotations:a.annotations};return a.outputSchema&&(s.outputSchema=Ma(a.outputSchema,{strictUnions:!0})),s})})),this.server.setRequestHandler(ma,async(e,a)=>{let s=this._registeredTools[e.params.name];if(!s)throw new fe(de.InvalidParams,`Tool ${e.params.name} not found`);if(!s.enabled)throw new fe(de.InvalidParams,`Tool ${e.params.name} disabled`);let r;if(s.inputSchema){let n=await s.inputSchema.safeParseAsync(e.params.arguments);if(!n.success)throw new fe(de.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${n.error.message}`);let i=n.data,o=s.callback;try{r=await Promise.resolve(o(i,a))}catch(l){r={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:!0}}}else{let n=s.callback;try{r=await Promise.resolve(n(a))}catch(i){r={content:[{type:"text",text:i instanceof Error?i.message:String(i)}],isError:!0}}}if(s.outputSchema){if(!r.structuredContent)throw new fe(de.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);let n=await s.outputSchema.safeParseAsync(r.structuredContent);if(!n.success)throw new fe(de.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${n.error.message}`)}return r}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(va.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(va,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new fe(de.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,a){let s=this._registeredPrompts[a.name];if(!s)throw new fe(de.InvalidParams,`Prompt ${a.name} not found`);if(!s.enabled)throw new fe(de.InvalidParams,`Prompt ${a.name} disabled`);if(!s.argsSchema)return Ha;let r=s.argsSchema.shape[e.params.argument.name];if(!(r instanceof vt))return Ha;let i=await r._def.complete(e.params.argument.value,e.params.context);return Vl(i)}async handleResourceCompletion(e,a){let s=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===a.uri);if(!s){if(this._registeredResources[a.uri])return Ha;throw new fe(de.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let r=s.resourceTemplate.completeCallback(e.params.argument.name);if(!r)return Ha;let n=await r(e.params.argument.value,e.params.context);return Vl(n)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(ca.shape.method.value),this.server.assertCanSetRequestHandler(ua.shape.method.value),this.server.assertCanSetRequestHandler(da.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(ca,async(e,a)=>{let s=Object.entries(this._registeredResources).filter(([n,i])=>i.enabled).map(([n,i])=>({uri:n,name:i.name,...i.metadata})),r=[];for(let n of Object.values(this._registeredResourceTemplates)){if(!n.resourceTemplate.listCallback)continue;let i=await n.resourceTemplate.listCallback(a);for(let o of i.resources)r.push({...n.metadata,...o})}return{resources:[...s,...r]}}),this.server.setRequestHandler(ua,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([a,s])=>({name:a,uriTemplate:s.resourceTemplate.uriTemplate.toString(),...s.metadata}))})),this.server.setRequestHandler(da,async(e,a)=>{let s=new URL(e.params.uri),r=this._registeredResources[s.toString()];if(r){if(!r.enabled)throw new fe(de.InvalidParams,`Resource ${s} disabled`);return r.readCallback(s,a)}for(let n of Object.values(this._registeredResourceTemplates)){let i=n.resourceTemplate.uriTemplate.match(s.toString());if(i)return n.readCallback(s,i,a)}throw new fe(de.InvalidParams,`Resource ${s} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(fa.shape.method.value),this.server.assertCanSetRequestHandler(ha.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(fa,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,a])=>({name:e,title:a.title,description:a.description,arguments:a.argsSchema?Th(a.argsSchema):void 0}))})),this.server.setRequestHandler(ha,async(e,a)=>{let s=this._registeredPrompts[e.params.name];if(!s)throw new fe(de.InvalidParams,`Prompt ${e.params.name} not found`);if(!s.enabled)throw new fe(de.InvalidParams,`Prompt ${e.params.name} disabled`);if(s.argsSchema){let r=await s.argsSchema.safeParseAsync(e.params.arguments);if(!r.success)throw new fe(de.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${r.error.message}`);let n=r.data,i=s.callback;return await Promise.resolve(i(n,a))}else{let r=s.callback;return await Promise.resolve(r(a))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,a,...s){let r;typeof s[0]=="object"&&(r=s.shift());let n=s[0];if(typeof a=="string"){if(this._registeredResources[a])throw new Error(`Resource ${a} is already registered`);let i=this._createRegisteredResource(e,void 0,a,r,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,a,r,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,a,s,r){if(typeof a=="string"){if(this._registeredResources[a])throw new Error(`Resource ${a} is already registered`);let n=this._createRegisteredResource(e,s.title,a,s,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let n=this._createRegisteredResourceTemplate(e,s.title,a,s,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}}_createRegisteredResource(e,a,s,r,n){let i={name:e,title:a,metadata:r,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:o=>{typeof o.uri<"u"&&o.uri!==s&&(delete this._registeredResources[s],o.uri&&(this._registeredResources[o.uri]=i)),typeof o.name<"u"&&(i.name=o.name),typeof o.title<"u"&&(i.title=o.title),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResources[s]=i,i}_createRegisteredResourceTemplate(e,a,s,r,n){let i={resourceTemplate:s,title:a,metadata:r,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredResourceTemplates[e],o.name&&(this._registeredResourceTemplates[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.template<"u"&&(i.resourceTemplate=o.template),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=i,i}_createRegisteredPrompt(e,a,s,r,n){let i={title:a,description:s,argsSchema:r===void 0?void 0:c.object(r),callback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredPrompts[e],o.name&&(this._registeredPrompts[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.description<"u"&&(i.description=o.description),typeof o.argsSchema<"u"&&(i.argsSchema=c.object(o.argsSchema)),typeof o.callback<"u"&&(i.callback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,i}_createRegisteredTool(e,a,s,r,n,i,o){let l={title:a,description:s,inputSchema:r===void 0?void 0:c.object(r),outputSchema:n===void 0?void 0:c.object(n),annotations:i,callback:o,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredTools[e],u.name&&(this._registeredTools[u.name]=l)),typeof u.title<"u"&&(l.title=u.title),typeof u.description<"u"&&(l.description=u.description),typeof u.paramsSchema<"u"&&(l.inputSchema=c.object(u.paramsSchema)),typeof u.callback<"u"&&(l.callback=u.callback),typeof u.annotations<"u"&&(l.annotations=u.annotations),typeof u.enabled<"u"&&(l.enabled=u.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...a){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let s,r,n,i;if(typeof a[0]=="string"&&(s=a.shift()),a.length>1){let l=a[0];zl(l)?(r=a.shift(),a.length>1&&typeof a[0]=="object"&&a[0]!==null&&!zl(a[0])&&(i=a.shift())):typeof l=="object"&&l!==null&&(i=a.shift())}let o=a[0];return this._createRegisteredTool(e,void 0,s,r,n,i,o)}registerTool(e,a,s){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:r,description:n,inputSchema:i,outputSchema:o,annotations:l}=a;return this._createRegisteredTool(e,r,n,i,o,l,s)}prompt(e,...a){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let s;typeof a[0]=="string"&&(s=a.shift());let r;a.length>1&&(r=a.shift());let n=a[0],i=this._createRegisteredPrompt(e,void 0,s,r,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,a,s){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:r,description:n,argsSchema:i}=a,o=this._createRegisteredPrompt(e,r,n,i,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var wh={type:"object"};function zl(t){return typeof t!="object"||t===null?!1:Object.keys(t).length===0||Object.values(t).some(Rh)}function Rh(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function Th(t){return Object.entries(t.shape).map(([e,a])=>({name:e,description:a.description,required:!a.isOptional()}))}function Vl(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var Ha={completion:{values:[],hasMore:!1}};var $e=class extends Error{res;status;constructor(t=500,e){super(e?.message,{cause:e?.cause}),this.res=e?.res,this.status=t}getResponse(){return this.res?new Response(this.res.body,{status:this.status,headers:this.res.headers}):new Response(this.message,{status:this.status})}};var Qs=class{writer;encoder;writable;abortSubscribers=[];responseReadable;aborted=!1;closed=!1;constructor(t,e){this.writable=t,this.writer=t.getWriter(),this.encoder=new TextEncoder;let a=e.getReader();this.abortSubscribers.push(async()=>{await a.cancel()}),this.responseReadable=new ReadableStream({async pull(s){let{done:r,value:n}=await a.read();r?s.close():s.enqueue(n)},cancel:()=>{this.abort()}})}async write(t){try{typeof t=="string"&&(t=this.encoder.encode(t)),await this.writer.write(t)}catch{}return this}async writeln(t){return await this.write(t+`
`),this}sleep(t){return new Promise(e=>setTimeout(e,t))}async close(){try{await this.writer.close()}catch{}this.closed=!0}async pipe(t){this.writer.releaseLock(),await t.pipeTo(this.writable,{preventClose:!0}),this.writer=this.writable.getWriter()}onAbort(t){this.abortSubscribers.push(t)}abort(){this.aborted||(this.aborted=!0,this.abortSubscribers.forEach(t=>t()))}};var Ks=class extends Qs{constructor(t,e){super(t,e)}async writeSSE(t){let a=(await St(t.data,Ut.Stringify,!1,{})).split(`
`).map(r=>`data: ${r}`).join(`
`),s=[t.event&&`event: ${t.event}`,a,t.id&&`id: ${t.id}`,t.retry&&`retry: ${t.retry}`].filter(Boolean).join(`
`)+`

`;await this.write(s)}};var Zl=()=>{let t=typeof Bun<"u"?Bun.version:void 0;if(t===void 0)return!1;let e=t.startsWith("1.1")||t.startsWith("1.0")||t.startsWith("0.");return Zl=()=>e,e},$h=async(t,e,a)=>{try{await e(t)}catch(s){s instanceof Error&&a?(await a(s,t),await t.writeSSE({event:"error",data:s.message})):console.error(s)}},Ih=new WeakMap,Ul=(t,e,a)=>{let{readable:s,writable:r}=new TransformStream,n=new Ks(r,s);return Zl()&&t.req.raw.signal.addEventListener("abort",()=>{n.closed||n.abort()}),Ih.set(n.responseReadable,t),t.header("Transfer-Encoding","chunked"),t.header("Content-Type","text/event-stream"),t.header("Cache-Control","no-cache"),t.header("Connection","keep-alive"),$h(n,e,a),t.newResponse(n.responseReadable)},Bl=class{#r=!1;#e=!1;#t;#n;#a;#s=!1;#c="_GET_stream";#o=new Map;#l=new Map;#i=new Map;sessionId;onclose;onerror;onmessage;constructor(t){this.#n=t?.sessionIdGenerator,this.#s=t?.enableJsonResponse??!1,this.#a=t?.eventStore,this.#t=t?.onsessioninitialized}async start(){if(this.#r)throw new Error("Transport already started");this.#r=!0}async handleRequest(t,e){switch(t.req.method){case"GET":return this.handleGetRequest(t);case"POST":return this.handlePostRequest(t,e);case"DELETE":return this.handleDeleteRequest(t);default:return this.handleUnsupportedRequest(t)}}async handleGetRequest(t){try{if(!t.req.header("Accept")?.includes("text/event-stream"))throw new $e(406,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Not Acceptable: Client must accept text/event-stream"},id:null})});this.validateSession(t),this.sessionId!==void 0&&t.header("mcp-session-id",this.sessionId);let a=this.#c;if(this.#a){let s=t.req.header("last-event-id");s&&(a=r=>this.#a.replayEventsAfter(s,{send:async(n,i)=>{try{await r.writeSSE({id:n,event:"message",data:JSON.stringify(i)})}catch{throw this.onerror?.(new Error("Failed replay events")),new $e(500,{message:"Failed replay events"})}}}))}if(typeof a=="string"&&this.#o.get(a)!==void 0)throw new $e(409,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Conflict: Only one SSE stream is allowed per session"},id:null})});return Ul(t,async s=>{let r=typeof a=="string"?a:await a(s);this.#o.set(r,{ctx:t,stream:s});let n=setInterval(()=>{s.closed||s.writeSSE({data:"",event:"ping"}).catch(()=>clearInterval(n))},3e4);s.onAbort(()=>{this.#o.delete(r),clearInterval(n)})})}catch(e){throw e instanceof $e?e:(this.onerror?.(e),new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32700,message:"Parse error",data:String(e)},id:null})}))}}async handlePostRequest(t,e){try{let a=t.req.header("Accept");if(!a?.includes("application/json")||!a.includes("text/event-stream"))throw new $e(406,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Not Acceptable: Client must accept both application/json and text/event-stream"},id:null})});if(!t.req.header("Content-Type")?.includes("application/json"))throw new $e(415,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Unsupported Media Type: Content-Type must be application/json"},id:null})});let r=t.get("auth"),n=e;n===void 0&&(n=await t.req.json());let i;Array.isArray(n)?i=n.map(u=>us.parse(u)):i=[us.parse(n)];let o=i.some(Gn);if(o){if(this.#e&&this.sessionId!==void 0)throw new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32600,message:"Invalid Request: Server already initialized"},id:null})});if(i.length>1)throw new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32600,message:"Invalid Request: Only one initialization request is allowed"},id:null})});this.sessionId=this.#n?.(),this.#e=!0,this.sessionId&&this.#t&&this.#t(this.sessionId)}o||this.validateSession(t);let l=i.some(pt);if(!l){for(let u of i)this.onmessage?.(u,{authInfo:r});return t.body(null,202)}if(l){let u=crypto.randomUUID();if(!this.#s&&this.sessionId!==void 0&&t.header("mcp-session-id",this.sessionId),this.#s){let f=await new Promise(p=>{for(let y of i)pt(y)&&(this.#o.set(u,{ctx:{header:t.header,json:p}}),this.#l.set(y.id,u));for(let y of i)this.onmessage?.(y,{authInfo:r})});return t.json(f)}return Ul(t,async f=>{for(let p of i)pt(p)&&(this.#o.set(u,{ctx:t,stream:f}),this.#l.set(p.id,u));f.onAbort(()=>{this.#o.delete(u)});for(let p of i)this.onmessage?.(p,{authInfo:r})})}}catch(a){throw a instanceof $e?a:(this.onerror?.(a),new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32700,message:"Parse error",data:String(a)},id:null})}))}}async handleDeleteRequest(t){return this.validateSession(t),await this.close(),t.body(null,200)}handleUnsupportedRequest(t){return t.json({jsonrpc:"2.0",error:{code:-32e3,message:"Method not allowed."},id:null},{status:405,headers:{Allow:"GET, POST, DELETE"}})}validateSession(t){if(this.#n===void 0)return!0;if(!this.#e)throw new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Server not initialized"},id:null})});let e=t.req.header("mcp-session-id");if(!e)throw new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Mcp-Session-Id header is required"},id:null})});if(Array.isArray(e))throw new $e(400,{res:Response.json({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Mcp-Session-Id header must be a single value"},id:null})});if(e!==this.sessionId)throw new $e(404,{res:Response.json({jsonrpc:"2.0",error:{code:-32001,message:"Session not found"},id:null})});return!0}async close(){for(let{stream:t}of this.#o.values())t?.close();this.#o.clear(),this.#i.clear(),this.onclose?.()}async send(t,e){let a=e?.relatedRequestId;if((Kr(t)||mt(t))&&(a=t.id),a===void 0){if(Kr(t)||mt(t))throw new Error("Cannot send a response on a standalone SSE stream unless resuming a previous client request");let n=this.#o.get(this.#c);if(n===void 0)return;let i;return this.#a&&(i=await this.#a.storeEvent(this.#c,t)),n.stream?.writeSSE({id:i,event:"message",data:JSON.stringify(t)})}let s=this.#l.get(a),r=this.#o.get(s);if(!s)throw new Error(`No connection established for request ID: ${String(a)}`);if(!this.#s){let n;this.#a&&(n=await this.#a.storeEvent(s,t)),r&&await r.stream?.writeSSE({id:n,event:"message",data:JSON.stringify(t)})}if(Kr(t)||mt(t)){this.#i.set(a,t);let n=Array.from(this.#l.entries()).filter(([,o])=>this.#o.get(o)===r).map(([o])=>o);if(n.every(o=>this.#i.has(o))){if(!r)throw new Error(`No connection established for request ID: ${String(a)}`);if(this.#s){this.sessionId!==void 0&&r.ctx.header("mcp-session-id",this.sessionId);let o=n.map(l=>this.#i.get(l));r.ctx.json(o.length===1?o[0]:o);return}else r.stream?.close();for(let o of n)this.#i.delete(o),this.#l.delete(o)}}}};var Ql=t=>{let e="",a=new Uint8Array(t);for(let s=0,r=a.length;s<r;s++)e+=String.fromCharCode(a[s]);return btoa(e)},Kl=t=>{let e=atob(t),a=new Uint8Array(new ArrayBuffer(e.length)),s=e.length/2;for(let r=0,n=e.length-1;r<=s;r++,n--)a[r]=e.charCodeAt(r),a[n]=e.charCodeAt(n);return a};var kh=t=>t.requestContext;var Js=t=>async(e,a)=>{let s=qh(e),r=s.createRequest(e),n=kh(e),i=await t.fetch(r,{event:e,requestContext:n,lambdaContext:a});return s.createResult(e,i)},Ws=class{createRequest(t){let e=this.getQueryString(t),a=t.requestContext&&"domainName"in t.requestContext?t.requestContext.domainName:t.headers?.host??t.multiValueHeaders?.host?.[0],s=this.getPath(t),r=`https://${a}${s}`,n=e?`${r}?${e}`:r,i=this.getHeaders(t),o=this.getMethod(t),l={headers:i,method:o};return t.body&&(l.body=t.isBase64Encoded?Kl(t.body):t.body),new Request(n,l)}async createResult(t,e){let a=e.headers.get("content-type"),s=!!(a&&zh(a));if(!s){let i=e.headers.get("content-encoding");s=Vh(i)}let n={body:s?Ql(await e.arrayBuffer()):await e.text(),statusCode:e.status,isBase64Encoded:s,...t.multiValueHeaders?{multiValueHeaders:{}}:{headers:{}}};return this.setCookies(t,e,n),n.multiValueHeaders?e.headers.forEach((i,o)=>{n.multiValueHeaders[o]=[i]}):e.headers.forEach((i,o)=>{n.headers[o]=i}),n}setCookies(t,e,a){if(e.headers.has("set-cookie")){let s=e.headers.getSetCookie?e.headers.getSetCookie():Array.from(e.headers.entries()).filter(([r])=>r==="set-cookie").map(([,r])=>r);Array.isArray(s)&&(this.setCookiesToResult(a,s),e.headers.delete("set-cookie"))}}},Ch=class extends Ws{getPath(t){return t.rawPath}getMethod(t){return t.requestContext.http.method}getQueryString(t){return t.rawQueryString}getCookies(t,e){Array.isArray(t.cookies)&&e.set("Cookie",t.cookies.join("; "))}setCookiesToResult(t,e){t.cookies=e}getHeaders(t){let e=new Headers;if(this.getCookies(t,e),t.headers)for(let[a,s]of Object.entries(t.headers))s&&e.set(a,s);return e}},jh=new Ch,Dh=class extends Ws{getPath(t){return t.path}getMethod(t){return t.httpMethod}getQueryString(t){return t.multiValueQueryStringParameters?Object.entries(t.multiValueQueryStringParameters||{}).filter(([,e])=>e).map(([e,a])=>`${e}=${a.join(`&${e}=`)}`).join("&"):Object.entries(t.queryStringParameters||{}).filter(([,e])=>e).map(([e,a])=>`${e}=${a}`).join("&")}getCookies(t,e){}getHeaders(t){let e=new Headers;if(this.getCookies(t,e),t.headers)for(let[a,s]of Object.entries(t.headers))s&&e.set(a,s);if(t.multiValueHeaders){for(let[a,s]of Object.entries(t.multiValueHeaders))if(s){let r=e.get(a);s.forEach(n=>(!r||!r.includes(n))&&e.append(a,n))}}return e}setCookiesToResult(t,e){t.multiValueHeaders={"set-cookie":e}}},Nh=new Dh,Lh=class extends Ws{getHeaders(t){let e=new Headers;if(t.multiValueHeaders)for(let[a,s]of Object.entries(t.multiValueHeaders))s&&Array.isArray(s)&&e.set(a,s.join("; "));else for(let[a,s]of Object.entries(t.headers??{}))s&&e.set(a,s);return e}getPath(t){return t.path}getMethod(t){return t.httpMethod}getQueryString(t){return t.multiValueQueryStringParameters?Object.entries(t.multiValueQueryStringParameters||{}).filter(([,e])=>e).map(([e,a])=>`${e}=${a.join(`&${e}=`)}`).join("&"):Object.entries(t.queryStringParameters||{}).filter(([,e])=>e).map(([e,a])=>`${e}=${a}`).join("&")}getCookies(t,e){let a;t.multiValueHeaders?a=t.multiValueHeaders.cookie?.join("; "):a=t.headers?t.headers.cookie:void 0,a&&e.append("Cookie",a)}setCookiesToResult(t,e){t.multiValueHeaders?t.multiValueHeaders["set-cookie"]=e:t.headers["set-cookie"]=e.join(", ")}},Fh=new Lh,qh=t=>Mh(t)?Fh:Hh(t)?jh:Nh,Mh=t=>t.requestContext?Object.hasOwn(t.requestContext,"elb"):!1,Hh=t=>Object.hasOwn(t,"rawPath"),zh=t=>!/^(text\/(plain|html|css|javascript|csv).*|application\/(.*json|.*xml).*|image\/svg\+xml.*)$/.test(t),Vh=t=>t===null?!1:/^(gzip|deflate|compress|br)/.test(t);globalThis.crypto||(globalThis.crypto=Jl.webcrypto);var Va=new ns,Uh=t=>{let e=new za({name:"my-mcp-server",version:"1.0.0",capabilities:{tools:{}}});return e.tool("get-weather","Get current weather from OpenWeatherMap",{lat:c.number().min(-90).max(90),lon:c.number().min(-180).max(180)},async({lat:a,lon:s})=>{let r=t.OPENWEATHER_API_KEY;if(!r)return{content:[{type:"text",text:"OpenWeather API key not configured."}]};let n=`https://api.openweathermap.org/data/2.5/weather?lat=${a}&lon=${s}&appid=${r}&units=metric`;try{let i=await fetch(n);if(!i.ok)throw new Error(`Error ${i.status}`);let o=await i.json();console.log(o.weather[0].description);let l=o.weather?.[0]?.description??"No description",u=o.main?.temp??"N/A",f=o.wind?.speed??"N/A";return{content:[{type:"text",text:`Weather: ${l}
 Temp: ${u}\xB0C
  Wind: ${f} m/s`}]}}catch(i){return console.error(i),{content:[{type:"text",text:"Failed to fetch weather data."}]}}}),e};Va.use("*",async(t,e)=>{!t.env?.OPENWEATHER_API_KEY&&process.env.OPENWEATHER_API_KEY&&(t.env={OPENWEATHER_API_KEY:process.env.OPENWEATHER_API_KEY||""}),await e()});Va.all("/mcp",async t=>{let e=Uh(t.env),a=new Bl;return await e.connect(a),a.handleRequest(t)});var Zh=Js(Va),Bh=Va;0&&(module.exports={handler});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)
*/
//# sourceMappingURL=index.js.map
